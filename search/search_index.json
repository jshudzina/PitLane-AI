{"config":{"lang":["en"],"separator":"[\\s\\-,:!=\\[\\]()\"/]+|(?!\\b)(?=[A-Z][a-z])|\\.(?!\\d)|&[lg]t;","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"PitLane-AI","text":"<p>AI-powered Formula 1 data analysis - from lap times and tyre strategy to race telemetry and historical insights. Built with Claude's Agent SDK to demonstrate practical applications of AI agents in domain-specific analysis.</p> <p>Built on Open Source F1 Data APIs</p> <p>PitLane-AI leverages two powerful F1 data APIs for all analytical capabilities:</p> <ul> <li>FastF1 - Comprehensive F1 telemetry, timing, and session data</li> <li>jolpica-f1 (Ergast API) - Historical driver and race information</li> </ul> <p>These APIs handle all the analytical heavy lifting, providing the data foundation for PitLane-AI's intelligent analysis.</p>"},{"location":"#what-it-analyzes","title":"What It Analyzes","text":"<ul> <li>Lap Time Analysis - Compare driver performance with visual lap time distributions</li> <li>Tyre Strategy - Visualize pit stop patterns and compound usage across races</li> <li>Race Telemetry - Access detailed session data for qualifying, practice, and race sessions</li> <li>Driver Information - Query F1 driver rosters, codes, and metadata from 1950 to present</li> <li>Event Schedules - Browse complete season calendars with session timings and locations</li> </ul>"},{"location":"#quick-start","title":"Quick Start","text":"CLIWeb InterfacePython API <pre><code># Install\npip install pitlane-agent\n\n# Create workspace\npitlane workspace create --session-id my-analysis\n\n# Analyze Monaco qualifying\npitlane analyze lap-times --session-id my-analysis \\\n  --year 2024 --gp Monaco --session Q \\\n  --drivers VER --drivers HAM\n</code></pre> <pre><code># Install\npip install pitlane-web\n\n# Run web server\nuvx pitlane-web --env development\n\n# Visit http://localhost:8000\n</code></pre> <pre><code>from pitlane_agent import F1Agent\n\nagent = F1Agent(session_id=\"my-analysis\")\n\nasync for chunk in agent.chat(\"Compare Verstappen and Hamilton lap times at Monaco 2024\"):\n    print(chunk, end=\"\")\n</code></pre>"},{"location":"#next-steps","title":"Next Steps","text":"<ul> <li> <p> Getting Started</p> <p>Install PitLane-AI and run your first analysis</p> <p> Installation</p> </li> <li> <p>:material-architecture:{ .lg .middle } Architecture</p> <p>Understand the agent system, skills, and temporal context</p> <p> Architecture Overview</p> </li> <li> <p> User Guide</p> <p>Learn how to use the web interface for F1 data analysis</p> <p> Web Interface</p> </li> <li> <p> Developer Guide</p> <p>Contribute to PitLane-AI and build custom skills</p> <p> Setup</p> </li> </ul>"},{"location":"#key-features","title":"Key Features","text":""},{"location":"#skills-based-architecture","title":"Skills-Based Architecture","text":"<p>The agent uses specialized skills to handle different F1 analysis domains:</p> <ul> <li>f1-analyst - Lap time and tyre strategy analysis with visualizations</li> <li>f1-drivers - Driver information queries via the Ergast API</li> <li>f1-schedule - Event calendars and session schedules</li> </ul> <p>Each skill invokes Python scripts through the agent's tool system, using FastF1 for data access and matplotlib for visualizations.</p>"},{"location":"#temporal-context-awareness","title":"Temporal Context Awareness","text":"<p>PitLane-AI includes a sophisticated temporal context system that provides real-time awareness of the F1 calendar:</p> <ul> <li>Knows the current season, phase (pre/in/post/off-season), and race weekend</li> <li>Detects live or recent sessions automatically</li> <li>Intelligently caches data based on temporal state</li> <li>Ensures queries like \"latest race results\" use the correct year and race</li> </ul> <p>Learn more about the Temporal Context System.</p>"},{"location":"#tool-permissions","title":"Tool Permissions","text":"<p>The agent demonstrates tool permission controls through domain-restricted web access. The WebFetch tool is limited to F1-related domains (<code>wikipedia.org</code>, <code>ergast.com</code>, <code>formula1.com</code>) - showing how agents can be safely constrained to approved data sources.</p> <p>See Tool Permissions for details.</p>"},{"location":"#observable-behavior","title":"Observable Behavior","text":"<p>Optional OpenTelemetry tracing shows how the agent works under the hood - which tools it calls, permission checks, and decision flows. This makes the agent's reasoning transparent and debuggable.</p>"},{"location":"#project-structure","title":"Project Structure","text":"<p>PitLane-AI is a monorepo containing three tightly integrated Python packages:</p> <ul> <li>pitlane-ai - Meta-package bundling both agent and web interface</li> <li>pitlane-agent - Core AI agent for F1 data analysis with CLI</li> <li>pitlane-web - Web interface (FastAPI) for interactive F1 analysis</li> </ul> <p>Learn more about the Project Structure.</p>"},{"location":"#license","title":"License","text":"<p>PitLane-AI is licensed under the Apache License 2.0. See the License page for details.</p>"},{"location":"RELEASE_PROCESS/","title":"Release Process","text":"<p>This document describes how to create releases for PitLane-AI and what happens automatically during the release process.</p>"},{"location":"RELEASE_PROCESS/#overview","title":"Overview","text":"<p>PitLane-AI uses an automated release workflow that: - Bumps version numbers across all packages - Generates CHANGELOG from conventional commits - Builds distribution packages - Optionally publishes to PyPI - Attaches build artifacts to GitHub Releases</p>"},{"location":"RELEASE_PROCESS/#prerequisites","title":"Prerequisites","text":"<p>Before creating a release, ensure: - All changes are merged to the <code>main</code> branch - All tests are passing - Pre-commit hooks have been run - You have appropriate repository permissions</p>"},{"location":"RELEASE_PROCESS/#creating-a-release","title":"Creating a Release","text":""},{"location":"RELEASE_PROCESS/#method-1-github-ui-recommended","title":"Method 1: GitHub UI (Recommended)","text":"<ol> <li>Go to Releases page</li> <li>Click \"Draft a new release\"</li> <li>Click \"Choose a tag\" and create a new tag:</li> <li>Format: <code>vX.Y.Z</code> (e.g., <code>v0.2.0</code>, <code>v1.0.0</code>)</li> <li>Must start with <code>v</code> and follow semantic versioning</li> <li>Target: <code>main</code> branch</li> <li>Enter release title (e.g., \"Release v0.2.0\")</li> <li>Add release notes or let GitHub generate them</li> <li>Click \"Publish release\"</li> </ol>"},{"location":"RELEASE_PROCESS/#method-2-manual-workflow-trigger","title":"Method 2: Manual Workflow Trigger","text":"<p>For testing or special cases:</p> <ol> <li>Go to Actions page</li> <li>Click \"Run workflow\"</li> <li>Enter:</li> <li>Version: The version number (e.g., <code>0.2.0</code> or <code>v0.2.0</code>)</li> <li>Publish to PyPI: Check if you want to publish (requires setup)</li> <li>Click \"Run workflow\"</li> </ol>"},{"location":"RELEASE_PROCESS/#what-happens-automatically","title":"What Happens Automatically","text":"<p>When you create a release, the workflow automatically:</p>"},{"location":"RELEASE_PROCESS/#1-version-bump-job-version-bump","title":"1. Version Bump (Job: <code>version-bump</code>)","text":"<ul> <li>Parses version from the release tag</li> <li>Runs <code>scripts/bump_version.py</code> to update versions in:</li> <li><code>/pyproject.toml</code></li> <li><code>/packages/pitlane-agent/pyproject.toml</code></li> <li><code>/packages/pitlane-web/pyproject.toml</code></li> <li><code>/packages/pitlane-agent/src/pitlane_agent/__init__.py</code></li> <li><code>/packages/pitlane-web/src/pitlane_web/__init__.py</code></li> <li>Generates <code>CHANGELOG.md</code> from conventional commits using git-cliff</li> <li>Commits changes with message: <code>chore: bump version to X.Y.Z</code></li> <li>Pushes commit to <code>main</code> branch</li> </ul>"},{"location":"RELEASE_PROCESS/#2-build-job-build","title":"2. Build (Job: <code>build</code>)","text":"<ul> <li>Checks out the version-bumped code</li> <li>Installs <code>uv</code> package manager</li> <li>Runs <code>uv build --all-packages</code> to create:</li> <li>Wheel files (<code>.whl</code>) for all 3 packages</li> <li>Source distributions (<code>.tar.gz</code>) for all 3 packages</li> <li>Uploads artifacts for 90 days</li> </ul>"},{"location":"RELEASE_PROCESS/#3-publish-to-pypi-job-publish-conditional","title":"3. Publish to PyPI (Job: <code>publish</code>, conditional)","text":"<p>Only runs if: - Repository variable <code>AUTO_PUBLISH_PYPI</code> is set to <code>true</code>, OR - Manual workflow trigger with \"Publish to PyPI\" checked</p> <p>Steps: - Downloads build artifacts - Publishes all packages to PyPI using stored token - Packages become available at:   - https://pypi.org/project/pitlane-ai/   - https://pypi.org/project/pitlane-agent/   - https://pypi.org/project/pitlane-web/</p>"},{"location":"RELEASE_PROCESS/#4-upload-artifacts-job-upload-to-release","title":"4. Upload Artifacts (Job: <code>upload-to-release</code>)","text":"<ul> <li>Downloads build artifacts</li> <li>Attaches all <code>.whl</code> and <code>.tar.gz</code> files to the GitHub Release</li> </ul>"},{"location":"RELEASE_PROCESS/#version-numbering","title":"Version Numbering","text":"<p>PitLane-AI follows Semantic Versioning:</p> <ul> <li>MAJOR (X.0.0): Breaking changes</li> <li>MINOR (0.X.0): New features (backward compatible)</li> <li>PATCH (0.0.X): Bug fixes (backward compatible)</li> </ul> <p>Examples: - <code>v0.1.0</code> \u2192 <code>v0.2.0</code>: Added new features - <code>v0.2.0</code> \u2192 <code>v0.2.1</code>: Fixed bugs - <code>v0.9.0</code> \u2192 <code>v1.0.0</code>: First stable release with breaking changes</p>"},{"location":"RELEASE_PROCESS/#pre-release-versions","title":"Pre-release Versions","text":"<p>For testing releases: - <code>v0.2.0-beta.1</code>: Beta release - <code>v0.2.0-rc.1</code>: Release candidate</p>"},{"location":"RELEASE_PROCESS/#unified-versioning","title":"Unified Versioning","text":"<p>All three packages (pitlane-ai, pitlane-agent, pitlane-web) share the same version number. This ensures: - Compatibility between packages - Simpler dependency management - Clear version alignment for users</p>"},{"location":"RELEASE_PROCESS/#changelog-generation","title":"CHANGELOG Generation","text":"<p>The CHANGELOG is automatically generated from conventional commit messages:</p>"},{"location":"RELEASE_PROCESS/#commit-types","title":"Commit Types","text":"<ul> <li><code>feat:</code> \u2192 Features section</li> <li><code>fix:</code> \u2192 Bug Fixes section</li> <li><code>refactor:</code> \u2192 Refactoring section</li> <li><code>perf:</code> \u2192 Performance section</li> <li><code>test:</code> \u2192 Testing section</li> <li><code>docs:</code> \u2192 Documentation section</li> <li><code>chore:</code> \u2192 Skipped (except version bumps)</li> </ul>"},{"location":"RELEASE_PROCESS/#commit-format","title":"Commit Format","text":"<pre><code>&lt;type&gt;(&lt;scope&gt;): &lt;description&gt;\n\n[optional body]\n\n[optional footer]\n</code></pre> <p>Examples: <pre><code>feat(agent): add lap time distribution visualization\nfix(web): resolve security vulnerabilities in dependencies\nrefactor(cli): reorganize command structure\n</code></pre></p> <p>Pull request references like <code>(#14)</code> are automatically converted to links.</p>"},{"location":"RELEASE_PROCESS/#pypi-publishing","title":"PyPI Publishing","text":""},{"location":"RELEASE_PROCESS/#setup-one-time","title":"Setup (One-time)","text":"<p>To enable PyPI publishing:</p> <ol> <li>Create PyPI Account &amp; Token</li> <li>Sign up at https://pypi.org</li> <li>Generate API token at https://pypi.org/manage/account/token/</li> <li> <p>Scope: Entire account or specific to pitlane-ai projects</p> </li> <li> <p>Configure GitHub Environment</p> </li> <li>Go to repository Settings \u2192 Environments</li> <li>Create environment named: <code>pypi</code></li> <li>Add secret: <code>PYPI_TOKEN</code> (paste your PyPI API token)</li> <li> <p>Optional: Add protection rules (require approval, restrict to main branch)</p> </li> <li> <p>Enable Auto-Publishing (Optional)</p> </li> <li>Go to repository Settings \u2192 Variables \u2192 New repository variable</li> <li>Name: <code>AUTO_PUBLISH_PYPI</code></li> <li>Value: <code>true</code></li> <li>This enables automatic publishing on every release</li> </ol>"},{"location":"RELEASE_PROCESS/#manual-publishing","title":"Manual Publishing","text":"<p>If auto-publishing is disabled: - Use workflow_dispatch trigger - Check \"Publish to PyPI\" option</p>"},{"location":"RELEASE_PROCESS/#monitoring-release-progress","title":"Monitoring Release Progress","text":"<ol> <li>Go to Actions tab</li> <li>Click on the \"Release\" workflow run</li> <li>Monitor each job:</li> <li>\u2713 version-bump</li> <li>\u2713 build</li> <li>\u2713 publish (if enabled)</li> <li>\u2713 upload-to-release</li> </ol> <p>Each job shows detailed logs of what happened.</p>"},{"location":"RELEASE_PROCESS/#verifying-a-release","title":"Verifying a Release","text":"<p>After a release completes:</p>"},{"location":"RELEASE_PROCESS/#1-check-version-bump-commit","title":"1. Check Version Bump Commit","text":"<pre><code>git pull origin main\ngit log -1  # Should show \"chore: bump version to X.Y.Z\"\n</code></pre>"},{"location":"RELEASE_PROCESS/#2-verify-versions","title":"2. Verify Versions","text":"<pre><code># Check all version files\ngrep -r \"X.Y.Z\" pyproject.toml packages/*/pyproject.toml packages/*/src/*/__init__.py\n</code></pre>"},{"location":"RELEASE_PROCESS/#3-check-changelog","title":"3. Check CHANGELOG","text":"<pre><code>cat CHANGELOG.md\n# Should show new version with categorized commits\n</code></pre>"},{"location":"RELEASE_PROCESS/#4-download-and-test-artifacts","title":"4. Download and Test Artifacts","text":"<p>From the GitHub Release page: - Download <code>.whl</code> files - Install locally:   <pre><code>pip install pitlane_ai-X.Y.Z-py3-none-any.whl\npip install pitlane_agent-X.Y.Z-py3-none-any.whl\npip install pitlane_web-X.Y.Z-py3-none-any.whl\n</code></pre> - Verify versions:   <pre><code>python -c \"import pitlane_agent; print(pitlane_agent.__version__)\"\npython -c \"import pitlane_web; print(pitlane_web.__version__)\"\n</code></pre></p>"},{"location":"RELEASE_PROCESS/#5-verify-pypi-if-published","title":"5. Verify PyPI (if published)","text":"<ul> <li>Check packages appear at:</li> <li>https://pypi.org/project/pitlane-ai/X.Y.Z/</li> <li>https://pypi.org/project/pitlane-agent/X.Y.Z/</li> <li>https://pypi.org/project/pitlane-web/X.Y.Z/</li> <li>Test installation:   <pre><code>pip install pitlane-ai==X.Y.Z\n</code></pre></li> </ul>"},{"location":"RELEASE_PROCESS/#troubleshooting","title":"Troubleshooting","text":""},{"location":"RELEASE_PROCESS/#release-workflow-failed","title":"Release Workflow Failed","text":"<p>Symptom: Workflow shows red X in Actions tab</p> <p>Solutions: 1. Check the failed job logs for specific errors 2. Common issues:    - Version format invalid (must be X.Y.Z)    - Merge conflicts on main branch    - PyPI token expired or incorrect    - Network issues during publishing</p>"},{"location":"RELEASE_PROCESS/#version-bump-commit-not-created","title":"Version Bump Commit Not Created","text":"<p>Symptom: No \"chore: bump version to X.Y.Z\" commit on main</p> <p>Solutions: 1. Check version-bump job logs 2. Ensure GitHub token has write permissions 3. Check for branch protection rules blocking pushes</p>"},{"location":"RELEASE_PROCESS/#build-artifacts-missing","title":"Build Artifacts Missing","text":"<p>Symptom: No <code>.whl</code> or <code>.tar.gz</code> files attached to release</p> <p>Solutions: 1. Check build job logs for errors 2. Verify uv installation succeeded 3. Check if packages have proper pyproject.toml configuration</p>"},{"location":"RELEASE_PROCESS/#pypi-publishing-failed","title":"PyPI Publishing Failed","text":"<p>Symptom: publish job failed or packages not on PyPI</p> <p>Solutions: 1. Verify <code>PYPI_TOKEN</code> secret is correctly set in pypi environment 2. Check token hasn't expired 3. Verify package names aren't already taken (for first release) 4. Check PyPI status page for outages</p>"},{"location":"RELEASE_PROCESS/#rolling-back-a-release","title":"Rolling Back a Release","text":"<p>If a release has issues:</p>"},{"location":"RELEASE_PROCESS/#1-revert-version-bump-commit","title":"1. Revert Version Bump Commit","text":"<pre><code># Find the version bump commit\ngit log --oneline | grep \"chore: bump version\"\n\n# Revert it\ngit revert &lt;commit-sha&gt;\ngit push origin main\n</code></pre>"},{"location":"RELEASE_PROCESS/#2-delete-github-release","title":"2. Delete GitHub Release","text":"<ol> <li>Go to Releases</li> <li>Click on the problematic release</li> <li>Click \"Delete\" (\u22ee menu)</li> </ol>"},{"location":"RELEASE_PROCESS/#3-delete-git-tag","title":"3. Delete Git Tag","text":"<pre><code># Delete local tag\ngit tag -d vX.Y.Z\n\n# Delete remote tag\ngit push --delete origin vX.Y.Z\n</code></pre>"},{"location":"RELEASE_PROCESS/#4-handle-pypi-if-published","title":"4. Handle PyPI (if published)","text":"<p>Important: PyPI doesn't allow deleting or re-uploading versions!</p> <p>Options: - Yank the release: Marks version as broken but keeps it   <pre><code>pip install twine\ntwine upload --repository pypi dist/* --yank \"Reason for yanking\"\n</code></pre> - Publish a new patch version: Create vX.Y.Z+1 with fixes</p>"},{"location":"RELEASE_PROCESS/#testing-releases","title":"Testing Releases","text":"<p>Before creating an official release, test with a pre-release version:</p> <ol> <li>Create release with tag like <code>v0.2.0-test</code> or <code>v0.2.0-rc.1</code></li> <li>Monitor workflow execution</li> <li>Download and test artifacts</li> <li>Delete test release and tag when satisfied</li> <li>Create official release</li> </ol>"},{"location":"RELEASE_PROCESS/#best-practices","title":"Best Practices","text":"<ol> <li>Write good commit messages: Use conventional commits format consistently</li> <li>Review CHANGELOG: After release, verify CHANGELOG accurately reflects changes</li> <li>Test before releasing: Run full test suite before creating release</li> <li>Version appropriately: Follow semantic versioning guidelines</li> <li>Pre-release testing: Use pre-release tags for testing (e.g., <code>v0.2.0-beta.1</code>)</li> <li>Monitor workflow: Watch the release workflow to catch issues early</li> <li>Verify artifacts: Always download and test artifacts before announcing release</li> </ol>"},{"location":"RELEASE_PROCESS/#support","title":"Support","text":"<p>For issues with the release process: - Check Actions for workflow logs - Review this document for common issues - Open an issue at https://github.com/jshudzina/PitLane-AI/issues</p>"},{"location":"changelog/","title":"Changelog","text":"<p>See CHANGELOG.md for the full changelog.</p>"},{"location":"license/","title":"License","text":"<p>See LICENSE for the full license text.</p>"},{"location":"agent-cli/cli-reference/","title":"CLI Reference","text":"<p>Agent-Only Tool</p> <p>This CLI is designed for agent use only, not direct user interaction. End users should use the Web Interface instead.</p> <p>The <code>pitlane</code> CLI provides workspace-based access to F1 data analysis tools. All commands operate within session-scoped workspaces for data isolation and concurrent usage.</p>"},{"location":"agent-cli/cli-reference/#installation","title":"Installation","text":"<pre><code># Install from PyPI\npip install pitlane-agent\n\n# Or use with uvx (no installation)\nuvx pitlane-agent &lt;command&gt;\n</code></pre>"},{"location":"agent-cli/cli-reference/#command-structure","title":"Command Structure","text":"<pre><code>pitlane &lt;command&gt; [subcommand] [options]\n</code></pre> <p>Available Commands: - <code>workspace</code> - Manage session workspaces - <code>fetch</code> - Fetch F1 data (sessions, drivers, schedules) - <code>analyze</code> - Analyze and visualize F1 data - <code>temporal-context</code> - Show current F1 calendar context</p>"},{"location":"agent-cli/cli-reference/#workspace-commands","title":"Workspace Commands","text":"<p>Manage session-based workspaces for data isolation.</p>"},{"location":"agent-cli/cli-reference/#pitlane-workspace-create","title":"<code>pitlane workspace create</code>","text":"<p>Create a new workspace for analysis.</p> <p>Usage: <pre><code>pitlane workspace create [--session-id ID] [--description TEXT]\n</code></pre></p> <p>Options: - <code>--session-id</code> - Explicit session ID (auto-generated if omitted) - <code>--description</code> - Optional workspace description</p> <p>Examples: <pre><code># Auto-generated session ID\npitlane workspace create\n# Output: {\"session_id\": \"abc123-...\", \"workspace_path\": \"~/.pitlane/workspaces/abc123-...\"}\n\n# Explicit session ID\npitlane workspace create --session-id monaco-2024 --description \"Monaco Grand Prix analysis\"\n\n# Use in scripts\nSESSION_ID=$(pitlane workspace create | jq -r '.session_id')\n</code></pre></p> <p>Output: <pre><code>{\n  \"session_id\": \"abc123-def456-...\",\n  \"workspace_path\": \"/Users/alice/.pitlane/workspaces/abc123-...\",\n  \"created_at\": \"2024-05-23T14:30:00Z\"\n}\n</code></pre></p>"},{"location":"agent-cli/cli-reference/#pitlane-workspace-list","title":"<code>pitlane workspace list</code>","text":"<p>List all workspaces (10 most recent by default).</p> <p>Usage: <pre><code>pitlane workspace list [--show-all]\n</code></pre></p> <p>Options: - <code>--show-all</code> - Show all workspaces (default: 10 most recent)</p> <p>Examples: <pre><code># List recent workspaces\npitlane workspace list\n\n# List all workspaces\npitlane workspace list --show-all\n</code></pre></p> <p>Output: <pre><code>{\n  \"total\": 3,\n  \"workspaces\": [\n    {\n      \"session_id\": \"abc123-...\",\n      \"created_at\": \"2024-05-23T14:30:00Z\",\n      \"last_accessed\": \"2024-05-23T15:45:00Z\",\n      \"description\": \"Monaco 2024 analysis\",\n      \"workspace_path\": \"~/.pitlane/workspaces/abc123-...\",\n      \"data_files\": [\"session_info.json\"],\n      \"chart_files\": [\"lap_times.png\"]\n    }\n  ]\n}\n</code></pre></p>"},{"location":"agent-cli/cli-reference/#pitlane-workspace-info","title":"<code>pitlane workspace info</code>","text":"<p>Show detailed workspace information.</p> <p>Usage: <pre><code>pitlane workspace info --session-id SESSION_ID\n</code></pre></p> <p>Options: - <code>--session-id</code> (required) - Session ID to inspect</p> <p>Examples: <pre><code>pitlane workspace info --session-id abc123\n</code></pre></p> <p>Output: <pre><code>{\n  \"session_id\": \"abc123\",\n  \"workspace_path\": \"~/.pitlane/workspaces/abc123\",\n  \"created_at\": \"2024-05-23T14:30:00Z\",\n  \"last_accessed\": \"2024-05-23T15:45:00Z\",\n  \"data_files\": [\"session_info.json\", \"drivers.json\"],\n  \"chart_files\": [\"lap_times.png\", \"strategy.png\"]\n}\n</code></pre></p>"},{"location":"agent-cli/cli-reference/#pitlane-workspace-clean","title":"<code>pitlane workspace clean</code>","text":"<p>Remove old workspaces to free disk space.</p> <p>Usage: <pre><code>pitlane workspace clean --older-than DAYS [--yes]\npitlane workspace clean --all [--yes]\n</code></pre></p> <p>Options: - <code>--older-than</code> - Remove workspaces not accessed in N days - <code>--all</code> - Remove all workspaces - <code>--yes</code>, <code>-y</code> - Skip confirmation prompt</p> <p>Examples: <pre><code># Remove workspaces older than 7 days\npitlane workspace clean --older-than 7\n\n# Remove all workspaces (with confirmation)\npitlane workspace clean --all\n\n# Remove all workspaces (skip confirmation)\npitlane workspace clean --all --yes\n</code></pre></p> <p>Output: <pre><code>{\n  \"removed_count\": 3,\n  \"removed_sessions\": [\"abc123\", \"def456\", \"ghi789\"]\n}\n</code></pre></p>"},{"location":"agent-cli/cli-reference/#pitlane-workspace-remove","title":"<code>pitlane workspace remove</code>","text":"<p>Remove a specific workspace.</p> <p>Usage: <pre><code>pitlane workspace remove --session-id SESSION_ID [--yes]\n</code></pre></p> <p>Options: - <code>--session-id</code> (required) - Session ID to remove - <code>--yes</code>, <code>-y</code> - Skip confirmation prompt</p> <p>Examples: <pre><code># Remove with confirmation\npitlane workspace remove --session-id abc123\n\n# Remove without confirmation\npitlane workspace remove --session-id abc123 --yes\n</code></pre></p>"},{"location":"agent-cli/cli-reference/#fetch-commands","title":"Fetch Commands","text":"<p>Fetch F1 data from FastF1 and Ergast API.</p>"},{"location":"agent-cli/cli-reference/#pitlane-fetch-session-info","title":"<code>pitlane fetch session-info</code>","text":"<p>Fetch session information and driver list.</p> <p>Usage: <pre><code>pitlane fetch session-info --session-id ID --year YEAR --gp GP_NAME --session SESSION_TYPE\n</code></pre></p> <p>Options: - <code>--session-id</code> (required) - Workspace session ID - <code>--year</code> (required) - Season year (e.g., 2024) - <code>--gp</code> (required) - Grand Prix name (e.g., Monaco, Silverstone) - <code>--session</code> (required) - Session type (R, Q, FP1, FP2, FP3, S, SQ)</p> <p>Examples: <pre><code>pitlane fetch session-info --session-id abc123 --year 2024 --gp Monaco --session R\npitlane fetch session-info --session-id abc123 --year 2024 --gp Silverstone --session Q\n</code></pre></p> <p>Output: <pre><code>{\n  \"event_name\": \"Monaco Grand Prix\",\n  \"session_type\": \"Race\",\n  \"date\": \"2024-05-26\",\n  \"drivers\": [\"VER\", \"HAM\", \"LEC\", ...],\n  \"saved_to\": \"~/.pitlane/workspaces/abc123/data/session_info.json\"\n}\n</code></pre></p>"},{"location":"agent-cli/cli-reference/#pitlane-fetch-drivers","title":"<code>pitlane fetch drivers</code>","text":"<p>Fetch driver information for a season.</p> <p>Usage: <pre><code>pitlane fetch drivers --session-id ID --year YEAR [--team TEAM]\n</code></pre></p> <p>Options: - <code>--session-id</code> (required) - Workspace session ID - <code>--year</code> (required) - Season year - <code>--team</code> (optional) - Filter by team (e.g., \"Ferrari\", \"Mercedes\")</p> <p>Examples: <pre><code>pitlane fetch drivers --session-id abc123 --year 2024\npitlane fetch drivers --session-id abc123 --year 2024 --team Ferrari\n</code></pre></p>"},{"location":"agent-cli/cli-reference/#pitlane-fetch-schedule","title":"<code>pitlane fetch schedule</code>","text":"<p>Fetch season calendar with race dates.</p> <p>Usage: <pre><code>pitlane fetch schedule --session-id ID --year YEAR\n</code></pre></p> <p>Options: - <code>--session-id</code> (required) - Workspace session ID - <code>--year</code> (required) - Season year</p> <p>Examples: <pre><code>pitlane fetch schedule --session-id abc123 --year 2024\n</code></pre></p>"},{"location":"agent-cli/cli-reference/#analyze-commands","title":"Analyze Commands","text":"<p>Analyze and visualize F1 data.</p>"},{"location":"agent-cli/cli-reference/#pitlane-analyze-lap-times","title":"<code>pitlane analyze lap-times</code>","text":"<p>Analyze lap time distributions with visualizations.</p> <p>Usage: <pre><code>pitlane analyze lap-times --session-id ID --year YEAR --gp GP_NAME --session SESSION_TYPE --drivers DRIVER [--drivers DRIVER2 ...]\n</code></pre></p> <p>Options: - <code>--session-id</code> (required) - Workspace session ID - <code>--year</code> (required) - Season year - <code>--gp</code> (required) - Grand Prix name - <code>--session</code> (required) - Session type (R, Q, FP1, etc.) - <code>--drivers</code> (required, repeatable) - Driver codes (VER, HAM, etc.)</p> <p>Examples: <pre><code># Compare two drivers\npitlane analyze lap-times --session-id abc123 --year 2024 --gp Monaco --session Q --drivers VER --drivers HAM\n\n# Compare multiple drivers\npitlane analyze lap-times --session-id abc123 --year 2024 --gp Silverstone --session R --drivers VER --drivers HAM --drivers LEC\n</code></pre></p> <p>Output: <pre><code>{\n  \"chart_saved_to\": \"~/.pitlane/workspaces/abc123/charts/lap_times.png\",\n  \"statistics\": {\n    \"VER\": {\"mean\": \"1:12.345\", \"median\": \"1:12.234\", \"std\": \"0.234\"},\n    \"HAM\": {\"mean\": \"1:12.456\", \"median\": \"1:12.345\", \"std\": \"0.321\"}\n  }\n}\n</code></pre></p>"},{"location":"agent-cli/cli-reference/#pitlane-analyze-tyre-strategy","title":"<code>pitlane analyze tyre-strategy</code>","text":"<p>Visualize tyre strategy and pit stops.</p> <p>Usage: <pre><code>pitlane analyze tyre-strategy --session-id ID --year YEAR --gp GP_NAME --session R\n</code></pre></p> <p>Options: - <code>--session-id</code> (required) - Workspace session ID - <code>--year</code> (required) - Season year - <code>--gp</code> (required) - Grand Prix name - <code>--session</code> (required) - Must be 'R' (Race only)</p> <p>Examples: <pre><code>pitlane analyze tyre-strategy --session-id abc123 --year 2024 --gp Monaco --session R\n</code></pre></p> <p>Output: <pre><code>{\n  \"chart_saved_to\": \"~/.pitlane/workspaces/abc123/charts/strategy.png\",\n  \"strategy_summary\": {\n    \"VER\": [\"SOFT-20\", \"MEDIUM-38\"],\n    \"HAM\": [\"MEDIUM-25\", \"HARD-33\"]\n  }\n}\n</code></pre></p>"},{"location":"agent-cli/cli-reference/#temporal-context-command","title":"Temporal Context Command","text":"<p>Show current F1 calendar context.</p>"},{"location":"agent-cli/cli-reference/#pitlane-temporal-context","title":"<code>pitlane temporal-context</code>","text":"<p>Display the current state of the F1 season.</p> <p>Usage: <pre><code>pitlane temporal-context [--format FORMAT] [--refresh] [--verbosity LEVEL]\n</code></pre></p> <p>Options: - <code>--format</code> - Output format: <code>text</code> (default), <code>json</code>, <code>prompt</code> - <code>--refresh</code> - Force refresh from FastF1 (ignore cache) - <code>--verbosity</code> - Detail level: <code>minimal</code>, <code>normal</code> (default), <code>detailed</code></p> <p>Examples: <pre><code># Human-readable text (default)\npitlane temporal-context\n\n# JSON output\npitlane temporal-context --format json\n\n# System prompt format (for agent integration)\npitlane temporal-context --format prompt --verbosity detailed\n\n# Force refresh cache\npitlane temporal-context --refresh\n</code></pre></p> <p>Output (text format): <pre><code>F1 Temporal Context (2024-05-23 14:30 UTC)\n\nSeason Status: 2024 Season - In Progress\n- Races completed: 7/24\n- Races remaining: 17\n\nCurrent Race Weekend: Monaco Grand Prix (Round 8)\n- Location: Monaco, Monaco\n- Event Date: 2024-05-26\n- Phase: Practice\n- Current Session: FP1 (Live - Started 15 minutes ago)\n- Next Session: FP2 (in 2 hours 15 minutes)\n\nLast Completed Race: Emilia Romagna Grand Prix\n- Completed: 3 days ago\n\nNext Race: Monaco Grand Prix (in 3 days)\n</code></pre></p>"},{"location":"agent-cli/cli-reference/#session-types","title":"Session Types","text":"Code Session Name <code>R</code> Race <code>Q</code> Qualifying <code>S</code> Sprint Race <code>SQ</code> Sprint Qualifying <code>FP1</code> Free Practice 1 <code>FP2</code> Free Practice 2 <code>FP3</code> Free Practice 3"},{"location":"agent-cli/cli-reference/#common-driver-codes-2024","title":"Common Driver Codes (2024)","text":"Code Driver Team VER Max Verstappen Red Bull PER Sergio Perez Red Bull HAM Lewis Hamilton Mercedes RUS George Russell Mercedes LEC Charles Leclerc Ferrari SAI Carlos Sainz Ferrari NOR Lando Norris McLaren PIA Oscar Piastri McLaren ALO Fernando Alonso Aston Martin STR Lance Stroll Aston Martin <p>See Ergast API for complete driver codes.</p>"},{"location":"agent-cli/cli-reference/#exit-codes","title":"Exit Codes","text":"Code Meaning 0 Success 1 Error (with JSON error message on stderr)"},{"location":"agent-cli/cli-reference/#related-documentation","title":"Related Documentation","text":"<ul> <li>Analysis Types - Detailed analysis workflows</li> <li>Skills Usage - Using skills in agent mode</li> <li>Architecture: Workspace Management - Workspace internals</li> </ul>"},{"location":"agent-cli/skills-usage/","title":"Using Skills","text":"<p>Agent-Only Documentation</p> <p>This documentation describes agent behavior and skills system design. End users interact with these features through the Web Interface.</p> <p>Skills extend the F1 agent with specialized analysis capabilities. Each skill is automatically invoked based on your question.</p>"},{"location":"agent-cli/skills-usage/#how-skills-work","title":"How Skills Work","text":"<p>When you ask a question, the agent:</p> <ol> <li>Analyzes Intent - Determines which skill is relevant</li> <li>Invokes Skill - Passes your question to the skill</li> <li>Skill Executes - Runs Python scripts via <code>pitlane</code> CLI</li> <li>Returns Result - Provides analysis and visualizations</li> </ol> <pre><code>User Query\n    \u2193\nAgent Reasoning\n    \u2193\nSkill Invocation (f1-analyst, f1-drivers, or f1-schedule)\n    \u2193\nCLI Execution (pitlane fetch/analyze commands)\n    \u2193\nData Processing &amp; Visualization\n    \u2193\nResponse with Charts &amp; Analysis\n</code></pre>"},{"location":"agent-cli/skills-usage/#available-skills","title":"Available Skills","text":""},{"location":"agent-cli/skills-usage/#f1-analyst","title":"f1-analyst","text":"<p>Purpose: Data analysis and visualization using FastF1</p> <p>Triggers: - Lap time questions: \"Compare VER and HAM lap times\" - Strategy questions: \"Show me Ferrari's tyre strategy\" - Telemetry questions: \"Compare speed traces\" - Performance questions: \"Who was fastest in Q3?\"</p> <p>Capabilities: - Lap time distributions - Tyre strategy timelines - Telemetry comparisons - Statistical analysis</p> <p>Example: <pre><code>User: Compare Verstappen and Hamilton lap times in Monaco qualifying\n\nAgent: [Invokes f1-analyst skill]\n\nSkill Actions:\n1. Fetch session info: pitlane fetch session-info --year 2024 --gp Monaco --session Q\n2. Analyze lap times: pitlane analyze lap-times --drivers VER --drivers HAM\n3. Generate chart: workspace/charts/lap_times.png\n4. Return analysis with statistics\n\nResult: \"Verstappen was 0.234s faster on average (1:12.345 vs 1:12.579)\"\n       [lap_times.png displayed]\n</code></pre></p>"},{"location":"agent-cli/skills-usage/#f1-drivers","title":"f1-drivers","text":"<p>Purpose: Driver information via Ergast API</p> <p>Triggers: - Driver roster questions: \"Who drove for Ferrari in 2019?\" - Driver code questions: \"What's Leclerc's driver code?\" - Team lineup questions: \"Show me Mercedes drivers\"</p> <p>Capabilities: - Season driver rosters - Driver codes and names - Team affiliations - Nationality and Wikipedia links</p> <p>Example: <pre><code>User: Who drove for Ferrari in 2024?\n\nAgent: [Invokes f1-drivers skill]\n\nSkill Actions:\n1. Fetch drivers: pitlane fetch drivers --year 2024 --team Ferrari\n2. Parse results\n3. Format response\n\nResult: \"Ferrari's 2024 drivers: Charles Leclerc (LEC) and Carlos Sainz (SAI)\"\n</code></pre></p>"},{"location":"agent-cli/skills-usage/#f1-schedule","title":"f1-schedule","text":"<p>Purpose: Event calendar and session schedules</p> <p>Triggers: - Calendar questions: \"When is the next race?\" - Schedule questions: \"Show me the 2024 calendar\" - Session timing questions: \"What time is qualifying?\"</p> <p>Capabilities: - Season calendars - Race dates and locations - Session schedules - Sprint weekend identification</p> <p>Example: <pre><code>User: When is the Monaco Grand Prix?\n\nAgent: [Invokes f1-schedule skill]\n\nSkill Actions:\n1. Fetch schedule: pitlane fetch schedule --year 2024\n2. Find Monaco event\n3. Extract dates and times\n\nResult: \"Monaco Grand Prix is on May 26, 2024 (Round 8)\"\n</code></pre></p>"},{"location":"agent-cli/skills-usage/#skill-selection","title":"Skill Selection","text":"<p>The agent automatically selects the appropriate skill based on query keywords:</p> Query Keywords Skill Invoked lap times, pace, qualifying, race f1-analyst strategy, tyres, pit stops f1-analyst telemetry, speed, braking f1-analyst driver, roster, code f1-drivers schedule, calendar, when, date f1-schedule"},{"location":"agent-cli/skills-usage/#sub-skills","title":"Sub-Skills","text":"<p>Complex skills like <code>f1-analyst</code> use sub-skills for organization:</p> <pre><code>f1-analyst/\n\u251c\u2500\u2500 SKILL.md (main routing)\n\u2514\u2500\u2500 references/\n    \u251c\u2500\u2500 lap_times.md        # Lap time analysis\n    \u251c\u2500\u2500 strategy.md         # Tyre strategy\n    \u251c\u2500\u2500 telemetry.md        # Telemetry comparison\n    \u2514\u2500\u2500 standings.md        # Championship standings\n</code></pre> <p>The main skill reads the appropriate reference based on query type.</p>"},{"location":"agent-cli/skills-usage/#workspace-integration","title":"Workspace Integration","text":"<p>Skills use the session workspace for data persistence:</p> <pre><code>~/.pitlane/workspaces/&lt;session-id&gt;/\n\u251c\u2500\u2500 data/\n\u2502   \u251c\u2500\u2500 session_info.json   # Fetched by skills\n\u2502   \u251c\u2500\u2500 drivers.json\n\u2502   \u2514\u2500\u2500 schedule.json\n\u2514\u2500\u2500 charts/\n    \u251c\u2500\u2500 lap_times.png       # Generated by skills\n    \u2514\u2500\u2500 strategy.png\n</code></pre> <p>Benefits: - Session isolation (no data mixing) - Persistent data for debugging - Charts accessible via web interface</p>"},{"location":"agent-cli/skills-usage/#tool-permissions","title":"Tool Permissions","text":"<p>Skills have restricted tool access for security:</p> Tool Access Level Bash <code>pitlane</code> CLI commands only Read Workspace directory only Write Workspace directory only WebFetch Not available (unless explicit) Skill Not available (no nested skills) <p>See Architecture: Tool Permissions for details.</p>"},{"location":"agent-cli/skills-usage/#example-conversations","title":"Example Conversations","text":""},{"location":"agent-cli/skills-usage/#lap-time-analysis","title":"Lap Time Analysis","text":"<pre><code>User: Compare Verstappen, Hamilton, and Leclerc lap times in Monaco 2024 qualifying\n\nAgent: I'll analyze the qualifying lap times for those three drivers.\n\n[Invokes f1-analyst skill \u2192 lap_times.md]\n\npitlane fetch session-info --session-id abc123 --year 2024 --gp Monaco --session Q\npitlane analyze lap-times --session-id abc123 --year 2024 --gp Monaco --session Q \\\n  --drivers VER --drivers HAM --drivers LEC\n\n[Generates lap_times.png]\n\nHere's the comparison:\n\n1. Max Verstappen (VER): 1:12.123 (mean: 1:12.345)\n2. Charles Leclerc (LEC): 1:12.234 (mean: 1:12.456)\n3. Lewis Hamilton (HAM): 1:12.345 (mean: 1:12.567)\n\nVerstappen was fastest, with Leclerc 0.111s behind and Hamilton 0.222s behind.\n\n[Chart displayed showing lap time distributions]\n</code></pre>"},{"location":"agent-cli/skills-usage/#strategy-analysis","title":"Strategy Analysis","text":"<pre><code>User: What tyre strategy did Red Bull use in Silverstone 2024?\n\nAgent: I'll check Red Bull's tyre strategy for the Silverstone race.\n\n[Invokes f1-analyst skill \u2192 strategy.md]\n\npitlane fetch session-info --session-id abc123 --year 2024 --gp Silverstone --session R\npitlane analyze tyre-strategy --session-id abc123 --year 2024 --gp Silverstone --session R\n\n[Generates strategy.png]\n\nRed Bull's strategy:\n- Verstappen (VER): MEDIUM (Laps 1-20) \u2192 HARD (Laps 21-52)\n- Perez (PER): SOFT (Laps 1-15) \u2192 MEDIUM (Laps 16-52)\n\nVerstappen used a one-stop strategy with a later pit stop, while Perez started on softs\nand made an earlier pit stop to mediums.\n\n[Chart displayed showing strategy timeline]\n</code></pre>"},{"location":"agent-cli/skills-usage/#driver-information","title":"Driver Information","text":"<pre><code>User: Who drove for McLaren in 2023?\n\nAgent: I'll look up McLaren's driver lineup for the 2023 season.\n\n[Invokes f1-drivers skill]\n\npitlane fetch drivers --session-id abc123 --year 2023 --team McLaren\n\nMcLaren's 2023 drivers:\n- Lando Norris (NOR) - British\n- Oscar Piastri (PIA) - Australian\n</code></pre>"},{"location":"agent-cli/skills-usage/#best-practices","title":"Best Practices","text":""},{"location":"agent-cli/skills-usage/#be-specific","title":"Be Specific","text":"<p>Good: \"Compare Verstappen and Hamilton lap times in Monaco 2024 qualifying\" Bad: \"Show me lap times\" (missing: who, where, when, which session)</p>"},{"location":"agent-cli/skills-usage/#use-official-names","title":"Use Official Names","text":"<p>Good: \"Monaco Grand Prix\", \"Silverstone\", \"British Grand Prix\" Bad: \"Monaco race\", \"UK GP\" (may not match FastF1 event names)</p>"},{"location":"agent-cli/skills-usage/#check-season-year","title":"Check Season Year","text":"<p>Good: \"2024 calendar\" Bad: \"current season\" (agent needs explicit year)</p> <p>Note: The agent has temporal context, so \"last race\" and \"next race\" work.</p>"},{"location":"agent-cli/skills-usage/#troubleshooting","title":"Troubleshooting","text":""},{"location":"agent-cli/skills-usage/#skill-not-triggered","title":"Skill Not Triggered","text":"<p>Symptom: Agent doesn't invoke a skill</p> <p>Causes: - Query too vague - Missing required information (year, GP, session) - Ambiguous intent</p> <p>Solution: Be more specific about what you want</p>"},{"location":"agent-cli/skills-usage/#data-not-found","title":"Data Not Found","text":"<p>Symptom: Error: \"Session not found\" or \"No data available\"</p> <p>Causes: - Incorrect GP name (use official name from FastF1) - Session not yet available (too recent) - Typo in driver code</p> <p>Solution: - Check GP name: <code>pitlane fetch schedule --year 2024</code> - Wait 1+ hour after session for data availability - Use 3-letter driver codes: VER, HAM, LEC, etc.</p>"},{"location":"agent-cli/skills-usage/#chart-not-generated","title":"Chart Not Generated","text":"<p>Symptom: No visualization in response</p> <p>Causes: - Analysis failed (check workspace/data for errors) - Insufficient data (e.g., only 1 lap) - Tool permission denied</p> <p>Solution: - Check workspace: <code>pitlane workspace info --session-id &lt;id&gt;</code> - Enable tracing: <code>PITLANE_TRACING_ENABLED=1</code></p>"},{"location":"agent-cli/skills-usage/#related-documentation","title":"Related Documentation","text":"<ul> <li>Analysis Types - Available analysis workflows</li> <li>CLI Reference - Underlying CLI commands</li> <li>Architecture: Skills - Skill system internals</li> <li>Developer Guide: Adding Skills - Creating custom skills</li> </ul>"},{"location":"agent-cli/tracing/","title":"Tracing","text":"<p>Agent-Only Tool</p> <p>Tracing is designed for agent debugging and development, not direct user interaction. End users should use the Web Interface.</p> <p>PitLane-AI includes OpenTelemetry-based tracing to observe agent behavior, tool calls, and permission checks. Tracing makes the agent's decision-making transparent and debuggable.</p>"},{"location":"agent-cli/tracing/#quick-start","title":"Quick Start","text":""},{"location":"agent-cli/tracing/#enable-tracing","title":"Enable Tracing","text":"<p>CLI: <pre><code>PITLANE_TRACING_ENABLED=1 pitlane-agent\n</code></pre></p> <p>Web Interface: <pre><code>PITLANE_TRACING_ENABLED=1 uvx pitlane-web --env development\n</code></pre></p> <p>Python API: <pre><code>from pitlane_agent import F1Agent\n\nagent = F1Agent(enable_tracing=True)\n</code></pre></p>"},{"location":"agent-cli/tracing/#what-gets-traced","title":"What Gets Traced","text":""},{"location":"agent-cli/tracing/#1-tool-invocations","title":"1. Tool Invocations","text":"<p>Every tool call is logged with: - Tool name (Bash, Read, Write, WebFetch, Skill) - Input parameters - Execution timing - Result summary</p> <p>Example: <pre><code>[TOOL] Bash\n  Command: pitlane fetch session-info --year 2024 --gp Monaco --session R\n  Duration: 1.234s\n  Status: Success\n\n[TOOL] Write\n  File: ~/.pitlane/workspaces/abc123/data/session_info.json\n  Size: 2.1 KB\n  Status: Success\n</code></pre></p>"},{"location":"agent-cli/tracing/#2-permission-checks","title":"2. Permission Checks","text":"<p>Permission decisions are logged with rationale:</p> <p>Example: <pre><code>[PERMISSION] Bash: ALLOWED\n  Command: pitlane fetch session-info\n  Reason: Matches pitlane CLI pattern\n\n[PERMISSION] WebFetch: DENIED\n  URL: https://example.com/data\n  Domain: example.com\n  Reason: Domain not in allowed list (ergast.com, formula1.com, wikipedia.org)\n\n[PERMISSION] Read: ALLOWED\n  File: ~/.pitlane/workspaces/abc123/data/session_info.json\n  Reason: File within workspace directory\n</code></pre></p>"},{"location":"agent-cli/tracing/#3-skill-execution","title":"3. Skill Execution","text":"<p>Skill invocations are traced:</p> <p>Example: <pre><code>[SKILL] f1-analyst\n  Prompt: Compare Verstappen and Hamilton lap times\n  Sub-skill: references/lap_times.md\n  Duration: 3.456s\n  Status: Success\n</code></pre></p>"},{"location":"agent-cli/tracing/#4-agent-decisions","title":"4. Agent Decisions","text":"<p>High-level agent reasoning is logged:</p> <p>Example: <pre><code>[AGENT] Analyzing query: \"Compare VER and HAM lap times in Monaco\"\n[AGENT] Determined intent: Lap time comparison\n[AGENT] Selecting skill: f1-analyst\n[AGENT] Invoking skill with parameters: year=2024, gp=Monaco, drivers=[VER, HAM]\n</code></pre></p>"},{"location":"agent-cli/tracing/#configuration","title":"Configuration","text":""},{"location":"agent-cli/tracing/#environment-variables","title":"Environment Variables","text":"<pre><code># Enable/disable tracing\nPITLANE_TRACING_ENABLED=1  # or \"true\", \"yes\", \"on\"\n\n# Span processor type\nPITLANE_SPAN_PROCESSOR=simple   # Default: immediate output\nPITLANE_SPAN_PROCESSOR=batch    # Batched output (production)\n</code></pre>"},{"location":"agent-cli/tracing/#processor-types","title":"Processor Types","text":"Processor Behavior Use Case <code>simple</code> Immediate output to stderr Development, debugging <code>batch</code> Batched output (periodic flush) Production, performance <p>Simple Processor: <pre><code>PITLANE_SPAN_PROCESSOR=simple PITLANE_TRACING_ENABLED=1 pitlane-agent\n</code></pre></p> <p>Batch Processor: <pre><code>PITLANE_SPAN_PROCESSOR=batch PITLANE_TRACING_ENABLED=1 pitlane-agent\n</code></pre></p>"},{"location":"agent-cli/tracing/#output-format","title":"Output Format","text":"<p>Traces are written to stderr in structured format:</p> <pre><code>[TIMESTAMP] [LEVEL] [COMPONENT] Message\n  Key: Value\n  Key: Value\n</code></pre> <p>Example: <pre><code>2024-05-23 14:30:15 INFO TOOL Bash invoked\n  command: pitlane fetch session-info --year 2024 --gp Monaco --session R\n  duration: 1.234s\n  status: success\n\n2024-05-23 14:30:16 INFO PERMISSION Read check\n  tool: Read\n  file_path: ~/.pitlane/workspaces/abc123/data/session_info.json\n  allowed: true\n  reason: File within workspace\n\n2024-05-23 14:30:17 WARN PERMISSION WebFetch denied\n  tool: WebFetch\n  url: https://example.com/data\n  domain: example.com\n  allowed: false\n  reason: Domain not in allowed list\n</code></pre></p>"},{"location":"agent-cli/tracing/#use-cases","title":"Use Cases","text":""},{"location":"agent-cli/tracing/#debugging-agent-behavior","title":"Debugging Agent Behavior","text":"<p>Scenario: Agent not generating expected chart</p> <p>With Tracing: <pre><code>[TOOL] Bash\n  Command: pitlane analyze lap-times ...\n  Status: Error\n  Error: No lap data found for session\n\n[AGENT] Analysis failed: Session data not available\n</code></pre></p> <p>Solution: Fetch session info first</p>"},{"location":"agent-cli/tracing/#auditing-tool-usage","title":"Auditing Tool Usage","text":"<p>Scenario: Verify agent only uses approved tools</p> <p>With Tracing: <pre><code>[PERMISSION] Bash: ALLOWED (pitlane CLI)\n[PERMISSION] Read: ALLOWED (workspace file)\n[PERMISSION] Write: ALLOWED (workspace file)\n[PERMISSION] WebFetch: DENIED (non-F1 domain)\n</code></pre></p> <p>Confirmation: Agent respects tool restrictions</p>"},{"location":"agent-cli/tracing/#performance-analysis","title":"Performance Analysis","text":"<p>Scenario: Identify slow operations</p> <p>With Tracing: <pre><code>[TOOL] Bash (pitlane fetch session-info)\n  Duration: 5.234s  \u2190 Slow (first fetch populates cache)\n\n[TOOL] Bash (pitlane analyze lap-times)\n  Duration: 0.456s  \u2190 Fast (uses cached data)\n</code></pre></p> <p>Insight: First fetch is slow (FastF1 download), subsequent fast</p>"},{"location":"agent-cli/tracing/#understanding-skill-selection","title":"Understanding Skill Selection","text":"<p>Scenario: Verify correct skill invoked</p> <p>With Tracing: <pre><code>[AGENT] Query: \"Compare VER and HAM lap times\"\n[AGENT] Intent: Lap time analysis\n[AGENT] Selected skill: f1-analyst\n[SKILL] f1-analyst invoked\n  Sub-skill: references/lap_times.md\n</code></pre></p> <p>Confirmation: Correct skill and sub-skill selected</p>"},{"location":"agent-cli/tracing/#integration-with-logging","title":"Integration with Logging","text":"<p>Tracing uses standard Python logging:</p> <pre><code>import logging\n\n# Set log level\nlogging.basicConfig(level=logging.INFO)\n\n# Custom logger\nlogger = logging.getLogger(\"pitlane_agent\")\nlogger.setLevel(logging.DEBUG)\n</code></pre> <p>Log Levels: - <code>DEBUG</code> - Verbose internal details - <code>INFO</code> - Tool calls, permissions, decisions - <code>WARN</code> - Permission denials, recoverable errors - <code>ERROR</code> - Failures, exceptions</p>"},{"location":"agent-cli/tracing/#production-usage","title":"Production Usage","text":""},{"location":"agent-cli/tracing/#structured-logging","title":"Structured Logging","text":"<p>Send traces to logging infrastructure:</p> <pre><code>import logging.config\n\nlogging.config.dictConfig({\n    \"version\": 1,\n    \"handlers\": {\n        \"console\": {\n            \"class\": \"logging.StreamHandler\",\n            \"formatter\": \"json\",\n            \"stream\": \"ext://sys.stderr\",\n        },\n    },\n    \"formatters\": {\n        \"json\": {\n            \"class\": \"pythonjsonlogger.jsonlogger.JsonFormatter\",\n            \"format\": \"%(asctime)s %(name)s %(levelname)s %(message)s\",\n        },\n    },\n    \"root\": {\n        \"level\": \"INFO\",\n        \"handlers\": [\"console\"],\n    },\n})\n</code></pre>"},{"location":"agent-cli/tracing/#telemetry-export","title":"Telemetry Export","text":"<p>Export to OpenTelemetry collectors:</p> <pre><code>from opentelemetry import trace\nfrom opentelemetry.exporter.otlp.proto.grpc.trace_exporter import OTLPSpanExporter\nfrom opentelemetry.sdk.trace import TracerProvider\nfrom opentelemetry.sdk.trace.export import BatchSpanProcessor\n\n# Configure exporter\nexporter = OTLPSpanExporter(endpoint=\"https://otlp.example.com:4317\")\n\n# Set up tracer provider\ntrace.set_tracer_provider(TracerProvider())\ntrace.get_tracer_provider().add_span_processor(BatchSpanProcessor(exporter))\n</code></pre> <p>Backends: - Jaeger - Zipkin - Datadog - Honeycomb - AWS X-Ray</p>"},{"location":"agent-cli/tracing/#cli-integration","title":"CLI Integration","text":""},{"location":"agent-cli/tracing/#redirecting-traces","title":"Redirecting Traces","text":"<p>Capture to file: <pre><code>PITLANE_TRACING_ENABLED=1 pitlane-agent 2&gt;traces.log\n</code></pre></p> <p>Filter traces: <pre><code>PITLANE_TRACING_ENABLED=1 pitlane-agent 2&gt;&amp;1 | grep PERMISSION\n</code></pre></p> <p>Parse JSON: <pre><code>PITLANE_TRACING_ENABLED=1 pitlane-agent 2&gt;&amp;1 | jq -R 'fromjson?'\n</code></pre></p>"},{"location":"agent-cli/tracing/#related-documentation","title":"Related Documentation","text":"<ul> <li>Architecture: Agent System - Tracing integration points</li> <li>Architecture: Tool Permissions - Permission logging</li> <li>Developer Guide: Testing - Using traces in tests</li> </ul>"},{"location":"api-reference/pitlane-agent/agent/","title":"Agent API","text":"<p>Auto-generated API documentation for the F1Agent class.</p>"},{"location":"api-reference/pitlane-agent/agent/#pitlane_agent.agent.F1Agent","title":"<code>F1Agent</code>","text":"<p>AI agent for F1 data analysis using Claude Agent SDK.</p> Source code in <code>packages/pitlane-agent/src/pitlane_agent/agent.py</code> <pre><code>class F1Agent:\n    \"\"\"AI agent for F1 data analysis using Claude Agent SDK.\"\"\"\n\n    def __init__(\n        self,\n        session_id: str | None = None,\n        workspace_dir: Path | None = None,\n        enable_tracing: bool | None = None,\n        inject_temporal_context: bool = True,\n    ):\n        \"\"\"Initialize the F1 agent.\n\n        Args:\n            session_id: Session identifier. Auto-generated if None.\n            workspace_dir: Explicit workspace path. Derived from session_id if None.\n            enable_tracing: Enable OpenTelemetry tracing. If None, uses PITLANE_TRACING_ENABLED env var.\n            inject_temporal_context: Enable temporal context in system prompt. Default True.\n        \"\"\"\n        self.session_id = session_id or generate_session_id()\n        self.workspace_dir = workspace_dir or get_workspace_path(self.session_id)\n        self.inject_temporal_context = inject_temporal_context\n\n        # Verify workspace exists or create it\n        if not self.workspace_dir.exists():\n            create_workspace(self.session_id)\n        elif workspace_exists(self.session_id):\n            # Update last accessed timestamp\n            update_workspace_metadata(self.session_id)\n\n        # Configure tracing\n        if enable_tracing is not None:\n            if enable_tracing:\n                tracing.enable_tracing()\n            else:\n                tracing.disable_tracing()\n\n    @property\n    def charts_dir(self) -&gt; Path:\n        \"\"\"Get the charts directory for this workspace.\n\n        Backward-compatible property for accessing the charts directory.\n\n        Returns:\n            Path to the workspace charts directory.\n        \"\"\"\n        return self.workspace_dir / \"charts\"\n\n    async def chat(self, message: str) -&gt; AsyncIterator[str]:\n        \"\"\"Process a chat message and yield response text chunks.\n\n        Args:\n            message: The user's question or message.\n\n        Yields:\n            Text chunks from the assistant's response.\n        \"\"\"\n        import os\n\n        # Set session ID as environment variable so skills can access it\n        os.environ[\"PITLANE_SESSION_ID\"] = self.session_id\n\n        # Configure hooks for tracing\n        hooks = None\n        if tracing.is_tracing_enabled():\n            hooks = {\n                \"PreToolUse\": [HookMatcher(matcher=None, hooks=[tracing.pre_tool_use_hook])],\n                \"PostToolUse\": [HookMatcher(matcher=None, hooks=[tracing.post_tool_use_hook])],\n            }\n\n        # Create a wrapper for can_use_tool that has access to workspace context\n        workspace_dir = str(self.workspace_dir)\n        session_id = self.session_id\n\n        async def can_use_tool_with_context(tool_name, input_params, context):\n            # Add workspace context to the permission context\n            context_with_workspace = {\n                **context,\n                \"workspace_dir\": workspace_dir,\n                \"session_id\": session_id,\n            }\n            return await can_use_tool(tool_name, input_params, context_with_workspace)\n\n        # Build system prompt with temporal context\n        system_prompt_parts = []\n\n        if self.inject_temporal_context:\n            try:\n                temporal_ctx = get_temporal_context()\n                temporal_prompt = format_for_system_prompt(temporal_ctx, verbosity=\"normal\")\n                system_prompt_parts.append(temporal_prompt)\n            except Exception:\n                # If temporal context fails, continue without it\n                pass\n\n        system_prompt_append = \"\\n\\n\".join(system_prompt_parts) if system_prompt_parts else None\n\n        options = ClaudeAgentOptions(\n            cwd=str(PACKAGE_DIR),\n            setting_sources=[\"project\"],\n            allowed_tools=[\"Skill\", \"Bash\", \"Read\", \"Write\", \"WebFetch\"],\n            can_use_tool=can_use_tool_with_context,\n            hooks=hooks,\n            system_prompt={\n                \"type\": \"preset\",\n                \"preset\": \"claude_code\",\n                \"append\": system_prompt_append,\n            }\n            if system_prompt_append\n            else None,\n        )\n\n        async with ClaudeSDKClient(options=options) as client:\n            await client.query(message)\n\n            async for msg in client.receive_response():\n                if isinstance(msg, AssistantMessage):\n                    for block in msg.content:\n                        if isinstance(block, TextBlock):\n                            yield block.text\n\n    async def chat_full(self, message: str) -&gt; str:\n        \"\"\"Process a chat message and return the full response.\n\n        Args:\n            message: The user's question or message.\n\n        Returns:\n            The complete response text.\n        \"\"\"\n        parts = []\n        async for chunk in self.chat(message):\n            parts.append(chunk)\n        return \"\\n\".join(parts) if parts else \"\"\n</code></pre>"},{"location":"api-reference/pitlane-agent/agent/#pitlane_agent.agent.F1Agent.charts_dir","title":"<code>charts_dir</code>  <code>property</code>","text":"<p>Get the charts directory for this workspace.</p> <p>Backward-compatible property for accessing the charts directory.</p> RETURNS DESCRIPTION <code>Path</code> <p>Path to the workspace charts directory.</p>"},{"location":"api-reference/pitlane-agent/agent/#pitlane_agent.agent.F1Agent.__init__","title":"<code>__init__(session_id=None, workspace_dir=None, enable_tracing=None, inject_temporal_context=True)</code>","text":"<p>Initialize the F1 agent.</p> PARAMETER DESCRIPTION <code>session_id</code> <p>Session identifier. Auto-generated if None.</p> <p> TYPE: <code>str | None</code> DEFAULT: <code>None</code> </p> <code>workspace_dir</code> <p>Explicit workspace path. Derived from session_id if None.</p> <p> TYPE: <code>Path | None</code> DEFAULT: <code>None</code> </p> <code>enable_tracing</code> <p>Enable OpenTelemetry tracing. If None, uses PITLANE_TRACING_ENABLED env var.</p> <p> TYPE: <code>bool | None</code> DEFAULT: <code>None</code> </p> <code>inject_temporal_context</code> <p>Enable temporal context in system prompt. Default True.</p> <p> TYPE: <code>bool</code> DEFAULT: <code>True</code> </p> Source code in <code>packages/pitlane-agent/src/pitlane_agent/agent.py</code> <pre><code>def __init__(\n    self,\n    session_id: str | None = None,\n    workspace_dir: Path | None = None,\n    enable_tracing: bool | None = None,\n    inject_temporal_context: bool = True,\n):\n    \"\"\"Initialize the F1 agent.\n\n    Args:\n        session_id: Session identifier. Auto-generated if None.\n        workspace_dir: Explicit workspace path. Derived from session_id if None.\n        enable_tracing: Enable OpenTelemetry tracing. If None, uses PITLANE_TRACING_ENABLED env var.\n        inject_temporal_context: Enable temporal context in system prompt. Default True.\n    \"\"\"\n    self.session_id = session_id or generate_session_id()\n    self.workspace_dir = workspace_dir or get_workspace_path(self.session_id)\n    self.inject_temporal_context = inject_temporal_context\n\n    # Verify workspace exists or create it\n    if not self.workspace_dir.exists():\n        create_workspace(self.session_id)\n    elif workspace_exists(self.session_id):\n        # Update last accessed timestamp\n        update_workspace_metadata(self.session_id)\n\n    # Configure tracing\n    if enable_tracing is not None:\n        if enable_tracing:\n            tracing.enable_tracing()\n        else:\n            tracing.disable_tracing()\n</code></pre>"},{"location":"api-reference/pitlane-agent/agent/#pitlane_agent.agent.F1Agent.chat","title":"<code>chat(message)</code>  <code>async</code>","text":"<p>Process a chat message and yield response text chunks.</p> PARAMETER DESCRIPTION <code>message</code> <p>The user's question or message.</p> <p> TYPE: <code>str</code> </p> YIELDS DESCRIPTION <code>AsyncIterator[str]</code> <p>Text chunks from the assistant's response.</p> Source code in <code>packages/pitlane-agent/src/pitlane_agent/agent.py</code> <pre><code>async def chat(self, message: str) -&gt; AsyncIterator[str]:\n    \"\"\"Process a chat message and yield response text chunks.\n\n    Args:\n        message: The user's question or message.\n\n    Yields:\n        Text chunks from the assistant's response.\n    \"\"\"\n    import os\n\n    # Set session ID as environment variable so skills can access it\n    os.environ[\"PITLANE_SESSION_ID\"] = self.session_id\n\n    # Configure hooks for tracing\n    hooks = None\n    if tracing.is_tracing_enabled():\n        hooks = {\n            \"PreToolUse\": [HookMatcher(matcher=None, hooks=[tracing.pre_tool_use_hook])],\n            \"PostToolUse\": [HookMatcher(matcher=None, hooks=[tracing.post_tool_use_hook])],\n        }\n\n    # Create a wrapper for can_use_tool that has access to workspace context\n    workspace_dir = str(self.workspace_dir)\n    session_id = self.session_id\n\n    async def can_use_tool_with_context(tool_name, input_params, context):\n        # Add workspace context to the permission context\n        context_with_workspace = {\n            **context,\n            \"workspace_dir\": workspace_dir,\n            \"session_id\": session_id,\n        }\n        return await can_use_tool(tool_name, input_params, context_with_workspace)\n\n    # Build system prompt with temporal context\n    system_prompt_parts = []\n\n    if self.inject_temporal_context:\n        try:\n            temporal_ctx = get_temporal_context()\n            temporal_prompt = format_for_system_prompt(temporal_ctx, verbosity=\"normal\")\n            system_prompt_parts.append(temporal_prompt)\n        except Exception:\n            # If temporal context fails, continue without it\n            pass\n\n    system_prompt_append = \"\\n\\n\".join(system_prompt_parts) if system_prompt_parts else None\n\n    options = ClaudeAgentOptions(\n        cwd=str(PACKAGE_DIR),\n        setting_sources=[\"project\"],\n        allowed_tools=[\"Skill\", \"Bash\", \"Read\", \"Write\", \"WebFetch\"],\n        can_use_tool=can_use_tool_with_context,\n        hooks=hooks,\n        system_prompt={\n            \"type\": \"preset\",\n            \"preset\": \"claude_code\",\n            \"append\": system_prompt_append,\n        }\n        if system_prompt_append\n        else None,\n    )\n\n    async with ClaudeSDKClient(options=options) as client:\n        await client.query(message)\n\n        async for msg in client.receive_response():\n            if isinstance(msg, AssistantMessage):\n                for block in msg.content:\n                    if isinstance(block, TextBlock):\n                        yield block.text\n</code></pre>"},{"location":"api-reference/pitlane-agent/agent/#pitlane_agent.agent.F1Agent.chat_full","title":"<code>chat_full(message)</code>  <code>async</code>","text":"<p>Process a chat message and return the full response.</p> PARAMETER DESCRIPTION <code>message</code> <p>The user's question or message.</p> <p> TYPE: <code>str</code> </p> RETURNS DESCRIPTION <code>str</code> <p>The complete response text.</p> Source code in <code>packages/pitlane-agent/src/pitlane_agent/agent.py</code> <pre><code>async def chat_full(self, message: str) -&gt; str:\n    \"\"\"Process a chat message and return the full response.\n\n    Args:\n        message: The user's question or message.\n\n    Returns:\n        The complete response text.\n    \"\"\"\n    parts = []\n    async for chunk in self.chat(message):\n        parts.append(chunk)\n    return \"\\n\".join(parts) if parts else \"\"\n</code></pre>"},{"location":"api-reference/pitlane-agent/cli/","title":"CLI API","text":"<p>Auto-generated API documentation for CLI commands.</p>"},{"location":"api-reference/pitlane-agent/cli/#pitlane_agent.cli","title":"<code>cli</code>","text":"<p>PitLane AI CLI - Workspace-based interface for F1 data analysis.</p> Usage <p>pitlane --help pitlane workspace create --session-id my-analysis pitlane fetch session-info --session-id my-analysis --year 2024 --gp Monaco --session R pitlane analyze lap-times --session-id my-analysis --year 2024 --gp Monaco --session Q --drivers VER --drivers HAM</p>"},{"location":"api-reference/pitlane-agent/cli/#pitlane_agent.cli.pitlane","title":"<code>pitlane()</code>","text":"<p>PitLane AI - F1 data analysis tools powered by FastF1 and Claude.</p>"},{"location":"api-reference/pitlane-agent/cli/#pitlane_agent.cli.workspace","title":"<code>workspace()</code>","text":"<p>Manage workspaces.</p>"},{"location":"api-reference/pitlane-agent/cli/#pitlane_agent.cli.temporal_context","title":"<code>temporal_context(format, refresh, verbosity)</code>","text":"<p>Show current F1 temporal context.</p> <p>This command displays the current state of the F1 season including: - Current season year and phase (pre/in/post/off-season) - Active race weekend (if any) - Current or recent sessions - Next upcoming race - Last completed race</p>"},{"location":"api-reference/pitlane-agent/scripts/","title":"Workspace Scripts API","text":"<p>Auto-generated API documentation for workspace management scripts.</p>"},{"location":"api-reference/pitlane-agent/scripts/#pitlane_agent.scripts.workspace","title":"<code>workspace</code>","text":"<p>Workspace management functions for PitLane AI.</p> <p>This module provides utilities for creating, managing, and cleaning up workspace directories used by the F1Agent.</p>"},{"location":"api-reference/pitlane-agent/scripts/#pitlane_agent.scripts.workspace.create_workspace","title":"<code>create_workspace(session_id=None, description=None, max_retries=3)</code>","text":"<p>Create a new workspace directory structure.</p> <p>Implements collision retry logic for auto-generated session IDs.</p> PARAMETER DESCRIPTION <code>session_id</code> <p>Session identifier. Auto-generated if None.</p> <p> TYPE: <code>str | None</code> DEFAULT: <code>None</code> </p> <code>description</code> <p>Optional description for the workspace.</p> <p> TYPE: <code>str | None</code> DEFAULT: <code>None</code> </p> <code>max_retries</code> <p>Maximum retry attempts for UUID collision (default: 3).</p> <p> TYPE: <code>int</code> DEFAULT: <code>3</code> </p> RETURNS DESCRIPTION <code>dict</code> <p>Dictionary with workspace information:</p> <code>dict</code> <p>{ \"session_id\": str, \"workspace_path\": str, \"created_at\": str,</p> <code>dict</code> <p>}</p> RAISES DESCRIPTION <code>ValueError</code> <p>If workspace already exists for the given session_id.</p> <code>RuntimeError</code> <p>If failed to generate unique session ID after max_retries.</p> Source code in <code>packages/pitlane-agent/src/pitlane_agent/scripts/workspace.py</code> <pre><code>def create_workspace(session_id: str | None = None, description: str | None = None, max_retries: int = 3) -&gt; dict:\n    \"\"\"Create a new workspace directory structure.\n\n    Implements collision retry logic for auto-generated session IDs.\n\n    Args:\n        session_id: Session identifier. Auto-generated if None.\n        description: Optional description for the workspace.\n        max_retries: Maximum retry attempts for UUID collision (default: 3).\n\n    Returns:\n        Dictionary with workspace information:\n        {\n            \"session_id\": str,\n            \"workspace_path\": str,\n            \"created_at\": str,\n        }\n\n    Raises:\n        ValueError: If workspace already exists for the given session_id.\n        RuntimeError: If failed to generate unique session ID after max_retries.\n    \"\"\"\n    if session_id is not None:\n        # Explicit session_id provided - no retry logic\n        if workspace_exists(session_id):\n            raise ValueError(f\"Workspace already exists for session ID: {session_id}\")\n        return _create_workspace_internal(session_id, description)\n\n    # Auto-generate session ID with collision retry\n    for _attempt in range(max_retries):\n        session_id = generate_session_id()\n        if not workspace_exists(session_id):\n            return _create_workspace_internal(session_id, description)\n\n    raise RuntimeError(f\"Failed to generate unique session ID after {max_retries} attempts\")\n</code></pre>"},{"location":"api-reference/pitlane-agent/scripts/#pitlane_agent.scripts.workspace.get_workspace_path","title":"<code>get_workspace_path(session_id)</code>","text":"<p>Get the workspace path for a given session ID.</p> PARAMETER DESCRIPTION <code>session_id</code> <p>The session identifier.</p> <p> TYPE: <code>str</code> </p> RETURNS DESCRIPTION <code>Path</code> <p>Path to the workspace directory.</p> Source code in <code>packages/pitlane-agent/src/pitlane_agent/scripts/workspace.py</code> <pre><code>def get_workspace_path(session_id: str) -&gt; Path:\n    \"\"\"Get the workspace path for a given session ID.\n\n    Args:\n        session_id: The session identifier.\n\n    Returns:\n        Path to the workspace directory.\n    \"\"\"\n    return get_workspace_base() / session_id\n</code></pre>"},{"location":"api-reference/pitlane-agent/scripts/#pitlane_agent.scripts.workspace.workspace_exists","title":"<code>workspace_exists(session_id)</code>","text":"<p>Check if a workspace exists for the given session ID.</p> PARAMETER DESCRIPTION <code>session_id</code> <p>The session identifier.</p> <p> TYPE: <code>str</code> </p> RETURNS DESCRIPTION <code>bool</code> <p>True if workspace exists, False otherwise.</p> Source code in <code>packages/pitlane-agent/src/pitlane_agent/scripts/workspace.py</code> <pre><code>def workspace_exists(session_id: str) -&gt; bool:\n    \"\"\"Check if a workspace exists for the given session ID.\n\n    Args:\n        session_id: The session identifier.\n\n    Returns:\n        True if workspace exists, False otherwise.\n    \"\"\"\n    workspace_path = get_workspace_path(session_id)\n    return workspace_path.exists() and workspace_path.is_dir()\n</code></pre>"},{"location":"api-reference/pitlane-agent/scripts/#pitlane_agent.scripts.workspace.get_workspace_info","title":"<code>get_workspace_info(session_id)</code>","text":"<p>Get information about a workspace.</p> PARAMETER DESCRIPTION <code>session_id</code> <p>The session identifier.</p> <p> TYPE: <code>str</code> </p> RETURNS DESCRIPTION <code>dict</code> <p>Dictionary with workspace metadata including:</p> <code>dict</code> <p>{ \"session_id\": str, \"workspace_path\": str, \"created_at\": str, \"last_accessed\": str, \"description\": str (optional), \"data_files\": list[str], \"chart_files\": list[str],</p> <code>dict</code> <p>}</p> RAISES DESCRIPTION <code>ValueError</code> <p>If workspace doesn't exist.</p> Source code in <code>packages/pitlane-agent/src/pitlane_agent/scripts/workspace.py</code> <pre><code>def get_workspace_info(session_id: str) -&gt; dict:\n    \"\"\"Get information about a workspace.\n\n    Args:\n        session_id: The session identifier.\n\n    Returns:\n        Dictionary with workspace metadata including:\n        {\n            \"session_id\": str,\n            \"workspace_path\": str,\n            \"created_at\": str,\n            \"last_accessed\": str,\n            \"description\": str (optional),\n            \"data_files\": list[str],\n            \"chart_files\": list[str],\n        }\n\n    Raises:\n        ValueError: If workspace doesn't exist.\n    \"\"\"\n    if not workspace_exists(session_id):\n        raise ValueError(f\"Workspace does not exist for session ID: {session_id}\")\n\n    workspace_path = get_workspace_path(session_id)\n    metadata_path = workspace_path / \".metadata.json\"\n\n    if metadata_path.exists():\n        with open(metadata_path) as f:\n            metadata = json.load(f)\n    else:\n        metadata = {\n            \"session_id\": session_id,\n            \"created_at\": \"unknown\",\n            \"last_accessed\": \"unknown\",\n        }\n\n    # List data and chart files\n    data_dir = workspace_path / \"data\"\n    chart_dir = workspace_path / \"charts\"\n\n    data_files = [f.name for f in data_dir.iterdir() if f.is_file()] if data_dir.exists() else []\n    chart_files = [f.name for f in chart_dir.iterdir() if f.is_file()] if chart_dir.exists() else []\n\n    return {\n        **metadata,\n        \"workspace_path\": str(workspace_path),\n        \"data_files\": sorted(data_files),\n        \"chart_files\": sorted(chart_files),\n    }\n</code></pre>"},{"location":"api-reference/pitlane-agent/scripts/#pitlane_agent.scripts.workspace.list_workspaces","title":"<code>list_workspaces(show_all=False)</code>","text":"<p>List all workspaces.</p> PARAMETER DESCRIPTION <code>show_all</code> <p>If True, include all workspaces. If False, only recent ones.</p> <p> TYPE: <code>bool</code> DEFAULT: <code>False</code> </p> RETURNS DESCRIPTION <code>list[dict]</code> <p>List of workspace information dictionaries sorted by last_accessed (newest first).</p> Source code in <code>packages/pitlane-agent/src/pitlane_agent/scripts/workspace.py</code> <pre><code>def list_workspaces(show_all: bool = False) -&gt; list[dict]:\n    \"\"\"List all workspaces.\n\n    Args:\n        show_all: If True, include all workspaces. If False, only recent ones.\n\n    Returns:\n        List of workspace information dictionaries sorted by last_accessed (newest first).\n    \"\"\"\n    workspace_base = get_workspace_base()\n\n    if not workspace_base.exists():\n        return []\n\n    workspaces = []\n\n    for workspace_dir in workspace_base.iterdir():\n        if not workspace_dir.is_dir():\n            continue\n\n        session_id = workspace_dir.name\n        try:\n            info = get_workspace_info(session_id)\n            workspaces.append(info)\n        except Exception:\n            # Skip corrupted workspaces\n            continue\n\n    # Sort by last_accessed (newest first)\n    def get_last_accessed(ws):\n        try:\n            return datetime.fromisoformat(ws[\"last_accessed\"].rstrip(\"Z\"))\n        except Exception:\n            return datetime.min\n\n    workspaces.sort(key=get_last_accessed, reverse=True)\n\n    if not show_all:\n        # Limit to 10 most recent\n        workspaces = workspaces[:10]\n\n    return workspaces\n</code></pre>"},{"location":"api-reference/pitlane-agent/scripts/#pitlane_agent.scripts.workspace.remove_workspace","title":"<code>remove_workspace(session_id)</code>","text":"<p>Remove a workspace and all its contents.</p> PARAMETER DESCRIPTION <code>session_id</code> <p>The session identifier.</p> <p> TYPE: <code>str</code> </p> RAISES DESCRIPTION <code>ValueError</code> <p>If workspace doesn't exist.</p> Source code in <code>packages/pitlane-agent/src/pitlane_agent/scripts/workspace.py</code> <pre><code>def remove_workspace(session_id: str) -&gt; None:\n    \"\"\"Remove a workspace and all its contents.\n\n    Args:\n        session_id: The session identifier.\n\n    Raises:\n        ValueError: If workspace doesn't exist.\n    \"\"\"\n    if not workspace_exists(session_id):\n        raise ValueError(f\"Workspace does not exist for session ID: {session_id}\")\n\n    workspace_path = get_workspace_path(session_id)\n    shutil.rmtree(workspace_path)\n</code></pre>"},{"location":"api-reference/pitlane-agent/scripts/#pitlane_agent.scripts.workspace.clean_workspaces","title":"<code>clean_workspaces(older_than_days=None, remove_all=False)</code>","text":"<p>Clean up old workspaces.</p> PARAMETER DESCRIPTION <code>older_than_days</code> <p>Remove workspaces not accessed in this many days.</p> <p> TYPE: <code>int | None</code> DEFAULT: <code>None</code> </p> <code>remove_all</code> <p>If True, remove all workspaces (overrides older_than_days).</p> <p> TYPE: <code>bool</code> DEFAULT: <code>False</code> </p> RETURNS DESCRIPTION <code>dict</code> <p>Dictionary with cleanup statistics:</p> <code>dict</code> <p>{ \"removed_count\": int, \"removed_sessions\": list[str],</p> <code>dict</code> <p>}</p> Source code in <code>packages/pitlane-agent/src/pitlane_agent/scripts/workspace.py</code> <pre><code>def clean_workspaces(older_than_days: int | None = None, remove_all: bool = False) -&gt; dict:\n    \"\"\"Clean up old workspaces.\n\n    Args:\n        older_than_days: Remove workspaces not accessed in this many days.\n        remove_all: If True, remove all workspaces (overrides older_than_days).\n\n    Returns:\n        Dictionary with cleanup statistics:\n        {\n            \"removed_count\": int,\n            \"removed_sessions\": list[str],\n        }\n    \"\"\"\n    workspace_base = get_workspace_base()\n\n    if not workspace_base.exists():\n        return {\"removed_count\": 0, \"removed_sessions\": []}\n\n    removed_sessions = []\n\n    for workspace_dir in workspace_base.iterdir():\n        if not workspace_dir.is_dir():\n            continue\n\n        session_id = workspace_dir.name\n\n        # Check if should remove\n        should_remove = remove_all\n\n        if not should_remove and older_than_days is not None:\n            try:\n                info = get_workspace_info(session_id)\n                last_accessed = datetime.fromisoformat(info[\"last_accessed\"].rstrip(\"Z\")).replace(tzinfo=UTC)\n                age = datetime.now(UTC) - last_accessed\n\n                if age &gt; timedelta(days=older_than_days):\n                    should_remove = True\n            except Exception:\n                # If can't read metadata, don't remove (play it safe)\n                continue\n\n        if should_remove:\n            try:\n                remove_workspace(session_id)\n                removed_sessions.append(session_id)\n            except Exception:\n                # Skip if removal fails\n                continue\n\n    return {\n        \"removed_count\": len(removed_sessions),\n        \"removed_sessions\": removed_sessions,\n    }\n</code></pre>"},{"location":"api-reference/pitlane-agent/scripts/#pitlane_agent.scripts.workspace.update_workspace_metadata","title":"<code>update_workspace_metadata(session_id)</code>","text":"<p>Update the last_accessed timestamp in workspace metadata.</p> PARAMETER DESCRIPTION <code>session_id</code> <p>The session identifier.</p> <p> TYPE: <code>str</code> </p> RAISES DESCRIPTION <code>ValueError</code> <p>If workspace doesn't exist.</p> Source code in <code>packages/pitlane-agent/src/pitlane_agent/scripts/workspace.py</code> <pre><code>def update_workspace_metadata(session_id: str) -&gt; None:\n    \"\"\"Update the last_accessed timestamp in workspace metadata.\n\n    Args:\n        session_id: The session identifier.\n\n    Raises:\n        ValueError: If workspace doesn't exist.\n    \"\"\"\n    if not workspace_exists(session_id):\n        raise ValueError(f\"Workspace does not exist for session ID: {session_id}\")\n\n    workspace_path = get_workspace_path(session_id)\n    metadata_path = workspace_path / \".metadata.json\"\n\n    # Read existing metadata or create new\n    if not metadata_path.exists():\n        # Metadata missing, recreate it\n        now = datetime.now(UTC)\n        metadata = {\n            \"session_id\": session_id,\n            \"created_at\": now.isoformat() + \"Z\",\n            \"last_accessed\": now.isoformat() + \"Z\",\n        }\n    else:\n        with open(metadata_path) as f:\n            metadata = json.load(f)\n\n        metadata[\"last_accessed\"] = datetime.now(UTC).isoformat() + \"Z\"\n\n    # Atomic write using tempfile + rename\n    # Create temp file in same directory to ensure same filesystem\n    fd, temp_path = tempfile.mkstemp(dir=workspace_path, prefix=\".metadata.tmp.\", suffix=\".json\")\n\n    try:\n        with os.fdopen(fd, \"w\") as f:\n            json.dump(metadata, f, indent=2)\n\n        # Atomic rename (POSIX guarantee)\n        os.replace(temp_path, metadata_path)\n    except Exception:\n        # Clean up temp file on error\n        with suppress(Exception):\n            os.unlink(temp_path)\n        raise\n</code></pre>"},{"location":"api-reference/pitlane-agent/temporal/","title":"Temporal Context API","text":"<p>Auto-generated API documentation for the temporal context system.</p>"},{"location":"api-reference/pitlane-agent/temporal/#context-manager","title":"Context Manager","text":""},{"location":"api-reference/pitlane-agent/temporal/#pitlane_agent.temporal.TemporalContextManager","title":"<code>TemporalContextManager</code>","text":"<p>Manages F1 temporal context with intelligent caching.</p> Source code in <code>packages/pitlane-agent/src/pitlane_agent/temporal/context.py</code> <pre><code>class TemporalContextManager:\n    \"\"\"Manages F1 temporal context with intelligent caching.\"\"\"\n\n    def __init__(self, cache_dir: Path | None = None):\n        \"\"\"Initialize temporal context manager.\n\n        Args:\n            cache_dir: Override cache directory (defaults to ~/.pitlane/cache/temporal)\n        \"\"\"\n        from pitlane_agent.temporal.analyzer import TemporalAnalyzer\n        from pitlane_agent.temporal.cache import TemporalCache\n\n        self.cache = TemporalCache(cache_dir)\n        self.analyzer = TemporalAnalyzer()\n\n    def get_context(self, force_refresh: bool = False, current_time: datetime | None = None) -&gt; TemporalContext:\n        \"\"\"Get current temporal context.\n\n        Args:\n            force_refresh: Force fetch from FastF1 (ignore cache)\n            current_time: Override current time (for testing)\n\n        Returns:\n            Complete temporal context\n        \"\"\"\n        now = current_time or datetime.now(UTC)\n\n        # Check cache\n        if not force_refresh:\n            cached = self.cache.get(now)\n            if cached:\n                return cached\n\n        # Fetch and analyze\n        context = self.analyzer.analyze(now)\n\n        # Cache with intelligent TTL\n        self.cache.set(context)\n\n        return context\n</code></pre>"},{"location":"api-reference/pitlane-agent/temporal/#pitlane_agent.temporal.TemporalContextManager.get_context","title":"<code>get_context(force_refresh=False, current_time=None)</code>","text":"<p>Get current temporal context.</p> PARAMETER DESCRIPTION <code>force_refresh</code> <p>Force fetch from FastF1 (ignore cache)</p> <p> TYPE: <code>bool</code> DEFAULT: <code>False</code> </p> <code>current_time</code> <p>Override current time (for testing)</p> <p> TYPE: <code>datetime | None</code> DEFAULT: <code>None</code> </p> RETURNS DESCRIPTION <code>TemporalContext</code> <p>Complete temporal context</p> Source code in <code>packages/pitlane-agent/src/pitlane_agent/temporal/context.py</code> <pre><code>def get_context(self, force_refresh: bool = False, current_time: datetime | None = None) -&gt; TemporalContext:\n    \"\"\"Get current temporal context.\n\n    Args:\n        force_refresh: Force fetch from FastF1 (ignore cache)\n        current_time: Override current time (for testing)\n\n    Returns:\n        Complete temporal context\n    \"\"\"\n    now = current_time or datetime.now(UTC)\n\n    # Check cache\n    if not force_refresh:\n        cached = self.cache.get(now)\n        if cached:\n            return cached\n\n    # Fetch and analyze\n    context = self.analyzer.analyze(now)\n\n    # Cache with intelligent TTL\n    self.cache.set(context)\n\n    return context\n</code></pre>"},{"location":"api-reference/pitlane-agent/temporal/#data-structures","title":"Data Structures","text":""},{"location":"api-reference/pitlane-agent/temporal/#pitlane_agent.temporal.TemporalContext","title":"<code>TemporalContext</code>  <code>dataclass</code>","text":"<p>Complete temporal context for F1 agent.</p> Source code in <code>packages/pitlane-agent/src/pitlane_agent/temporal/context.py</code> <pre><code>@dataclass\nclass TemporalContext:\n    \"\"\"Complete temporal context for F1 agent.\"\"\"\n\n    current_time_utc: datetime\n    current_season: int\n    season_phase: F1Season\n\n    # Current race weekend (if any)\n    current_weekend: RaceWeekendContext | None\n\n    # Most recently completed race\n    last_completed_race: RaceWeekendContext | None\n\n    # Next upcoming race\n    next_race: RaceWeekendContext | None\n\n    # Quick stats\n    races_completed: int\n    races_remaining: int\n    days_until_next_race: int | None\n\n    # Metadata\n    cache_timestamp: datetime\n    ttl_seconds: int\n\n    def to_dict(self) -&gt; dict:\n        \"\"\"Convert to dictionary.\"\"\"\n        return {\n            \"current_time_utc\": self.current_time_utc.isoformat(),\n            \"current_season\": self.current_season,\n            \"season_phase\": self.season_phase.value,\n            \"current_weekend\": self.current_weekend.to_dict() if self.current_weekend else None,\n            \"last_completed_race\": self.last_completed_race.to_dict() if self.last_completed_race else None,\n            \"next_race\": self.next_race.to_dict() if self.next_race else None,\n            \"races_completed\": self.races_completed,\n            \"races_remaining\": self.races_remaining,\n            \"days_until_next_race\": self.days_until_next_race,\n            \"cache_timestamp\": self.cache_timestamp.isoformat(),\n            \"ttl_seconds\": self.ttl_seconds,\n        }\n</code></pre>"},{"location":"api-reference/pitlane-agent/temporal/#pitlane_agent.temporal.TemporalContext.to_dict","title":"<code>to_dict()</code>","text":"<p>Convert to dictionary.</p> Source code in <code>packages/pitlane-agent/src/pitlane_agent/temporal/context.py</code> <pre><code>def to_dict(self) -&gt; dict:\n    \"\"\"Convert to dictionary.\"\"\"\n    return {\n        \"current_time_utc\": self.current_time_utc.isoformat(),\n        \"current_season\": self.current_season,\n        \"season_phase\": self.season_phase.value,\n        \"current_weekend\": self.current_weekend.to_dict() if self.current_weekend else None,\n        \"last_completed_race\": self.last_completed_race.to_dict() if self.last_completed_race else None,\n        \"next_race\": self.next_race.to_dict() if self.next_race else None,\n        \"races_completed\": self.races_completed,\n        \"races_remaining\": self.races_remaining,\n        \"days_until_next_race\": self.days_until_next_race,\n        \"cache_timestamp\": self.cache_timestamp.isoformat(),\n        \"ttl_seconds\": self.ttl_seconds,\n    }\n</code></pre>"},{"location":"api-reference/pitlane-agent/temporal/#pitlane_agent.temporal.RaceWeekendContext","title":"<code>RaceWeekendContext</code>  <code>dataclass</code>","text":"<p>Information about a race weekend.</p> Source code in <code>packages/pitlane-agent/src/pitlane_agent/temporal/context.py</code> <pre><code>@dataclass\nclass RaceWeekendContext:\n    \"\"\"Information about a race weekend.\"\"\"\n\n    round_number: int\n    event_name: str  # e.g., \"Monaco Grand Prix\"\n    country: str\n    location: str\n    event_date: datetime\n    phase: RaceWeekendPhase\n    current_session: SessionContext | None\n    next_session: SessionContext | None\n    all_sessions: list[SessionContext]\n    is_sprint_weekend: bool\n\n    def to_dict(self) -&gt; dict:\n        \"\"\"Convert to dictionary.\"\"\"\n        return {\n            \"round_number\": self.round_number,\n            \"event_name\": self.event_name,\n            \"country\": self.country,\n            \"location\": self.location,\n            \"event_date\": self.event_date.isoformat(),\n            \"phase\": self.phase.value,\n            \"current_session\": self.current_session.to_dict() if self.current_session else None,\n            \"next_session\": self.next_session.to_dict() if self.next_session else None,\n            \"all_sessions\": [s.to_dict() for s in self.all_sessions],\n            \"is_sprint_weekend\": self.is_sprint_weekend,\n        }\n</code></pre>"},{"location":"api-reference/pitlane-agent/temporal/#pitlane_agent.temporal.RaceWeekendContext.to_dict","title":"<code>to_dict()</code>","text":"<p>Convert to dictionary.</p> Source code in <code>packages/pitlane-agent/src/pitlane_agent/temporal/context.py</code> <pre><code>def to_dict(self) -&gt; dict:\n    \"\"\"Convert to dictionary.\"\"\"\n    return {\n        \"round_number\": self.round_number,\n        \"event_name\": self.event_name,\n        \"country\": self.country,\n        \"location\": self.location,\n        \"event_date\": self.event_date.isoformat(),\n        \"phase\": self.phase.value,\n        \"current_session\": self.current_session.to_dict() if self.current_session else None,\n        \"next_session\": self.next_session.to_dict() if self.next_session else None,\n        \"all_sessions\": [s.to_dict() for s in self.all_sessions],\n        \"is_sprint_weekend\": self.is_sprint_weekend,\n    }\n</code></pre>"},{"location":"api-reference/pitlane-agent/temporal/#pitlane_agent.temporal.SessionContext","title":"<code>SessionContext</code>  <code>dataclass</code>","text":"<p>Information about a specific session.</p> Source code in <code>packages/pitlane-agent/src/pitlane_agent/temporal/context.py</code> <pre><code>@dataclass\nclass SessionContext:\n    \"\"\"Information about a specific session.\"\"\"\n\n    name: str  # e.g., \"Race\", \"Qualifying\"\n    session_type: str  # R, Q, FP1, etc.\n    date_utc: datetime\n    date_local: datetime\n    is_live: bool  # Currently happening\n    is_recent: bool  # Within last 24h\n    minutes_until: int | None  # None if past\n    minutes_since: int | None  # None if future\n\n    def to_dict(self) -&gt; dict:\n        \"\"\"Convert to dictionary with ISO format dates.\"\"\"\n        return {\n            \"name\": self.name,\n            \"session_type\": self.session_type,\n            \"date_utc\": self.date_utc.isoformat(),\n            \"date_local\": self.date_local.isoformat(),\n            \"is_live\": self.is_live,\n            \"is_recent\": self.is_recent,\n            \"minutes_until\": self.minutes_until,\n            \"minutes_since\": self.minutes_since,\n        }\n</code></pre>"},{"location":"api-reference/pitlane-agent/temporal/#pitlane_agent.temporal.SessionContext.to_dict","title":"<code>to_dict()</code>","text":"<p>Convert to dictionary with ISO format dates.</p> Source code in <code>packages/pitlane-agent/src/pitlane_agent/temporal/context.py</code> <pre><code>def to_dict(self) -&gt; dict:\n    \"\"\"Convert to dictionary with ISO format dates.\"\"\"\n    return {\n        \"name\": self.name,\n        \"session_type\": self.session_type,\n        \"date_utc\": self.date_utc.isoformat(),\n        \"date_local\": self.date_local.isoformat(),\n        \"is_live\": self.is_live,\n        \"is_recent\": self.is_recent,\n        \"minutes_until\": self.minutes_until,\n        \"minutes_since\": self.minutes_since,\n    }\n</code></pre>"},{"location":"api-reference/pitlane-agent/temporal/#enums","title":"Enums","text":""},{"location":"api-reference/pitlane-agent/temporal/#pitlane_agent.temporal.F1Season","title":"<code>F1Season</code>","text":"<p>               Bases: <code>str</code>, <code>Enum</code></p> <p>F1 season phase.</p> Source code in <code>packages/pitlane-agent/src/pitlane_agent/temporal/context.py</code> <pre><code>class F1Season(str, Enum):\n    \"\"\"F1 season phase.\"\"\"\n\n    PRE_SEASON = \"pre_season\"  # Before first race\n    IN_SEASON = \"in_season\"  # During championship\n    POST_SEASON = \"post_season\"  # After final race\n    OFF_SEASON = \"off_season\"  # Dec-Feb gap\n</code></pre>"},{"location":"api-reference/pitlane-agent/temporal/#pitlane_agent.temporal.RaceWeekendPhase","title":"<code>RaceWeekendPhase</code>","text":"<p>               Bases: <code>str</code>, <code>Enum</code></p> <p>Current phase within a race weekend.</p> Source code in <code>packages/pitlane-agent/src/pitlane_agent/temporal/context.py</code> <pre><code>class RaceWeekendPhase(str, Enum):\n    \"\"\"Current phase within a race weekend.\"\"\"\n\n    BEFORE_WEEKEND = \"before_weekend\"\n    PRACTICE = \"practice\"\n    QUALIFYING = \"qualifying\"\n    SPRINT = \"sprint\"\n    RACE = \"race\"\n    POST_RACE = \"post_race\"\n</code></pre>"},{"location":"api-reference/pitlane-agent/temporal/#functions","title":"Functions","text":""},{"location":"api-reference/pitlane-agent/temporal/#pitlane_agent.temporal.get_temporal_context","title":"<code>get_temporal_context(force_refresh=False, current_time=None)</code>","text":"<p>Get current F1 temporal context.</p> <p>This is the primary public API for accessing temporal context.</p> PARAMETER DESCRIPTION <code>force_refresh</code> <p>Force fetch from FastF1 (ignore cache)</p> <p> TYPE: <code>bool</code> DEFAULT: <code>False</code> </p> <code>current_time</code> <p>Override current time (for testing)</p> <p> TYPE: <code>datetime | None</code> DEFAULT: <code>None</code> </p> RETURNS DESCRIPTION <code>TemporalContext</code> <p>Complete temporal context</p> Example <p>context = get_temporal_context() print(f\"Current season: {context.current_season}\") if context.current_weekend:     print(f\"Race weekend: {context.current_weekend.event_name}\")</p> Source code in <code>packages/pitlane-agent/src/pitlane_agent/temporal/context.py</code> <pre><code>def get_temporal_context(force_refresh: bool = False, current_time: datetime | None = None) -&gt; TemporalContext:\n    \"\"\"Get current F1 temporal context.\n\n    This is the primary public API for accessing temporal context.\n\n    Args:\n        force_refresh: Force fetch from FastF1 (ignore cache)\n        current_time: Override current time (for testing)\n\n    Returns:\n        Complete temporal context\n\n    Example:\n        &gt;&gt;&gt; context = get_temporal_context()\n        &gt;&gt;&gt; print(f\"Current season: {context.current_season}\")\n        &gt;&gt;&gt; if context.current_weekend:\n        &gt;&gt;&gt;     print(f\"Race weekend: {context.current_weekend.event_name}\")\n    \"\"\"\n    global _manager\n    if _manager is None:\n        _manager = TemporalContextManager()\n    return _manager.get_context(force_refresh=force_refresh, current_time=current_time)\n</code></pre>"},{"location":"api-reference/pitlane-agent/temporal/#pitlane_agent.temporal.format_for_system_prompt","title":"<code>format_for_system_prompt(context, verbosity='normal')</code>","text":"<p>Format temporal context for inclusion in system prompt.</p> PARAMETER DESCRIPTION <code>context</code> <p>Temporal context</p> <p> TYPE: <code>TemporalContext</code> </p> <code>verbosity</code> <p>\"minimal\", \"normal\", or \"detailed\"</p> <p> TYPE: <code>str</code> DEFAULT: <code>'normal'</code> </p> RETURNS DESCRIPTION <code>str</code> <p>Formatted string for system prompt</p> Source code in <code>packages/pitlane-agent/src/pitlane_agent/temporal/formatter.py</code> <pre><code>def format_for_system_prompt(context: TemporalContext, verbosity: str = \"normal\") -&gt; str:\n    \"\"\"Format temporal context for inclusion in system prompt.\n\n    Args:\n        context: Temporal context\n        verbosity: \"minimal\", \"normal\", or \"detailed\"\n\n    Returns:\n        Formatted string for system prompt\n    \"\"\"\n    if verbosity == \"minimal\":\n        return _format_minimal(context)\n    elif verbosity == \"detailed\":\n        return _format_detailed(context)\n    else:\n        return _format_normal(context)\n</code></pre>"},{"location":"api-reference/pitlane-web/app/","title":"Web App API","text":"<p>Auto-generated API documentation for the FastAPI web application.</p>"},{"location":"api-reference/pitlane-web/app/#pitlane_web.app","title":"<code>app</code>","text":"<p>FastAPI application for PitLane AI with session management.</p>"},{"location":"api-reference/pitlane-web/app/#pitlane_web.app.app","title":"<code>app = FastAPI(title='PitLane AI', description='F1 data analysis powered by AI')</code>  <code>module-attribute</code>","text":""},{"location":"api-reference/pitlane-web/app/#pitlane_web.app.index","title":"<code>index(request, session=Cookie(None, alias=SESSION_COOKIE_NAME))</code>  <code>async</code>","text":"<p>Render the home page with session management.</p>"},{"location":"api-reference/pitlane-web/app/#pitlane_web.app.chat","title":"<code>chat(request, question=Form(...), session=Cookie(None, alias=SESSION_COOKIE_NAME))</code>  <code>async</code>","text":"<p>Process a user question and return an HTML response.</p> <p>Uses F1Agent with Claude Agent SDK to analyze F1 data.</p>"},{"location":"api-reference/pitlane-web/app/#pitlane_web.app.serve_chart","title":"<code>serve_chart(request, session_id, filename, current_session=Cookie(None, alias=SESSION_COOKIE_NAME))</code>  <code>async</code>","text":"<p>Serve chart files from session workspace with security validation.</p> <p>Security checks: 1. Validate session ID format (UUID) 2. Verify session ownership (matches cookie) 3. Ensure workspace exists 4. Validate filename (no path traversal) 5. Check file exists within workspace 6. Validate file extension</p>"},{"location":"api-reference/pitlane-web/config/","title":"Web Configuration API","text":"<p>Auto-generated API documentation for web application configuration.</p>"},{"location":"api-reference/pitlane-web/config/#pitlane_web.config","title":"<code>config</code>","text":"<p>Configuration constants for PitLane AI web application.</p>"},{"location":"api-reference/pitlane-web/session/","title":"Session Management API","text":"<p>Auto-generated API documentation for web session management.</p>"},{"location":"api-reference/pitlane-web/session/#pitlane_web.session","title":"<code>session</code>","text":"<p>Session management functions for PitLane AI web application.</p>"},{"location":"api-reference/pitlane-web/session/#pitlane_web.session.generate_session_id","title":"<code>generate_session_id()</code>","text":"<p>Generate a unique session ID.</p> RETURNS DESCRIPTION <code>str</code> <p>UUID string to use as session identifier.</p> Source code in <code>packages/pitlane-agent/src/pitlane_agent/scripts/workspace.py</code> <pre><code>def generate_session_id() -&gt; str:\n    \"\"\"Generate a unique session ID.\n\n    Returns:\n        UUID string to use as session identifier.\n    \"\"\"\n    return str(uuid.uuid4())\n</code></pre>"},{"location":"api-reference/pitlane-web/session/#pitlane_web.session.validate_session_safely","title":"<code>validate_session_safely(session)</code>","text":"<p>Validate session with constant-time checks to prevent timing attacks.</p> <p>Performs validation checks in a consistent order regardless of where validation fails, making it harder for attackers to probe for valid session IDs.</p> PARAMETER DESCRIPTION <code>session</code> <p>Session ID from cookie (may be None)</p> <p> TYPE: <code>str | None</code> </p> RETURNS DESCRIPTION <code>bool</code> <p>Tuple of (is_valid, session_id)</p> <code>str | None</code> <ul> <li>is_valid: True if session is valid and exists</li> </ul> <code>tuple[bool, str | None]</code> <ul> <li>session_id: The validated session ID if valid, None otherwise</li> </ul> Source code in <code>packages/pitlane-web/src/pitlane_web/session.py</code> <pre><code>def validate_session_safely(session: str | None) -&gt; tuple[bool, str | None]:\n    \"\"\"Validate session with constant-time checks to prevent timing attacks.\n\n    Performs validation checks in a consistent order regardless of where validation\n    fails, making it harder for attackers to probe for valid session IDs.\n\n    Args:\n        session: Session ID from cookie (may be None)\n\n    Returns:\n        Tuple of (is_valid, session_id)\n        - is_valid: True if session is valid and exists\n        - session_id: The validated session ID if valid, None otherwise\n    \"\"\"\n    # Always check format first (constant time for UUID validation)\n    is_valid_format = is_valid_session_id(session) if session else False\n\n    # Always check workspace existence (even if format invalid, to maintain constant timing)\n    # This prevents attackers from using timing to determine if a UUID exists\n    # Use cached version for better performance\n    exists = workspace_exists_cached(session) if is_valid_format else False\n\n    # Return result\n    is_valid = is_valid_format and exists\n    validated_session = session if is_valid else None\n\n    return (is_valid, validated_session)\n</code></pre>"},{"location":"api-reference/pitlane-web/session/#pitlane_web.session.update_workspace_metadata_safe","title":"<code>update_workspace_metadata_safe(session_id)</code>","text":"<p>Safely update workspace metadata with proper error logging.</p> PARAMETER DESCRIPTION <code>session_id</code> <p>Session ID to update</p> <p> TYPE: <code>str</code> </p> Source code in <code>packages/pitlane-web/src/pitlane_web/session.py</code> <pre><code>def update_workspace_metadata_safe(session_id: str) -&gt; None:\n    \"\"\"Safely update workspace metadata with proper error logging.\n\n    Args:\n        session_id: Session ID to update\n    \"\"\"\n    try:\n        update_workspace_metadata(session_id)\n    except FileNotFoundError as e:\n        logger.warning(f\"Workspace metadata file not found for session {session_id}: {e}\")\n    except PermissionError as e:\n        logger.error(f\"Permission denied updating workspace metadata for session {session_id}: {e}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error updating workspace metadata for session {session_id}: {e}\", exc_info=True)\n</code></pre>"},{"location":"architecture/agent-system/","title":"Agent System","text":"<p>PitLane-AI's agent system is built on the Claude Agent SDK, providing an agentic framework for F1 data analysis with tool access, permission controls, and session management.</p>"},{"location":"architecture/agent-system/#architecture-overview","title":"Architecture Overview","text":"<p>The core agent architecture consists of three main components:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502          F1Agent (Main Interface)           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  - Session Management                       \u2502\n\u2502  - Workspace Isolation                      \u2502\n\u2502  - Temporal Context Injection               \u2502\n\u2502  - Tool Permission Enforcement              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                \u2502\n                \u251c\u2500\u2500&gt; ClaudeSDKClient\n                \u2502    (Claude Agent SDK)\n                \u2502\n                \u251c\u2500\u2500&gt; Tool Permission System\n                \u2502    (Bash, Read, Write, WebFetch)\n                \u2502\n                \u251c\u2500\u2500&gt; Skills System\n                \u2502    (f1-analyst, f1-drivers, f1-schedule)\n                \u2502\n                \u2514\u2500\u2500&gt; Workspace Management\n                     (Session isolation, data/charts)\n</code></pre>"},{"location":"architecture/agent-system/#f1agent-class","title":"F1Agent Class","text":"<p>The <code>F1Agent</code> class is the primary interface for interacting with the AI agent.</p>"},{"location":"architecture/agent-system/#initialization","title":"Initialization","text":"<pre><code>from pitlane_agent import F1Agent\n\n# Auto-generated session\nagent = F1Agent()\n\n# Explicit session ID\nagent = F1Agent(session_id=\"my-session-123\")\n\n# With tracing enabled\nagent = F1Agent(enable_tracing=True)\n\n# Without temporal context\nagent = F1Agent(inject_temporal_context=False)\n</code></pre> <p>Parameters:</p> <ul> <li><code>session_id</code> (optional): Session identifier. Auto-generated UUID if not provided.</li> <li><code>workspace_dir</code> (optional): Explicit workspace path. Derived from <code>session_id</code> if None.</li> <li><code>enable_tracing</code> (optional): Enable OpenTelemetry tracing. Uses <code>PITLANE_TRACING_ENABLED</code> env var if None.</li> <li><code>inject_temporal_context</code> (optional): Inject F1 calendar context into system prompt. Default: <code>True</code>.</li> </ul>"},{"location":"architecture/agent-system/#chat-methods","title":"Chat Methods","text":"<p>The agent provides two methods for interaction:</p>"},{"location":"architecture/agent-system/#streaming-response","title":"Streaming Response","text":"<pre><code>async for chunk in agent.chat(\"Who won the Monaco Grand Prix?\"):\n    print(chunk, end=\"\", flush=True)\n</code></pre> <p>Yields text chunks as they're generated, enabling real-time display.</p>"},{"location":"architecture/agent-system/#full-response","title":"Full Response","text":"<pre><code>response = await agent.chat_full(\"Analyze lap times for Hamilton in Bahrain 2024\")\nprint(response)\n</code></pre> <p>Returns the complete response as a single string.</p>"},{"location":"architecture/agent-system/#agent-configuration","title":"Agent Configuration","text":""},{"location":"architecture/agent-system/#system-prompt","title":"System Prompt","text":"<p>The agent uses the <code>claude_code</code> preset system prompt with optional temporal context appended:</p> <pre><code>options = ClaudeAgentOptions(\n    cwd=str(PACKAGE_DIR),\n    setting_sources=[\"project\"],\n    allowed_tools=[\"Skill\", \"Bash\", \"Read\", \"Write\", \"WebFetch\"],\n    can_use_tool=can_use_tool_with_context,\n    system_prompt={\n        \"type\": \"preset\",\n        \"preset\": \"claude_code\",\n        \"append\": temporal_prompt,  # F1 calendar awareness\n    }\n)\n</code></pre>"},{"location":"architecture/agent-system/#allowed-tools","title":"Allowed Tools","text":"<p>The agent has access to five tools:</p> Tool Purpose Restrictions Skill Invoke F1 analysis skills None - delegated to skill permissions Bash Execute shell commands Restricted to <code>pitlane</code> CLI only Read Read files Restricted to workspace directory Write Write files Restricted to workspace directory WebFetch Fetch web content Restricted to F1-related domains <p>See Tool Permissions for detailed restrictions.</p>"},{"location":"architecture/agent-system/#skills-integration","title":"Skills Integration","text":"<p>Skills are discovered and loaded from the <code>.claude/skills/</code> directory:</p> <pre><code>packages/pitlane-agent/src/pitlane_agent/.claude/skills/\n\u251c\u2500\u2500 f1-analyst/\n\u2502   \u251c\u2500\u2500 skill.md           # Skill definition\n\u2502   \u251c\u2500\u2500 lap_times.py       # Lap time analysis\n\u2502   \u2514\u2500\u2500 tyre_strategy.py   # Tyre strategy visualization\n\u251c\u2500\u2500 f1-drivers/\n\u2502   \u2514\u2500\u2500 drivers.py         # Driver information via Ergast API\n\u2514\u2500\u2500 f1-schedule/\n    \u2514\u2500\u2500 schedule.py        # Event calendar queries\n</code></pre> <p>Each skill provides specialized functionality with its own prompt, scripts, and dependencies.</p>"},{"location":"architecture/agent-system/#session-management","title":"Session Management","text":""},{"location":"architecture/agent-system/#workspace-isolation","title":"Workspace Isolation","text":"<p>Each agent session has an isolated workspace:</p> <pre><code>~/.pitlane/workspaces/&lt;session-id&gt;/\n\u251c\u2500\u2500 .metadata.json         # Session metadata\n\u251c\u2500\u2500 data/                  # Session-specific data\n\u2514\u2500\u2500 charts/                # Generated visualizations\n</code></pre> <p>The session ID is passed to skills via the <code>PITLANE_SESSION_ID</code> environment variable, enabling workspace-scoped operations.</p>"},{"location":"architecture/agent-system/#session-lifecycle","title":"Session Lifecycle","text":"<ol> <li>Creation: Workspace created on first agent initialization</li> <li>Access: <code>last_accessed</code> timestamp updated on each agent init</li> <li>Cleanup: Old workspaces cleaned via <code>pitlane workspace clean</code></li> </ol>"},{"location":"architecture/agent-system/#tracing-and-observability","title":"Tracing and Observability","text":"<p>The agent supports OpenTelemetry tracing through hooks:</p> <pre><code>hooks = {\n    \"PreToolUse\": [HookMatcher(matcher=None, hooks=[pre_tool_use_hook])],\n    \"PostToolUse\": [HookMatcher(matcher=None, hooks=[post_tool_use_hook])],\n}\n</code></pre> <p>Enable tracing to observe:</p> <ul> <li>Tool invocations and results</li> <li>Permission checks and denials</li> <li>Skill executions</li> <li>Decision flows</li> </ul> <p>See Agent CLI: Tracing for configuration.</p>"},{"location":"architecture/agent-system/#related-documentation","title":"Related Documentation","text":"<ul> <li>Temporal Context - F1 calendar awareness</li> <li>Skills - Skill system architecture</li> <li>Tool Permissions - Tool restriction system</li> <li>Workspace Management - Session isolation</li> </ul>"},{"location":"architecture/overview/","title":"Architecture Overview","text":"<p>PitLane-AI is built on the Claude Agent SDK, demonstrating practical applications of AI agents in domain-specific analysis. The architecture emphasizes security, observability, and modularity.</p>"},{"location":"architecture/overview/#system-architecture","title":"System Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                      User Interface Layer                       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  - CLI (pitlane-agent)                                          \u2502\n\u2502  - Web Interface (pitlane-web) - FastAPI + Server-Sent Events  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                          \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                       F1Agent (Core)                            \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  - Session Management                                           \u2502\n\u2502  - Workspace Isolation                                          \u2502\n\u2502  - Temporal Context Injection                                   \u2502\n\u2502  - Tool Permission Enforcement                                  \u2502\n\u2502  - OpenTelemetry Tracing                                        \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                          \u2502\n        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n        \u2502                 \u2502                 \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Skills     \u2502  \u2502   Tools    \u2502  \u2502  Data Layer  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524  \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524  \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 f1-analyst   \u2502  \u2502 Bash       \u2502  \u2502 FastF1       \u2502\n\u2502 f1-drivers   \u2502  \u2502 Read       \u2502  \u2502 Ergast API   \u2502\n\u2502 f1-schedule  \u2502  \u2502 Write      \u2502  \u2502 Workspaces   \u2502\n\u2502              \u2502  \u2502 WebFetch   \u2502  \u2502 Cache        \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"architecture/overview/#core-components","title":"Core Components","text":""},{"location":"architecture/overview/#1-f1agent","title":"1. F1Agent","text":"<p>The main agent class that orchestrates all functionality:</p> <ul> <li>Session Management: Unique session IDs with workspace isolation</li> <li>Temporal Context: Real-time F1 calendar awareness</li> <li>Tool Permissions: Restricted tool access for security</li> <li>Tracing: OpenTelemetry observability hooks</li> </ul> <p>Learn more \u2192</p>"},{"location":"architecture/overview/#2-skills-system","title":"2. Skills System","text":"<p>Modular, composable skills for domain-specific analysis:</p> <ul> <li>f1-analyst: Lap times, strategy, telemetry analysis</li> <li>f1-drivers: Driver information via Ergast API</li> <li>f1-schedule: Event calendar and session schedules</li> </ul> <p>Each skill has its own prompt, tool restrictions, and data access patterns.</p> <p>Learn more \u2192</p>"},{"location":"architecture/overview/#3-temporal-context","title":"3. Temporal Context","text":"<p>Real-time awareness of the F1 calendar at multiple granularities:</p> <ul> <li>Season Level: Current year, phase (pre/in/post/off-season)</li> <li>Race Weekend Level: Current/last/next race events</li> <li>Session Level: Live/recent/upcoming sessions</li> </ul> <p>Injected into the agent's system prompt for contextual understanding.</p> <p>Learn more \u2192</p>"},{"location":"architecture/overview/#4-tool-permissions","title":"4. Tool Permissions","text":"<p>Defense-in-depth security through tool restrictions:</p> <ul> <li>Bash: Restricted to <code>pitlane</code> CLI only</li> <li>Read/Write: Restricted to workspace directory</li> <li>WebFetch: Restricted to F1-related domains</li> <li>Skill: No restrictions (delegated to skill permissions)</li> </ul> <p>Learn more \u2192</p>"},{"location":"architecture/overview/#5-workspace-management","title":"5. Workspace Management","text":"<p>Session-based workspaces for data isolation:</p> <pre><code>~/.pitlane/workspaces/&lt;session-id&gt;/\n\u251c\u2500\u2500 .metadata.json\n\u251c\u2500\u2500 data/              # Session data\n\u2514\u2500\u2500 charts/            # Generated visualizations\n</code></pre> <p>Enables concurrent sessions and multi-user deployments.</p> <p>Learn more \u2192</p>"},{"location":"architecture/overview/#data-flow","title":"Data Flow","text":""},{"location":"architecture/overview/#query-execution-flow","title":"Query Execution Flow","text":"<pre><code>1. User Query\n   \u2193\n2. F1Agent.chat()\n   \u2502\n   \u251c\u2500&gt; Inject temporal context into system prompt\n   \u251c\u2500&gt; Initialize ClaudeSDKClient with tools\n   \u2514\u2500&gt; Set can_use_tool permission handler\n   \u2193\n3. Agent Reasoning\n   \u2502\n   \u251c\u2500&gt; Determine relevant skill\n   \u2514\u2500&gt; Invoke Skill tool\n   \u2193\n4. Skill Execution\n   \u2502\n   \u251c\u2500&gt; Parse query intent\n   \u251c\u2500&gt; Execute pitlane CLI command\n   \u2514\u2500&gt; Read workspace data / Generate chart\n   \u2193\n5. Response Streaming\n   \u2502\n   \u2514\u2500&gt; Yield text chunks to user interface\n</code></pre>"},{"location":"architecture/overview/#data-persistence-flow","title":"Data Persistence Flow","text":"<pre><code>1. CLI Command (via Skill)\n   \u2193\n2. FastF1 Data Fetch\n   \u2502\n   \u251c\u2500&gt; Check shared cache (~/.pitlane/cache/fastf1/)\n   \u251c\u2500&gt; Download if missing\n   \u2514\u2500&gt; Cache for future use\n   \u2193\n3. Analysis / Visualization\n   \u2502\n   \u251c\u2500&gt; Process data (lap times, strategy, etc.)\n   \u2514\u2500&gt; Generate matplotlib chart\n   \u2193\n4. Workspace Storage\n   \u2502\n   \u251c\u2500&gt; Save JSON to workspace/data/\n   \u2514\u2500&gt; Save PNG to workspace/charts/\n   \u2193\n5. Agent Response\n   \u2502\n   \u2514\u2500&gt; Reference workspace files in response\n</code></pre>"},{"location":"architecture/overview/#key-design-principles","title":"Key Design Principles","text":""},{"location":"architecture/overview/#1-security-first","title":"1. Security First","text":"<ul> <li>Principle of Least Privilege: Tools have minimal necessary permissions</li> <li>Sandboxing: Skills operate within workspace boundaries</li> <li>Domain Restrictions: Web access limited to known F1 domains</li> <li>Auditable: All permission checks logged and traced</li> </ul>"},{"location":"architecture/overview/#2-observability","title":"2. Observability","text":"<ul> <li>OpenTelemetry Integration: Trace tool calls, permissions, and decisions</li> <li>Structured Logging: Contextual logging with session IDs</li> <li>Inspectable Workspaces: Persistent data for debugging</li> </ul>"},{"location":"architecture/overview/#3-modularity","title":"3. Modularity","text":"<ul> <li>Skills as Modules: Easy to add new analysis capabilities</li> <li>Tool-Based Architecture: Standard Claude SDK tool patterns</li> <li>Workspace Isolation: Clean separation of concerns</li> </ul>"},{"location":"architecture/overview/#4-user-experience","title":"4. User Experience","text":"<ul> <li>Streaming Responses: Real-time feedback via Server-Sent Events</li> <li>Temporal Awareness: Agent understands \"last race\", \"this weekend\"</li> <li>Visualizations: Automatic chart generation for insights</li> </ul>"},{"location":"architecture/overview/#package-structure","title":"Package Structure","text":"<p>PitLane-AI is organized as a monorepo with two main packages:</p> <pre><code>packages/\n\u251c\u2500\u2500 pitlane-agent/          # Core agent library\n\u2502   \u251c\u2500\u2500 src/pitlane_agent/\n\u2502   \u2502   \u251c\u2500\u2500 agent.py        # F1Agent class\n\u2502   \u2502   \u251c\u2500\u2500 temporal/       # Temporal context system\n\u2502   \u2502   \u251c\u2500\u2500 tool_permissions.py\n\u2502   \u2502   \u251c\u2500\u2500 tracing.py      # OpenTelemetry hooks\n\u2502   \u2502   \u251c\u2500\u2500 scripts/        # CLI commands\n\u2502   \u2502   \u2514\u2500\u2500 .claude/skills/ # F1 analysis skills\n\u2502   \u2514\u2500\u2500 tests/\n\u2502\n\u2514\u2500\u2500 pitlane-web/            # Web interface\n    \u251c\u2500\u2500 src/pitlane_web/\n    \u2502   \u251c\u2500\u2500 app.py          # FastAPI application\n    \u2502   \u251c\u2500\u2500 agent_manager.py # Multi-session management\n    \u2502   \u2514\u2500\u2500 templates/      # Jinja2 templates\n    \u2514\u2500\u2500 tests/\n</code></pre>"},{"location":"architecture/overview/#technology-stack","title":"Technology Stack","text":"Layer Technology Agent Framework Claude Agent SDK LLM Claude 3.7 Sonnet F1 Data Layer FastF1 (telemetry, timing, sessions)jolpica-f1/Ergast API (driver info, historical data) Visualization Matplotlib Web Framework FastAPI Streaming Server-Sent Events Tracing OpenTelemetry Package Manager uv (monorepo workspace) Testing pytest, pytest-asyncio"},{"location":"architecture/overview/#f1-data-foundation","title":"F1 Data Foundation","text":"<p>PitLane-AI's analytical capabilities are built on two foundational F1 data APIs:</p> <ul> <li> <p>FastF1 (docs.fastf1.dev) - Provides comprehensive access to F1 telemetry, timing data, session information, and event schedules. All lap time analysis, strategy visualization, and telemetry comparison features use FastF1 as the data source.</p> </li> <li> <p>jolpica-f1 (Ergast API) (github.com/jolpica/jolpica-f1) - Provides historical F1 data including driver rosters, race results, and championship standings from 1950 to present. Accessed via FastF1's <code>ergast</code> module.</p> </li> </ul> <p>These APIs handle all the analytical heavy lifting - PitLane-AI adds an intelligent agent layer on top for natural language queries, visualization generation, and temporal context awareness.</p>"},{"location":"architecture/overview/#deployment-models","title":"Deployment Models","text":""},{"location":"architecture/overview/#1-cli-usage","title":"1. CLI Usage","text":"<p>Single-user, local analysis:</p> <pre><code>pitlane-agent\n# Interactive CLI session\n</code></pre>"},{"location":"architecture/overview/#2-web-interface-development","title":"2. Web Interface (Development)","text":"<p>Local web server with hot-reload:</p> <pre><code>uvx pitlane-web --env development\n# Visit http://localhost:8000\n</code></pre>"},{"location":"architecture/overview/#3-web-interface-production","title":"3. Web Interface (Production)","text":"<p>Coming Soon</p> <p>Production deployment instructions are currently being finalized and will be available in a future release.</p> <p>Supports concurrent sessions via workspace isolation.</p>"},{"location":"architecture/overview/#next-steps","title":"Next Steps","text":"<p>Explore specific architectural components:</p> <ul> <li>Agent System - Core F1Agent implementation</li> <li>Temporal Context - F1 calendar awareness</li> <li>Skills - Skill system and available skills</li> <li>Tool Permissions - Security model</li> <li>Workspace Management - Session isolation</li> </ul> <p>Or jump to usage documentation:</p> <ul> <li>User Guide: Web Interface - Using PitLane-AI</li> <li>Agent CLI - CLI reference (for agents/developers)</li> <li>Developer Guide - Contributing and extending</li> </ul>"},{"location":"architecture/skills/","title":"Skills","text":"<p>Skills provide specialized capabilities to the F1 agent, enabling domain-specific analysis through structured prompts and Python scripts. Each skill is a self-contained module with its own prompt, tools, and data access patterns.</p>"},{"location":"architecture/skills/#overview","title":"Overview","text":"<p>PitLane-AI uses the Claude Agent SDK skills system to organize functionality into focused, composable modules. When the agent receives a question about F1 data, it:</p> <ol> <li>Identifies the relevant skill based on the query</li> <li>Invokes the skill using the <code>Skill</code> tool</li> <li>The skill executes with its own prompt and tool restrictions</li> <li>Results are returned to the main agent conversation</li> </ol>"},{"location":"architecture/skills/#skill-structure","title":"Skill Structure","text":"<p>Skills live in the <code>.claude/skills/</code> directory:</p> <pre><code>packages/pitlane-agent/src/pitlane_agent/.claude/skills/\n\u251c\u2500\u2500 f1-analyst/\n\u2502   \u251c\u2500\u2500 SKILL.md           # Skill definition and prompt\n\u2502   \u2514\u2500\u2500 references/        # Sub-skill documentation\n\u2502       \u251c\u2500\u2500 lap_times.md   # Lap time analysis guide\n\u2502       \u251c\u2500\u2500 strategy.md    # Strategy analysis guide\n\u2502       \u2514\u2500\u2500 telemetry.md   # Telemetry analysis guide\n\u251c\u2500\u2500 f1-drivers/\n\u2502   \u2514\u2500\u2500 SKILL.md           # Driver information skill\n\u2514\u2500\u2500 f1-schedule/\n    \u2514\u2500\u2500 SKILL.md           # Schedule queries skill\n</code></pre>"},{"location":"architecture/skills/#skill-definition-format","title":"Skill Definition Format","text":"<p>Skills are defined using frontmatter in <code>SKILL.md</code>:</p> <pre><code>---\nname: f1-analyst\ndescription: Answer questions about F1 races, drivers, qualifying, and practice sessions.\nallowed-tools: Bash(pitlane *), Read, Write\n---\n\n# F1 Data Analyst\n\nYou are an F1 data analyst with access to historical race data via FastF1...\n\n[Skill prompt continues...]\n</code></pre> <p>Frontmatter Fields:</p> <ul> <li><code>name</code>: Skill identifier (used for invocation)</li> <li><code>description</code>: When to use this skill (shown to main agent)</li> <li><code>allowed-tools</code>: Tools available within the skill context</li> </ul>"},{"location":"architecture/skills/#available-skills","title":"Available Skills","text":""},{"location":"architecture/skills/#f1-analyst","title":"f1-analyst","text":"<p>Purpose: Data analysis and visualization using FastF1</p> <p>When to Use: Questions about lap times, race results, strategy, telemetry</p> <p>Capabilities: - Lap time analysis and distributions - Tyre strategy visualization - Telemetry comparison (speed, throttle, brake) - Session data queries</p> <p>Tool Access: - <code>Bash</code>: Restricted to <code>pitlane</code> CLI commands only - <code>Read</code>: Restricted to workspace directory - <code>Write</code>: Restricted to workspace directory</p> <p>Example Invocation: <pre><code>User: \"Compare Verstappen and Hamilton lap times in Monaco 2024\"\nAgent: [Invokes f1-analyst skill]\nSkill: [Executes pitlane CLI commands, generates visualization]\n</code></pre></p>"},{"location":"architecture/skills/#f1-drivers","title":"f1-drivers","text":"<p>Purpose: Driver information queries via Ergast API</p> <p>When to Use: Questions about driver details, codes, nationalities</p> <p>Capabilities: - Driver roster by season - Driver codes and Wikipedia links - Nationality and career data</p> <p>Tool Access: - <code>Bash</code>: Restricted to <code>pitlane</code> CLI commands - <code>Read</code>: Restricted to workspace directory</p> <p>Example Invocation: <pre><code>User: \"Who drove for Ferrari in 2019?\"\nAgent: [Invokes f1-drivers skill]\nSkill: [Queries Ergast API, returns driver list]\n</code></pre></p>"},{"location":"architecture/skills/#f1-schedule","title":"f1-schedule","text":"<p>Purpose: Event calendar and session timing queries</p> <p>When to Use: Questions about race dates, locations, session schedules</p> <p>Capabilities: - Season calendar with dates and locations - Session timing (FP1, FP2, FP3, Q, R) - Round numbers and event names</p> <p>Tool Access: - <code>Bash</code>: Restricted to <code>pitlane</code> CLI commands - <code>Read</code>: Restricted to workspace directory</p> <p>Example Invocation: <pre><code>User: \"When is the next race?\"\nAgent: [Invokes f1-schedule skill]\nSkill: [Queries schedule, returns next event details]\n</code></pre></p>"},{"location":"architecture/skills/#skill-invocation","title":"Skill Invocation","text":"<p>Skills are invoked using the <code>Skill</code> tool:</p> <pre><code># Agent SDK handles skill discovery and execution\nclient.invoke_tool(\"Skill\", {\"skill\": \"f1-analyst\"})\n</code></pre> <p>The agent automatically: 1. Loads the skill prompt from <code>SKILL.md</code> 2. Applies tool restrictions from <code>allowed-tools</code> 3. Passes the user query to the skill context 4. Returns skill results to main conversation</p>"},{"location":"architecture/skills/#workspace-integration","title":"Workspace Integration","text":"<p>Skills use the session workspace for data isolation:</p> <p>Session ID: Passed via <code>PITLANE_SESSION_ID</code> environment variable</p> <p>Workspace Structure: <pre><code>~/.pitlane/workspaces/&lt;session-id&gt;/\n\u251c\u2500\u2500 data/              # Session data (JSON)\n\u2502   \u251c\u2500\u2500 session_info.json\n\u2502   \u251c\u2500\u2500 drivers.json\n\u2502   \u2514\u2500\u2500 schedule.json\n\u2514\u2500\u2500 charts/            # Generated visualizations (PNG)\n    \u251c\u2500\u2500 lap_times.png\n    \u2514\u2500\u2500 strategy.png\n</code></pre></p> <p>Skills read/write data using the workspace path:</p> <pre><code># Skills fetch data to workspace\npitlane fetch session-info --session-id $PITLANE_SESSION_ID --year 2024 --gp Monaco --session R\n\n# Skills generate charts to workspace\npitlane analyze lap-times --session-id $PITLANE_SESSION_ID --drivers VER HAM\n</code></pre>"},{"location":"architecture/skills/#tool-permissions-in-skills","title":"Tool Permissions in Skills","text":"<p>Skills have more restricted tool access than the main agent:</p> Tool Main Agent Skills Skill \u2713 Allowed \u2717 Not allowed (no nested skills) Bash Restricted to <code>pitlane</code> CLI Restricted to <code>pitlane</code> CLI Read Workspace only Workspace only Write Workspace only Workspace only WebFetch F1 domains only \u2717 Not allowed (unless specified) <p>This ensures skills operate within safe boundaries and can't escalate permissions.</p>"},{"location":"architecture/skills/#sub-skills-pattern","title":"Sub-Skills Pattern","text":"<p>Complex skills like <code>f1-analyst</code> use sub-skills for organization:</p> <pre><code>f1-analyst/\n\u251c\u2500\u2500 SKILL.md                  # Main skill prompt\n\u2514\u2500\u2500 references/\n    \u251c\u2500\u2500 lap_times.md          # Lap time analysis sub-skill\n    \u251c\u2500\u2500 strategy.md           # Strategy analysis sub-skill\n    \u251c\u2500\u2500 telemetry.md          # Telemetry analysis sub-skill\n    \u2514\u2500\u2500 standings.md          # Standings analysis sub-skill\n</code></pre> <p>The main skill prompt routes to sub-skills based on query type:</p> <pre><code>## Analysis Types\n\nBased on the user's question, read the appropriate reference file:\n\n### Lap Time Analysis\n**When to use:** Questions about lap times, pace comparison...\n**Read:** [references/lap_times.md](references/lap_times.md)\n\n### Strategy Analysis\n**When to use:** Questions about tyre strategy, pit stops...\n**Read:** [references/strategy.md](references/strategy.md)\n</code></pre> <p>This enables: - Modular skill development - Focused prompts per analysis type - Easier testing and maintenance</p>"},{"location":"architecture/skills/#security-model","title":"Security Model","text":"<p>Skills are sandboxed through tool restrictions:</p> <ol> <li>Bash Access: Limited to <code>pitlane</code> CLI only (no arbitrary commands)</li> <li>File Access: Limited to workspace directory (no system files)</li> <li>Network Access: Limited to F1 domains (Ergast, Wikipedia, F1.com)</li> <li>No Escalation: Skills cannot invoke other skills</li> </ol> <p>This ensures: - Data isolation between sessions - No access to sensitive system resources - Predictable, auditable behavior</p>"},{"location":"architecture/skills/#adding-new-skills","title":"Adding New Skills","text":"<p>See Developer Guide: Adding Skills for creating custom skills.</p>"},{"location":"architecture/skills/#related-documentation","title":"Related Documentation","text":"<ul> <li>Agent System - How skills integrate with F1Agent</li> <li>Tool Permissions - Tool restriction details</li> <li>Workspace Management - Session isolation</li> <li>Agent CLI: Using Skills - How agent skills work</li> </ul>"},{"location":"architecture/temporal-context/","title":"Temporal Context","text":"<p>The temporal context system provides real-time awareness of the F1 calendar, enabling the agent to understand \"where we are\" in the racing season at multiple granularities.</p>"},{"location":"architecture/temporal-context/#overview","title":"Overview","text":"<p>When analyzing F1 data, context matters. A question about \"the last race\" means different things in March (pre-season) vs. July (mid-season) vs. December (off-season). The temporal context system makes the agent season-aware, automatically injecting relevant calendar information into the system prompt.</p>"},{"location":"architecture/temporal-context/#architecture","title":"Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   TemporalContextManager                \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  - Intelligent Caching (TTL-based)      \u2502\n\u2502  - FastF1 Schedule Integration          \u2502\n\u2502  - Session-Level Granularity            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n             \u2502\n             \u251c\u2500\u2500&gt; TemporalCache\n             \u2502    (Disk-based, adaptive TTL)\n             \u2502\n             \u251c\u2500\u2500&gt; TemporalAnalyzer\n             \u2502    (Calendar analysis logic)\n             \u2502\n             \u2514\u2500\u2500&gt; TemporalFormatter\n                  (System prompt formatting)\n</code></pre>"},{"location":"architecture/temporal-context/#context-levels","title":"Context Levels","text":"<p>The system provides temporal awareness at three levels:</p>"},{"location":"architecture/temporal-context/#1-season-level","title":"1. Season Level","text":"<p>Tracks the overall championship phase:</p> <ul> <li>Pre-Season (Jan-Feb): Before first race</li> <li>In-Season (Mar-Nov): During championship</li> <li>Post-Season (Nov-Dec): After final race</li> <li>Off-Season (Dec-Feb): Winter break</li> </ul>"},{"location":"architecture/temporal-context/#2-race-weekend-level","title":"2. Race Weekend Level","text":"<p>Tracks the current, last, and next race weekends:</p> <ul> <li>Current Weekend: Active race weekend (if within event window)</li> <li>Last Completed: Most recently finished race</li> <li>Next Race: Upcoming race with countdown</li> </ul>"},{"location":"architecture/temporal-context/#3-session-level","title":"3. Session Level","text":"<p>Tracks individual sessions with real-time status:</p> <ul> <li>Live Sessions: Currently happening (with live indicator)</li> <li>Recent Sessions: Completed within last 24 hours</li> <li>Upcoming Sessions: Future sessions with countdown</li> </ul>"},{"location":"architecture/temporal-context/#data-structures","title":"Data Structures","text":""},{"location":"architecture/temporal-context/#temporalcontext","title":"TemporalContext","text":"<p>The root context object:</p> <pre><code>@dataclass\nclass TemporalContext:\n    current_time_utc: datetime\n    current_season: int\n    season_phase: F1Season  # pre_season, in_season, post_season, off_season\n\n    # Race weekend context\n    current_weekend: RaceWeekendContext | None\n    last_completed_race: RaceWeekendContext | None\n    next_race: RaceWeekendContext | None\n\n    # Quick stats\n    races_completed: int\n    races_remaining: int\n    days_until_next_race: int | None\n\n    # Cache metadata\n    cache_timestamp: datetime\n    ttl_seconds: int\n</code></pre>"},{"location":"architecture/temporal-context/#raceweekendcontext","title":"RaceWeekendContext","text":"<p>Details about a specific race weekend:</p> <pre><code>@dataclass\nclass RaceWeekendContext:\n    round_number: int\n    event_name: str           # \"Monaco Grand Prix\"\n    country: str\n    location: str\n    event_date: datetime\n    phase: RaceWeekendPhase   # practice, qualifying, race, etc.\n\n    # Session tracking\n    current_session: SessionContext | None\n    next_session: SessionContext | None\n    all_sessions: list[SessionContext]\n    is_sprint_weekend: bool\n</code></pre>"},{"location":"architecture/temporal-context/#sessioncontext","title":"SessionContext","text":"<p>Details about an individual session:</p> <pre><code>@dataclass\nclass SessionContext:\n    name: str                 # \"Race\", \"Qualifying\", \"FP1\"\n    session_type: str         # \"R\", \"Q\", \"FP1\", etc.\n    date_utc: datetime\n    date_local: datetime\n\n    # Real-time status\n    is_live: bool             # Currently happening\n    is_recent: bool           # Within last 24h\n    minutes_until: int | None # Countdown to start (None if past)\n    minutes_since: int | None # Time since end (None if future)\n</code></pre>"},{"location":"architecture/temporal-context/#caching-strategy","title":"Caching Strategy","text":"<p>The temporal context uses intelligent adaptive caching to minimize API calls while maintaining accuracy:</p>"},{"location":"architecture/temporal-context/#cache-ttl-time-to-live","title":"Cache TTL (Time-To-Live)","text":"<p>The cache TTL adapts based on how far we are from the next event:</p> Time Until Next Session TTL &lt; 1 hour 5 minutes &lt; 24 hours 30 minutes &lt; 7 days 6 hours \u2265 7 days 24 hours <p>Rationale: During race weekends, context changes rapidly (sessions start/end). During off-weeks, context is stable.</p>"},{"location":"architecture/temporal-context/#cache-location","title":"Cache Location","text":"<p>Context is cached at:</p> <pre><code>~/.pitlane/cache/temporal/\n\u2514\u2500\u2500 temporal_context.json\n</code></pre> <p>Cache includes: - Full temporal context JSON - Cache timestamp - TTL seconds (for validation)</p>"},{"location":"architecture/temporal-context/#system-prompt-injection","title":"System Prompt Injection","text":"<p>The temporal context is formatted and injected into the agent's system prompt:</p> <pre><code>temporal_ctx = get_temporal_context()\ntemporal_prompt = format_for_system_prompt(temporal_ctx, verbosity=\"normal\")\n\nsystem_prompt = {\n    \"type\": \"preset\",\n    \"preset\": \"claude_code\",\n    \"append\": temporal_prompt,\n}\n</code></pre>"},{"location":"architecture/temporal-context/#verbosity-levels","title":"Verbosity Levels","text":"<p>The formatter supports three verbosity levels:</p> Level Description Use Case <code>minimal</code> Season phase and next race only Token-constrained environments <code>normal</code> Full context with current/last/next races Standard agent usage (default) <code>detailed</code> Includes all session details Debugging and development"},{"location":"architecture/temporal-context/#example-formatted-prompt","title":"Example Formatted Prompt","text":"<pre><code># F1 Temporal Context (2024-05-23 14:30 UTC)\n\n**Season Status**: 2024 Season - In Progress\n- Races completed: 7/24\n- Races remaining: 17\n\n**Current Race Weekend**: Monaco Grand Prix (Round 8)\n- Location: Monaco, Monaco\n- Event Date: 2024-05-26\n- Phase: Practice\n- Current Session: FP1 (Live - Started 15 minutes ago)\n- Next Session: FP2 (in 2 hours 15 minutes)\n\n**Last Completed Race**: Emilia Romagna Grand Prix (Round 7)\n- Location: Imola, Italy\n- Completed: 3 days ago\n\n**Next Race**: Monaco Grand Prix (in 3 days)\n</code></pre> <p>This context enables the agent to: - Understand temporal references (\"last race\", \"this weekend\") - Provide relevant suggestions (\"FP1 just started - want to analyze lap times?\") - Avoid confusion about historical vs. current data</p>"},{"location":"architecture/temporal-context/#usage","title":"Usage","text":""},{"location":"architecture/temporal-context/#get-current-context","title":"Get Current Context","text":"<pre><code>from pitlane_agent.temporal import get_temporal_context\n\ncontext = get_temporal_context()\n\nprint(f\"Season: {context.current_season}\")\nprint(f\"Phase: {context.season_phase}\")\nprint(f\"Next race: {context.next_race.event_name}\")\n</code></pre>"},{"location":"architecture/temporal-context/#force-cache-refresh","title":"Force Cache Refresh","text":"<pre><code>from pitlane_agent.temporal import TemporalContextManager\n\nmanager = TemporalContextManager()\ncontext = manager.get_context(force_refresh=True)\n</code></pre>"},{"location":"architecture/temporal-context/#format-for-prompt","title":"Format for Prompt","text":"<pre><code>from pitlane_agent.temporal import format_for_system_prompt\n\n# Normal verbosity (default)\nprompt = format_for_system_prompt(context)\n\n# Minimal (token-efficient)\nprompt = format_for_system_prompt(context, verbosity=\"minimal\")\n\n# Detailed (debugging)\nprompt = format_for_system_prompt(context, verbosity=\"detailed\")\n</code></pre>"},{"location":"architecture/temporal-context/#benefits","title":"Benefits","text":""},{"location":"architecture/temporal-context/#1-contextual-understanding","title":"1. Contextual Understanding","text":"<p>The agent knows temporal references without asking:</p> <ul> <li>\"Analyze the last race\" \u2192 Automatically knows which race</li> <li>\"What's happening this weekend?\" \u2192 Knows current event and sessions</li> <li>\"When's the next race?\" \u2192 Instant countdown</li> </ul>"},{"location":"architecture/temporal-context/#2-reduced-token-usage","title":"2. Reduced Token Usage","text":"<p>Without temporal context, the agent would need to: 1. Fetch the schedule 2. Determine current race 3. Parse session times 4. Calculate countdowns</p> <p>With temporal context, all this is pre-computed and cached.</p>"},{"location":"architecture/temporal-context/#3-real-time-awareness","title":"3. Real-Time Awareness","text":"<p>During race weekends, the agent knows: - If qualifying is live right now - When the next session starts - How long ago a session ended</p> <p>This enables intelligent suggestions and relevant analysis prompts.</p>"},{"location":"architecture/temporal-context/#related-documentation","title":"Related Documentation","text":"<ul> <li>Agent System - How temporal context integrates with F1Agent</li> <li>API Reference: Temporal - Full API documentation</li> </ul>"},{"location":"architecture/tool-permissions/","title":"Tool Permissions","text":"<p>PitLane-AI implements a comprehensive tool permission system to ensure the agent operates within safe, predictable boundaries. The system restricts tool access based on domain, file paths, and command patterns.</p>"},{"location":"architecture/tool-permissions/#overview","title":"Overview","text":"<p>Tool permissions provide defense-in-depth security through:</p> <ol> <li>Tool Allowlist: Only specific tools are available</li> <li>Domain Restrictions: Web access limited to F1-related domains</li> <li>Path Restrictions: File access limited to workspace directories</li> <li>Command Restrictions: Shell access limited to PitLane CLI</li> </ol> <p>This ensures the agent can't access sensitive data, execute arbitrary code, or make unauthorized network requests.</p>"},{"location":"architecture/tool-permissions/#permission-architecture","title":"Permission Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502      F1Agent.chat()                  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n               \u2502\n               \u251c\u2500\u2500&gt; ClaudeSDKClient\n               \u2502    (allowed_tools, can_use_tool)\n               \u2502\n               \u2514\u2500\u2500&gt; can_use_tool_with_context()\n                    \u2502\n                    \u251c\u2500\u2500&gt; Workspace Context Injection\n                    \u2514\u2500\u2500&gt; tool_permissions.can_use_tool()\n                         \u2502\n                         \u251c\u2500\u2500&gt; Bash: pitlane CLI only\n                         \u251c\u2500\u2500&gt; Read: workspace paths only\n                         \u251c\u2500\u2500&gt; Write: workspace paths only\n                         \u2514\u2500\u2500&gt; WebFetch: F1 domains only\n</code></pre>"},{"location":"architecture/tool-permissions/#allowed-tools","title":"Allowed Tools","text":"<p>The agent has access to five tools only:</p> <pre><code>allowed_tools=[\"Skill\", \"Bash\", \"Read\", \"Write\", \"WebFetch\"]\n</code></pre> <p>Any attempt to use other tools (Edit, Grep, Task, etc.) is blocked at the SDK level.</p>"},{"location":"architecture/tool-permissions/#tool-restrictions","title":"Tool Restrictions","text":""},{"location":"architecture/tool-permissions/#bash-pitlane-cli-only","title":"Bash: PitLane CLI Only","text":"<p>Rule: Only <code>pitlane</code> CLI commands are permitted.</p> <p>Validation: 1. Extract command (skip environment variables) 2. Check command starts with <code>pitlane</code> 3. Validate only allowed environment variables are used</p> <p>Allowed Environment Variables: - <code>PITLANE_SESSION_ID</code> - <code>PITLANE_CACHE_DIR</code> - <code>PITLANE_TRACING_ENABLED</code> - <code>PITLANE_SPAN_PROCESSOR</code></p> <p>Permitted Commands: <pre><code>\u2713 pitlane fetch session-info --year 2024 --gp Monaco\n\u2713 PITLANE_SESSION_ID=abc123 pitlane analyze lap-times\n\u2713 pitlane workspace list\n</code></pre></p> <p>Blocked Commands: <pre><code>\u2717 ls -la\n\u2717 cat /etc/passwd\n\u2717 python script.py\n\u2717 curl https://example.com\n\u2717 CUSTOM_VAR=foo pitlane fetch ...\n</code></pre></p> <p>Error Message: <pre><code>Bash is restricted to 'pitlane' CLI commands only.\nUse 'pitlane &lt;subcommand&gt;' to execute F1 data operations.\n</code></pre></p>"},{"location":"architecture/tool-permissions/#read-workspace-only","title":"Read: Workspace Only","text":"<p>Rule: File reads are restricted to the workspace directory.</p> <p>Validation: 1. Resolve file path to absolute path 2. Resolve workspace directory to absolute path 3. Check if file path starts with workspace path</p> <p>Permitted Reads: <pre><code>\u2713 Read(file_path=\"~/.pitlane/workspaces/&lt;session-id&gt;/data/session_info.json\")\n\u2713 Read(file_path=\"~/.pitlane/workspaces/&lt;session-id&gt;/charts/lap_times.png\")\n</code></pre></p> <p>Blocked Reads: <pre><code>\u2717 Read(file_path=\"/etc/passwd\")\n\u2717 Read(file_path=\"~/.ssh/id_rsa\")\n\u2717 Read(file_path=\"/Users/alice/Documents/secrets.txt\")\n</code></pre></p> <p>Error Message: <pre><code>Read access denied. File must be within workspace directory:\n~/.pitlane/workspaces/&lt;session-id&gt;\n</code></pre></p>"},{"location":"architecture/tool-permissions/#write-workspace-only","title":"Write: Workspace Only","text":"<p>Rule: File writes are restricted to the workspace directory.</p> <p>Validation: Same as Read (path must be within workspace).</p> <p>Permitted Writes: <pre><code>\u2713 Write(file_path=\"~/.pitlane/workspaces/&lt;session-id&gt;/data/results.json\")\n\u2713 Write(file_path=\"~/.pitlane/workspaces/&lt;session-id&gt;/charts/strategy.png\")\n</code></pre></p> <p>Blocked Writes: <pre><code>\u2717 Write(file_path=\"/tmp/malicious.sh\")\n\u2717 Write(file_path=\"~/Documents/data.txt\")\n\u2717 Write(file_path=\"/var/log/app.log\")\n</code></pre></p> <p>Error Message: <pre><code>Write access denied. File must be within workspace directory:\n~/.pitlane/workspaces/&lt;session-id&gt;\n</code></pre></p>"},{"location":"architecture/tool-permissions/#webfetch-f1-domains-only","title":"WebFetch: F1 Domains Only","text":"<p>Rule: Web requests are restricted to F1-related domains.</p> <p>Allowed Domains: - <code>wikipedia.org</code> (and <code>en.wikipedia.org</code>) - <code>ergast.com</code> (and <code>api.ergast.com</code>) - <code>formula1.com</code> (and <code>www.formula1.com</code>)</p> <p>Validation: 1. Parse URL to extract domain 2. Remove <code>www.</code> prefix for comparison 3. Check exact match or subdomain match 4. Allow subdomains (e.g., <code>fr.wikipedia.org</code>)</p> <p>Permitted Requests: <pre><code>\u2713 WebFetch(url=\"https://en.wikipedia.org/wiki/Lewis_Hamilton\")\n\u2713 WebFetch(url=\"https://api.ergast.com/api/f1/2024/drivers.json\")\n\u2713 WebFetch(url=\"https://www.formula1.com/en/results.html\")\n\u2713 WebFetch(url=\"https://fr.wikipedia.org/wiki/Monaco\")\n</code></pre></p> <p>Blocked Requests: <pre><code>\u2717 WebFetch(url=\"https://example.com/data\")\n\u2717 WebFetch(url=\"https://github.com/user/repo\")\n\u2717 WebFetch(url=\"https://api.openweathermap.org/data\")\n</code></pre></p> <p>Error Message: <pre><code>Domain 'example.com' is not in the allowed list.\nAllowed domains: ergast.com, formula1.com, wikipedia.org\n</code></pre></p>"},{"location":"architecture/tool-permissions/#permission-context","title":"Permission Context","text":"<p>Permissions are evaluated with workspace context:</p> <pre><code>async def can_use_tool_with_context(tool_name, input_params, context):\n    # Inject workspace context\n    context_with_workspace = {\n        **context,\n        \"workspace_dir\": workspace_dir,\n        \"session_id\": session_id,\n    }\n    return await can_use_tool(tool_name, input_params, context_with_workspace)\n</code></pre> <p>This enables: - Read/Write restrictions based on session workspace - Audit logs with session context - Tracing permission checks</p>"},{"location":"architecture/tool-permissions/#permission-flow","title":"Permission Flow","text":"<p>When a tool is invoked:</p> <pre><code>1. Agent calls tool (e.g., Read)\n   \u2502\n   \u251c\u2500\u2500&gt; SDK invokes can_use_tool_with_context()\n   \u2502    \u2502\n   \u2502    \u251c\u2500\u2500&gt; Inject workspace_dir and session_id\n   \u2502    \u2514\u2500\u2500&gt; Call tool_permissions.can_use_tool()\n   \u2502         \u2502\n   \u2502         \u251c\u2500\u2500&gt; Validate tool parameters\n   \u2502         \u2502\n   \u2502         \u251c\u2500\u2500&gt; If allowed:\n   \u2502         \u2502    \u2514\u2500\u2500&gt; Return PermissionResultAllow()\n   \u2502         \u2502\n   \u2502         \u2514\u2500\u2500&gt; If denied:\n   \u2502              \u251c\u2500\u2500&gt; Log denial (with context)\n   \u2502              \u251c\u2500\u2500&gt; Log tracing span (if enabled)\n   \u2502              \u2514\u2500\u2500&gt; Return PermissionResultDeny(message)\n   \u2502\n   \u251c\u2500\u2500&gt; If allowed: Tool executes\n   \u2514\u2500\u2500&gt; If denied: Error returned to agent\n</code></pre>"},{"location":"architecture/tool-permissions/#tracing-permission-checks","title":"Tracing Permission Checks","text":"<p>Permission checks are logged via OpenTelemetry spans (when tracing enabled):</p> <pre><code>tracing.log_permission_check(tool_name, allowed=False, reason=denial_msg)\n</code></pre> <p>Trace output example:</p> <pre><code>[PERMISSION] Bash: DENIED\n  Reason: Bash is restricted to 'pitlane' CLI commands only\n  Command: cat /etc/passwd\n\n[PERMISSION] Read: ALLOWED\n  File: ~/.pitlane/workspaces/abc123/data/session_info.json\n\n[PERMISSION] WebFetch: DENIED\n  Domain: github.com\n  Reason: Domain not in allowed list\n</code></pre>"},{"location":"architecture/tool-permissions/#implementation","title":"Implementation","text":"<p>See <code>tool_permissions.py</code> for the full implementation:</p> <pre><code>async def can_use_tool(\n    tool_name: str,\n    input_params: dict[str, Any],\n    context: ToolPermissionContext | dict[str, Any],\n) -&gt; PermissionResultAllow | PermissionResultDeny:\n    \"\"\"Validate tool usage with restrictions.\"\"\"\n\n    # Bash: pitlane CLI only\n    if tool_name == \"Bash\":\n        command = input_params.get(\"command\", \"\")\n        if not _is_allowed_bash_command(command):\n            return PermissionResultDeny(message=\"...\")\n        return PermissionResultAllow()\n\n    # Read: workspace only\n    if tool_name == \"Read\":\n        file_path = input_params.get(\"file_path\", \"\")\n        workspace_dir = context.get(\"workspace_dir\")\n        if not _is_within_workspace(file_path, workspace_dir):\n            return PermissionResultDeny(message=\"...\")\n        return PermissionResultAllow()\n\n    # Write: workspace only\n    if tool_name == \"Write\":\n        # Same as Read\n\n    # WebFetch: F1 domains only\n    if tool_name == \"WebFetch\":\n        url = input_params.get(\"url\", \"\")\n        domain = urlparse(url).netloc\n        if domain not in ALLOWED_WEBFETCH_DOMAINS:\n            return PermissionResultDeny(message=\"...\")\n        return PermissionResultAllow()\n\n    # Allow all other tools (Skill)\n    return PermissionResultAllow()\n</code></pre>"},{"location":"architecture/tool-permissions/#benefits","title":"Benefits","text":""},{"location":"architecture/tool-permissions/#1-defense-in-depth","title":"1. Defense in Depth","text":"<p>Multiple layers of security: - Tool allowlist (5 tools only) - Per-tool restrictions (domain, path, command) - Workspace isolation (session-scoped)</p>"},{"location":"architecture/tool-permissions/#2-auditable","title":"2. Auditable","text":"<p>All permission checks are: - Logged with structured data - Traced via OpenTelemetry - Reviewable in logs</p>"},{"location":"architecture/tool-permissions/#3-predictable","title":"3. Predictable","text":"<p>Agent behavior is constrained to: - F1 data operations only - Session-scoped file access - Known, safe domains</p>"},{"location":"architecture/tool-permissions/#4-user-friendly","title":"4. User-Friendly","text":"<p>Error messages are clear and actionable: - Explain why permission was denied - Suggest correct usage - Don't expose internal details</p>"},{"location":"architecture/tool-permissions/#related-documentation","title":"Related Documentation","text":"<ul> <li>Agent System - How permissions integrate with F1Agent</li> <li>Skills - Skill-specific tool restrictions</li> <li>Workspace Management - Session isolation</li> <li>Agent CLI: Tracing - Observing permission checks</li> </ul>"},{"location":"architecture/workspace-management/","title":"Workspace Management","text":"<p>PitLane-AI uses session-based workspaces to isolate agent data, ensuring clean separation between conversations and enabling concurrent multi-user deployments.</p>"},{"location":"architecture/workspace-management/#overview","title":"Overview","text":"<p>Each F1Agent session operates in its own workspace directory, providing:</p> <ul> <li>Data Isolation: Session data never conflicts or mixes</li> <li>Concurrent Access: Multiple agents can run simultaneously</li> <li>Resource Management: Old workspaces can be cleaned up</li> <li>Reproducibility: Session data persists for debugging</li> </ul>"},{"location":"architecture/workspace-management/#workspace-structure","title":"Workspace Structure","text":""},{"location":"architecture/workspace-management/#directory-layout","title":"Directory Layout","text":"<pre><code>~/.pitlane/\n\u251c\u2500\u2500 workspaces/\n\u2502   \u251c\u2500\u2500 &lt;session-id-1&gt;/\n\u2502   \u2502   \u251c\u2500\u2500 .metadata.json\n\u2502   \u2502   \u251c\u2500\u2500 data/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 session_info.json\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 drivers.json\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 schedule.json\n\u2502   \u2502   \u2514\u2500\u2500 charts/\n\u2502   \u2502       \u251c\u2500\u2500 lap_times.png\n\u2502   \u2502       \u2514\u2500\u2500 strategy.png\n\u2502   \u2514\u2500\u2500 &lt;session-id-2&gt;/\n\u2502       \u2514\u2500\u2500 ...\n\u2514\u2500\u2500 cache/\n    \u251c\u2500\u2500 fastf1/              # Shared FastF1 cache\n    \u2514\u2500\u2500 temporal/            # Temporal context cache\n</code></pre>"},{"location":"architecture/workspace-management/#workspace-components","title":"Workspace Components","text":"<p><code>.metadata.json</code>: Session metadata <pre><code>{\n  \"session_id\": \"abc123-def456-...\",\n  \"created_at\": \"2024-05-23T14:30:00Z\",\n  \"last_accessed\": \"2024-05-23T15:45:00Z\",\n  \"description\": \"Monaco 2024 analysis\"  // optional\n}\n</code></pre></p> <p><code>data/</code>: Session-specific data files - JSON outputs from CLI commands - Query results (drivers, schedules, session info) - Intermediate analysis data</p> <p><code>charts/</code>: Generated visualizations - PNG images from matplotlib - Lap time distributions - Strategy visualizations - Telemetry plots</p>"},{"location":"architecture/workspace-management/#session-lifecycle","title":"Session Lifecycle","text":""},{"location":"architecture/workspace-management/#1-creation","title":"1. Creation","text":"<p>Workspaces are created automatically when F1Agent is initialized:</p> <pre><code>agent = F1Agent()  # Auto-generates session ID and creates workspace\n</code></pre> <p>Or with explicit session ID:</p> <pre><code>agent = F1Agent(session_id=\"my-session-123\")\n</code></pre> <p>Creation Process: 1. Generate UUID session ID (if not provided) 2. Check for collision (retry up to 3 times for auto-generated IDs) 3. Create directory structure (<code>workspace/</code>, <code>data/</code>, <code>charts/</code>) 4. Write <code>.metadata.json</code> with timestamp 5. Ensure shared cache directories exist</p> <p>Collision Handling: Auto-generated UUIDs handle collisions gracefully: <pre><code>create_workspace(session_id=None, max_retries=3)\n# Retries UUID generation if workspace already exists\n</code></pre></p> <p>Explicit session IDs fail immediately if workspace exists: <pre><code>create_workspace(session_id=\"explicit-id\")\n# Raises ValueError if workspace exists\n</code></pre></p>"},{"location":"architecture/workspace-management/#2-access","title":"2. Access","text":"<p>On each agent initialization: - <code>last_accessed</code> timestamp updated in <code>.metadata.json</code> - Atomic write using tempfile + rename (POSIX guarantee) - Missing metadata recreated if needed</p>"},{"location":"architecture/workspace-management/#3-cleanup","title":"3. Cleanup","text":"<p>Old workspaces can be removed:</p> <pre><code># Remove workspaces older than 7 days\npitlane workspace clean --older-than-days 7\n\n# Remove all workspaces\npitlane workspace clean --all\n</code></pre> <p>Cleanup Logic: 1. Iterate through workspace directories 2. Read <code>.metadata.json</code> to check <code>last_accessed</code> 3. Calculate age from current time 4. Remove if age exceeds threshold 5. Return cleanup stats (count, session IDs)</p>"},{"location":"architecture/workspace-management/#session-id-propagation","title":"Session ID Propagation","text":"<p>The session ID flows through the system via environment variable:</p> <pre><code># F1Agent sets session ID for skills\nos.environ[\"PITLANE_SESSION_ID\"] = self.session_id\n\n# Skills access session ID\nsession_id = os.environ[\"PITLANE_SESSION_ID\"]\n\n# CLI commands use session ID\npitlane fetch session-info --session-id $PITLANE_SESSION_ID --year 2024\n</code></pre> <p>This enables: - Skills to access the correct workspace - CLI commands to save data in the right location - Tool permissions to validate workspace paths</p>"},{"location":"architecture/workspace-management/#workspace-api","title":"Workspace API","text":"<p>See <code>scripts/workspace.py</code> for the full API:</p>"},{"location":"architecture/workspace-management/#create-workspace","title":"Create Workspace","text":"<pre><code>from pitlane_agent.scripts.workspace import create_workspace\n\n# Auto-generated session ID\nworkspace_info = create_workspace()\n# Returns: {\n#   \"session_id\": \"abc123-...\",\n#   \"workspace_path\": \"/Users/alice/.pitlane/workspaces/abc123-...\",\n#   \"created_at\": \"2024-05-23T14:30:00Z\"\n# }\n\n# Explicit session ID\nworkspace_info = create_workspace(\n    session_id=\"my-session\",\n    description=\"Monaco 2024 analysis\"\n)\n\n# Collision retry (auto-generated IDs only)\nworkspace_info = create_workspace(max_retries=5)\n</code></pre>"},{"location":"architecture/workspace-management/#get-workspace-info","title":"Get Workspace Info","text":"<pre><code>from pitlane_agent.scripts.workspace import get_workspace_info\n\ninfo = get_workspace_info(session_id=\"abc123\")\n# Returns: {\n#   \"session_id\": \"abc123\",\n#   \"workspace_path\": \"~/.pitlane/workspaces/abc123\",\n#   \"created_at\": \"2024-05-23T14:30:00Z\",\n#   \"last_accessed\": \"2024-05-23T15:45:00Z\",\n#   \"description\": \"Monaco 2024 analysis\",\n#   \"data_files\": [\"session_info.json\", \"drivers.json\"],\n#   \"chart_files\": [\"lap_times.png\"]\n# }\n</code></pre>"},{"location":"architecture/workspace-management/#list-workspaces","title":"List Workspaces","text":"<pre><code>from pitlane_agent.scripts.workspace import list_workspaces\n\n# Recent workspaces (10 most recent)\nworkspaces = list_workspaces()\n\n# All workspaces\nworkspaces = list_workspaces(show_all=True)\n\n# Returns list sorted by last_accessed (newest first)\n</code></pre>"},{"location":"architecture/workspace-management/#remove-workspace","title":"Remove Workspace","text":"<pre><code>from pitlane_agent.scripts.workspace import remove_workspace\n\nremove_workspace(session_id=\"abc123\")\n# Raises ValueError if workspace doesn't exist\n</code></pre>"},{"location":"architecture/workspace-management/#clean-workspaces","title":"Clean Workspaces","text":"<pre><code>from pitlane_agent.scripts.workspace import clean_workspaces\n\n# Remove workspaces older than 7 days\nresult = clean_workspaces(older_than_days=7)\n# Returns: {\n#   \"removed_count\": 3,\n#   \"removed_sessions\": [\"abc123\", \"def456\", \"ghi789\"]\n# }\n\n# Remove all workspaces\nresult = clean_workspaces(remove_all=True)\n</code></pre>"},{"location":"architecture/workspace-management/#shared-cache","title":"Shared Cache","text":"<p>Some data is shared across all sessions to avoid redundant downloads:</p>"},{"location":"architecture/workspace-management/#fastf1-cache","title":"FastF1 Cache","text":"<p>Location: <code>~/.pitlane/cache/fastf1/</code></p> <p>Contents: - Downloaded race data (lap times, telemetry, etc.) - Event schedules - Session metadata</p> <p>Benefits: - Faster analysis (no re-downloads) - Reduced API load - Shared across all sessions</p>"},{"location":"architecture/workspace-management/#temporal-context-cache","title":"Temporal Context Cache","text":"<p>Location: <code>~/.pitlane/cache/temporal/</code></p> <p>Contents: - F1 calendar context (current/last/next races) - Session timings - Live event status</p> <p>Benefits: - Single source of truth for calendar - Adaptive TTL (5min-24h depending on proximity to events) - All agents see consistent temporal context</p>"},{"location":"architecture/workspace-management/#concurrency","title":"Concurrency","text":"<p>Workspaces enable concurrent agent sessions:</p> <pre><code># Session 1: Monaco 2024 analysis\nagent1 = F1Agent(session_id=\"monaco-2024\")\nawait agent1.chat(\"Analyze Verstappen lap times\")\n\n# Session 2: Silverstone 2023 analysis (concurrent)\nagent2 = F1Agent(session_id=\"silverstone-2023\")\nawait agent2.chat(\"Show Hamilton strategy\")\n</code></pre> <p>Isolation Guarantees: - Each session has its own workspace directory - File I/O restricted to workspace paths (via tool permissions) - No cross-session data leakage - Shared cache uses thread-safe FastF1 implementation</p>"},{"location":"architecture/workspace-management/#cli-integration","title":"CLI Integration","text":"<p>The <code>pitlane workspace</code> CLI provides management commands:</p> <pre><code># List workspaces\npitlane workspace list\npitlane workspace list --all\n\n# Get workspace info\npitlane workspace info --session-id abc123\n\n# Remove workspace\npitlane workspace remove --session-id abc123\n\n# Clean old workspaces\npitlane workspace clean --older-than-days 7\npitlane workspace clean --all\n</code></pre> <p>See User Guide: CLI Reference for details.</p>"},{"location":"architecture/workspace-management/#benefits","title":"Benefits","text":""},{"location":"architecture/workspace-management/#1-data-isolation","title":"1. Data Isolation","text":"<p>Each session is completely isolated: - No accidental data mixing - No file path conflicts - Clean slate for each conversation</p>"},{"location":"architecture/workspace-management/#2-multi-user-support","title":"2. Multi-User Support","text":"<p>Web deployments can serve multiple users: - Each user gets unique session ID - Concurrent analysis sessions - No user-to-user data leakage</p>"},{"location":"architecture/workspace-management/#3-debugging","title":"3. Debugging","text":"<p>Persistent workspaces enable: - Post-mortem analysis of agent behavior - Inspection of generated charts - Review of CLI command outputs</p>"},{"location":"architecture/workspace-management/#4-resource-management","title":"4. Resource Management","text":"<p>Automatic cleanup prevents disk bloat: - Configurable retention policies - Last-accessed tracking - Bulk cleanup operations</p>"},{"location":"architecture/workspace-management/#related-documentation","title":"Related Documentation","text":"<ul> <li>Agent System - How workspaces integrate with F1Agent</li> <li>Tool Permissions - Workspace path restrictions</li> <li>User Guide: CLI Reference - Workspace CLI commands</li> </ul>"},{"location":"developer-guide/adding-skills/","title":"Adding Skills","text":"<p>Create custom skills to extend the F1 agent's capabilities.</p>"},{"location":"developer-guide/adding-skills/#skill-structure","title":"Skill Structure","text":"<p>Skills are defined in <code>.claude/skills/&lt;skill-name&gt;/</code>:</p> <pre><code>packages/pitlane-agent/src/pitlane_agent/.claude/skills/\n\u2514\u2500\u2500 my-skill/\n    \u251c\u2500\u2500 SKILL.md              # Skill definition (required)\n    \u2514\u2500\u2500 references/           # Sub-skills (optional)\n        \u2514\u2500\u2500 advanced.md\n</code></pre>"},{"location":"developer-guide/adding-skills/#creating-a-skill","title":"Creating a Skill","text":""},{"location":"developer-guide/adding-skills/#1-create-skill-directory","title":"1. Create Skill Directory","text":"<pre><code>mkdir -p packages/pitlane-agent/src/pitlane_agent/.claude/skills/my-skill\ncd packages/pitlane-agent/src/pitlane_agent/.claude/skills/my-skill\n</code></pre>"},{"location":"developer-guide/adding-skills/#2-write-skillmd","title":"2. Write SKILL.md","text":"<pre><code>---\nname: my-skill\ndescription: Brief description of when to use this skill\nallowed-tools: Bash(pitlane *), Read, Write\n---\n\n# My Custom Skill\n\nYou are a specialist in [domain]. Answer questions about [topic] using [tools].\n\n## Instructions\n\n1. [Step-by-step instructions for the skill]\n2. [How to use tools]\n3. [Expected output format]\n\n## Examples\n\n**User:** [Example question]\n**Response:** [How to handle it]\n</code></pre>"},{"location":"developer-guide/adding-skills/#3-test-the-skill","title":"3. Test the Skill","text":"<pre><code>from pitlane_agent import F1Agent\n\nagent = F1Agent(session_id=\"test\")\n\n# Ask a question that should trigger your skill\nresponse = await agent.chat_full(\"Question for my skill\")\nprint(response)\n</code></pre>"},{"location":"developer-guide/adding-skills/#skill-definition-format","title":"Skill Definition Format","text":""},{"location":"developer-guide/adding-skills/#frontmatter","title":"Frontmatter","text":"<pre><code>---\nname: my-skill              # Skill identifier (kebab-case)\ndescription: When to use this skill  # Shown to main agent\nallowed-tools: Bash(pitlane *), Read, Write  # Tool restrictions\n---\n</code></pre> <p>Tool Syntax: - <code>Bash</code> - Full bash access (not recommended) - <code>Bash(pitlane *)</code> - Restricted to pitlane CLI - <code>Read</code> - Read files from workspace - <code>Write</code> - Write files to workspace - <code>WebFetch</code> - Fetch web content (use sparingly)</p>"},{"location":"developer-guide/adding-skills/#prompt-content","title":"Prompt Content","text":"<p>Write clear instructions:</p> <p><pre><code># Skill Title\n\nYou are a [role] with access to [capabilities].\n\n## Task\n\n[What the skill does]\n\n## Available Commands\n\n### Command 1\n```bash\npitlane fetch data --session-id $PITLANE_SESSION_ID\n</code></pre> [Description of what it does]</p>"},{"location":"developer-guide/adding-skills/#command-2","title":"Command 2","text":"<p><pre><code>pitlane analyze data --session-id $PITLANE_SESSION_ID\n</code></pre> [Description]</p>"},{"location":"developer-guide/adding-skills/#output-format","title":"Output Format","text":"<p>[How to format the response]</p>"},{"location":"developer-guide/adding-skills/#examples","title":"Examples","text":"<p>[Example conversations] <pre><code>## Sub-Skills Pattern\n\nFor complex skills, use sub-skills:\n</code></pre> my-skill/ \u251c\u2500\u2500 SKILL.md           # Routes to sub-skills \u2514\u2500\u2500 references/     \u251c\u2500\u2500 basic.md       # Basic operations     \u2514\u2500\u2500 advanced.md    # Advanced operations <pre><code>**Main skill (SKILL.md):**\n```markdown\n---\nname: my-skill\ndescription: Handle multiple types of queries\nallowed-tools: Bash(pitlane *), Read, Write\n---\n\n# My Skill\n\nBased on the user's question, read the appropriate reference:\n\n## Basic Operations\n**When:** Questions about [basic topics]\n**Read:** [references/basic.md](references/basic.md)\n\n## Advanced Operations\n**When:** Questions about [advanced topics]\n**Read:** [references/advanced.md](references/advanced.md)\n</code></pre></p>"},{"location":"developer-guide/adding-skills/#example-race-predictions-skill","title":"Example: Race Predictions Skill","text":"<pre><code>---\nname: f1-predictions\ndescription: Predict race outcomes based on historical data\nallowed-tools: Bash(pitlane *), Read, Write\n---\n\n# F1 Race Predictions\n\nYou predict Formula 1 race outcomes using historical data analysis.\n\n## Prediction Process\n\n1. **Fetch Historical Data**\n   ```bash\n   pitlane fetch session-info --session-id $PITLANE_SESSION_ID \\\n     --year 2023 --gp Monaco --session R\n   ```\n\n2. **Analyze Patterns**\n   - Compare historical lap times\n   - Evaluate tyre strategies\n   - Consider track characteristics\n\n3. **Generate Prediction**\n   - Rank drivers by probability\n   - Identify key factors\n   - Provide confidence levels\n\n## Example\n\n**User:** \"Who will win the Monaco Grand Prix?\"\n\n**Response:**\n\"Based on historical performance at street circuits:\n\n1. Max Verstappen (45% probability)\n   - Strong in slow-speed corners\n   - Consistent pace in qualifying\n\n2. Charles Leclerc (30% probability)\n   - Monaco specialist\n   - Excellent in sector 3\n\n3. Lewis Hamilton (15% probability)\n   - Experienced at Monaco\n   - Strong racecraft\n\nKey factors: Qualifying position critical (80% of winners start P1-P2)\"\n</code></pre>"},{"location":"developer-guide/adding-skills/#tool-permissions","title":"Tool Permissions","text":"<p>Skills inherit tool restrictions:</p> Tool Main Agent Skill Bash pitlane CLI pitlane CLI Read Workspace Workspace Write Workspace Workspace WebFetch F1 domains Only if specified Skill \u2713 Allowed \u2717 No nested skills <p>Skills cannot invoke other skills.</p>"},{"location":"developer-guide/adding-skills/#best-practices","title":"Best Practices","text":"<ol> <li>Clear Descriptions: Help the agent choose the right skill</li> <li>Specific Instructions: Step-by-step guidance</li> <li>Tool Safety: Use <code>Bash(pitlane *)</code> not <code>Bash</code></li> <li>Workspace Integration: Save data to <code>$PITLANE_SESSION_ID</code> workspace</li> <li>Examples: Include example queries and responses</li> <li>Error Handling: Explain common errors and solutions</li> </ol>"},{"location":"developer-guide/adding-skills/#testing-skills","title":"Testing Skills","text":"<pre><code># Start agent with tracing\nPITLANE_TRACING_ENABLED=1 pitlane-agent\n\n# Ask questions that trigger your skill\n&gt; Compare lap times  # Should trigger f1-analyst\n\n# Verify skill invocation in traces\n[SKILL] f1-analyst invoked\n  Sub-skill: references/lap_times.md\n  Duration: 2.345s\n</code></pre>"},{"location":"developer-guide/adding-skills/#debugging-skills","title":"Debugging Skills","text":"<p>Enable tracing to see skill execution:</p> <pre><code>agent = F1Agent(enable_tracing=True)\nresponse = await agent.chat_full(\"Test my skill\")\n</code></pre> <p>Check stderr for: - <code>[SKILL]</code> - Skill invocations - <code>[TOOL]</code> - Tool calls from skill - <code>[PERMISSION]</code> - Permission checks</p>"},{"location":"developer-guide/adding-skills/#skill-discovery","title":"Skill Discovery","text":"<p>The Claude Agent SDK automatically discovers skills in <code>.claude/skills/</code>:</p> <ol> <li>Scans for <code>SKILL.md</code> files</li> <li>Parses frontmatter (name, description, allowed-tools)</li> <li>Loads skill prompts on demand</li> <li>Enforces tool restrictions</li> </ol>"},{"location":"developer-guide/adding-skills/#related-documentation","title":"Related Documentation","text":"<ul> <li>Architecture: Skills - Skill system internals</li> <li>Agent CLI: Using Skills - How agent skills work</li> <li>Agent CLI: CLI Reference - Available CLI commands</li> </ul>"},{"location":"developer-guide/code-quality/","title":"Code Quality","text":"<p>PitLane-AI maintains high code quality through automated tooling and conventions.</p>"},{"location":"developer-guide/code-quality/#linting-and-formatting","title":"Linting and Formatting","text":""},{"location":"developer-guide/code-quality/#ruff","title":"Ruff","text":"<p>We use ruff for both linting and formatting:</p> <pre><code># Check code style\nuv run ruff check .\n\n# Auto-fix issues\nuv run ruff check --fix .\n\n# Format code\nuv run ruff format .\n\n# Check formatting (CI)\nuv run ruff format --check .\n</code></pre>"},{"location":"developer-guide/code-quality/#configuration","title":"Configuration","text":"<pre><code># pyproject.toml\n[tool.ruff]\nline-length = 120\ntarget-version = \"py312\"\n\n[tool.ruff.lint]\nselect = [\n    \"E\",  # pycodestyle errors\n    \"W\",  # pycodestyle warnings\n    \"F\",  # pyflakes\n    \"I\",  # isort\n    \"B\",  # flake8-bugbear\n    \"C4\", # flake8-comprehensions\n]\n\n[tool.ruff.lint.isort]\nknown-first-party = [\"pitlane_agent\", \"pitlane_web\"]\n</code></pre>"},{"location":"developer-guide/code-quality/#type-checking","title":"Type Checking","text":""},{"location":"developer-guide/code-quality/#mypy-optional","title":"MyPy (Optional)","text":"<pre><code># Run type checking\nuv run mypy packages/pitlane-agent/src\nuv run mypy packages/pitlane-web/src\n</code></pre>"},{"location":"developer-guide/code-quality/#type-hints","title":"Type Hints","text":"<p>Use type hints for function signatures:</p> <pre><code>from typing import AsyncIterator\n\nasync def chat(self, message: str) -&gt; AsyncIterator[str]:\n    \"\"\"Process chat message.\"\"\"\n    ...\n</code></pre>"},{"location":"developer-guide/code-quality/#code-style-guidelines","title":"Code Style Guidelines","text":""},{"location":"developer-guide/code-quality/#python-style","title":"Python Style","text":"<ul> <li>Line length: 120 characters max</li> <li>Imports: Grouped by stdlib, third-party, first-party (enforced by ruff)</li> <li>Naming:</li> <li><code>snake_case</code> for functions, variables</li> <li><code>PascalCase</code> for classes</li> <li><code>UPPER_CASE</code> for constants</li> </ul>"},{"location":"developer-guide/code-quality/#docstrings","title":"Docstrings","text":"<p>Use Google-style docstrings:</p> <pre><code>def create_workspace(session_id: str | None = None) -&gt; dict:\n    \"\"\"Create a new workspace directory.\n\n    Args:\n        session_id: Session identifier. Auto-generated if None.\n\n    Returns:\n        Dictionary with workspace information.\n\n    Raises:\n        ValueError: If workspace already exists.\n\n    Example:\n        &gt;&gt;&gt; info = create_workspace(\"my-session\")\n        &gt;&gt;&gt; print(info[\"workspace_path\"])\n    \"\"\"\n</code></pre>"},{"location":"developer-guide/code-quality/#comments","title":"Comments","text":"<pre><code># Good: Explain WHY, not WHAT\n# Use batch processor for production to reduce overhead\nspan_processor = BatchSpanProcessor(exporter)\n\n# Bad: Redundant comment\n# Set span processor to batch\nspan_processor = BatchSpanProcessor(exporter)\n</code></pre>"},{"location":"developer-guide/code-quality/#testing-standards","title":"Testing Standards","text":"<ul> <li>Maintain &gt;80% code coverage</li> <li>Write tests for new features</li> <li>Include both success and error cases</li> <li>Use descriptive test names</li> </ul> <pre><code>def test_agent_initialization_with_explicit_session_id():\n    \"\"\"Agent should use provided session ID.\"\"\"\n    agent = F1Agent(session_id=\"test-123\")\n    assert agent.session_id == \"test-123\"\n</code></pre>"},{"location":"developer-guide/code-quality/#error-handling","title":"Error Handling","text":""},{"location":"developer-guide/code-quality/#specific-exceptions","title":"Specific Exceptions","text":"<pre><code># Good: Specific exception\nif not workspace_exists(session_id):\n    raise ValueError(f\"Workspace not found: {session_id}\")\n\n# Bad: Generic exception\nif not workspace_exists(session_id):\n    raise Exception(\"Workspace not found\")\n</code></pre>"},{"location":"developer-guide/code-quality/#logging","title":"Logging","text":"<pre><code>import logging\n\nlogger = logging.getLogger(__name__)\n\n# Log with context\nlogger.info(\"Creating workspace\", extra={\"session_id\": session_id})\nlogger.error(\"Failed to fetch data\", exc_info=True)\n</code></pre>"},{"location":"developer-guide/code-quality/#security-best-practices","title":"Security Best Practices","text":""},{"location":"developer-guide/code-quality/#path-validation","title":"Path Validation","text":"<pre><code># Always validate user input\nfrom pathlib import Path\n\ndef is_within_workspace(file_path: str, workspace: str) -&gt; bool:\n    file_resolved = Path(file_path).resolve()\n    workspace_resolved = Path(workspace).resolve()\n    return str(file_resolved).startswith(str(workspace_resolved))\n</code></pre>"},{"location":"developer-guide/code-quality/#timing-safe-comparison","title":"Timing-Safe Comparison","text":"<pre><code>import secrets\n\n# Use timing-safe comparison for secrets\ndef validate_session(cookie_session: str, expected: str) -&gt; bool:\n    return secrets.compare_digest(cookie_session, expected)\n</code></pre>"},{"location":"developer-guide/code-quality/#performance-considerations","title":"Performance Considerations","text":""},{"location":"developer-guide/code-quality/#async-operations","title":"Async Operations","text":"<pre><code># Good: Use async for I/O\nasync def fetch_data(url: str) -&gt; str:\n    async with httpx.AsyncClient() as client:\n        response = await client.get(url)\n        return response.text\n\n# Bad: Blocking I/O in async function\nasync def fetch_data_bad(url: str) -&gt; str:\n    response = requests.get(url)  # Blocks event loop\n    return response.text\n</code></pre>"},{"location":"developer-guide/code-quality/#caching","title":"Caching","text":"<pre><code># Cache expensive operations\nfrom functools import lru_cache\n\n@lru_cache(maxsize=128)\ndef expensive_computation(x: int) -&gt; int:\n    return x ** 2\n</code></pre>"},{"location":"developer-guide/code-quality/#cicd-checks","title":"CI/CD Checks","text":"<p>All pull requests must pass:</p> <ol> <li>Linting: <code>ruff check .</code></li> <li>Formatting: <code>ruff format --check .</code></li> <li>Tests: <code>pytest</code></li> <li>Coverage: <code>pytest --cov --cov-fail-under=80</code></li> </ol>"},{"location":"developer-guide/code-quality/#pre-commit-hooks-optional","title":"Pre-commit Hooks (Optional)","text":"<pre><code># Install pre-commit\nuv pip install pre-commit\n\n# Set up hooks\npre-commit install\n\n# Run manually\npre-commit run --all-files\n</code></pre>"},{"location":"developer-guide/code-quality/#related-documentation","title":"Related Documentation","text":"<ul> <li>Setup - Development environment</li> <li>Testing - Writing tests</li> <li>Contributing - Contribution workflow</li> </ul>"},{"location":"developer-guide/contributing/","title":"Contributing","text":"<p>Thank you for considering contributing to PitLane-AI! This guide will help you get started.</p>"},{"location":"developer-guide/contributing/#code-of-conduct","title":"Code of Conduct","text":"<ul> <li>Be respectful and inclusive</li> <li>Provide constructive feedback</li> <li>Focus on what is best for the project</li> </ul>"},{"location":"developer-guide/contributing/#getting-started","title":"Getting Started","text":"<ol> <li>Fork the repository</li> <li>Clone your fork: <pre><code>git clone https://github.com/YOUR_USERNAME/PitLane-AI.git\ncd PitLane-AI\n</code></pre></li> <li>Set up development environment: <pre><code>uv sync\n</code></pre></li> <li>Create a branch: <pre><code>git checkout -b feature/your-feature-name\n</code></pre></li> </ol>"},{"location":"developer-guide/contributing/#development-workflow","title":"Development Workflow","text":""},{"location":"developer-guide/contributing/#1-make-changes","title":"1. Make Changes","text":"<p>Edit code in <code>packages/pitlane-agent/</code> or <code>packages/pitlane-web/</code>:</p> <pre><code>vim packages/pitlane-agent/src/pitlane_agent/agent.py\n</code></pre>"},{"location":"developer-guide/contributing/#2-run-tests","title":"2. Run Tests","text":"<pre><code># Run all tests\nuv run pytest\n\n# Run specific tests\nuv run pytest packages/pitlane-agent/tests/test_agent.py\n\n# Run with coverage\nuv run pytest --cov\n</code></pre>"},{"location":"developer-guide/contributing/#3-format-code","title":"3. Format Code","text":"<pre><code># Format with ruff\nuv run ruff format .\n\n# Check linting\nuv run ruff check .\n\n# Auto-fix issues\nuv run ruff check --fix .\n</code></pre>"},{"location":"developer-guide/contributing/#4-commit-changes","title":"4. Commit Changes","text":"<p>Use conventional commits:</p> <pre><code>git add .\ngit commit -m \"feat: add new skill for race predictions\"\ngit commit -m \"fix: resolve session timeout issue\"\ngit commit -m \"docs: update CLI reference\"\n</code></pre> <p>Commit Types: - <code>feat:</code> - New feature - <code>fix:</code> - Bug fix - <code>docs:</code> - Documentation changes - <code>test:</code> - Test additions/changes - <code>refactor:</code> - Code refactoring - <code>chore:</code> - Maintenance tasks</p>"},{"location":"developer-guide/contributing/#5-push-and-create-pr","title":"5. Push and Create PR","text":"<pre><code>git push origin feature/your-feature-name\n</code></pre> <p>Create a Pull Request on GitHub with: - Clear title and description - Reference related issues (#123) - Include screenshots/examples if applicable</p>"},{"location":"developer-guide/contributing/#contribution-types","title":"Contribution Types","text":""},{"location":"developer-guide/contributing/#bug-fixes","title":"Bug Fixes","text":"<ol> <li>Create an issue describing the bug</li> <li>Reference the issue in your PR</li> <li>Include a test case demonstrating the fix</li> </ol>"},{"location":"developer-guide/contributing/#new-features","title":"New Features","text":"<ol> <li>Discuss the feature in an issue first</li> <li>Get approval before implementing</li> <li>Include tests and documentation</li> <li>Update relevant docs/</li> </ol>"},{"location":"developer-guide/contributing/#documentation","title":"Documentation","text":"<ul> <li>Fix typos and improve clarity</li> <li>Add missing examples</li> <li>Update API references</li> <li>Improve getting started guides</li> </ul>"},{"location":"developer-guide/contributing/#tests","title":"Tests","text":"<ul> <li>Add missing test coverage</li> <li>Improve test reliability</li> <li>Add integration tests</li> </ul>"},{"location":"developer-guide/contributing/#code-standards","title":"Code Standards","text":""},{"location":"developer-guide/contributing/#python-style","title":"Python Style","text":"<ul> <li>Follow PEP 8 (enforced by ruff)</li> <li>Maximum line length: 120 characters</li> <li>Use type hints where helpful</li> <li>Write descriptive docstrings</li> </ul> <p>Example: <pre><code>def fetch_lap_times(\n    session_id: str,\n    year: int,\n    gp_name: str,\n    session_type: str,\n) -&gt; dict[str, Any]:\n    \"\"\"Fetch lap times for a session.\n\n    Args:\n        session_id: Workspace session ID.\n        year: Season year.\n        gp_name: Grand Prix name (e.g., \"Monaco\").\n        session_type: Session code (R, Q, FP1, etc.).\n\n    Returns:\n        Dictionary with lap time data and statistics.\n\n    Raises:\n        ValueError: If session not found.\n    \"\"\"\n    ...\n</code></pre></p>"},{"location":"developer-guide/contributing/#testing-standards","title":"Testing Standards","text":"<ul> <li>Write tests for new features</li> <li>Maintain &gt;80% code coverage</li> <li>Use descriptive test names</li> <li>Include both positive and negative cases</li> </ul> <p>Example: <pre><code>def test_agent_initialization_with_explicit_session_id():\n    \"\"\"Agent should use provided session ID.\"\"\"\n    agent = F1Agent(session_id=\"test-123\")\n    assert agent.session_id == \"test-123\"\n\ndef test_agent_initialization_generates_session_id():\n    \"\"\"Agent should generate UUID if no session ID provided.\"\"\"\n    agent = F1Agent()\n    assert len(agent.session_id) == 36  # UUID format\n</code></pre></p>"},{"location":"developer-guide/contributing/#documentation-standards","title":"Documentation Standards","text":""},{"location":"developer-guide/contributing/#docstrings","title":"Docstrings","text":"<p>Use Google-style docstrings:</p> <pre><code>def create_workspace(session_id: str | None = None) -&gt; dict:\n    \"\"\"Create a new workspace.\n\n    Args:\n        session_id: Session identifier. Auto-generated if None.\n\n    Returns:\n        Dictionary with workspace information:\n        {\n            \"session_id\": str,\n            \"workspace_path\": str,\n            \"created_at\": str,\n        }\n\n    Raises:\n        ValueError: If workspace already exists.\n\n    Example:\n        &gt;&gt;&gt; info = create_workspace(session_id=\"my-session\")\n        &gt;&gt;&gt; print(info[\"workspace_path\"])\n        ~/.pitlane/workspaces/my-session\n    \"\"\"\n</code></pre>"},{"location":"developer-guide/contributing/#mkdocs-pages","title":"MkDocs Pages","text":"<p>Follow existing structure: - Use clear headings - Include code examples - Link to related pages - Add diagrams where helpful</p>"},{"location":"developer-guide/contributing/#review-process","title":"Review Process","text":""},{"location":"developer-guide/contributing/#what-we-look-for","title":"What We Look For","text":"<ol> <li>Code Quality:</li> <li>Clean, readable code</li> <li>Proper error handling</li> <li> <p>Type hints where helpful</p> </li> <li> <p>Tests:</p> </li> <li>New tests for new features</li> <li>Tests pass locally</li> <li> <p>Good coverage</p> </li> <li> <p>Documentation:</p> </li> <li>Docstrings updated</li> <li>User docs updated if needed</li> <li> <p>Changelog entry (for features/fixes)</p> </li> <li> <p>Style:</p> </li> <li>Passes ruff checks</li> <li>Follows project conventions</li> </ol>"},{"location":"developer-guide/contributing/#review-timeline","title":"Review Timeline","text":"<ul> <li>Initial review within 3-5 days</li> <li>Follow-up reviews within 1-2 days</li> <li>Merge after approval from maintainer</li> </ul>"},{"location":"developer-guide/contributing/#getting-help","title":"Getting Help","text":"<ul> <li>Questions: Open a GitHub issue with the \"question\" label</li> <li>Bugs: Open a GitHub issue with the \"bug\" label</li> <li>Features: Open a GitHub issue with the \"enhancement\" label</li> </ul>"},{"location":"developer-guide/contributing/#related-documentation","title":"Related Documentation","text":"<ul> <li>Setup - Development environment</li> <li>Testing - Writing tests</li> <li>Code Quality - Code standards</li> <li>Adding Skills - Creating new skills</li> </ul>"},{"location":"developer-guide/project-structure/","title":"Project Structure","text":"<p>PitLane-AI is organized as a Python monorepo using uv workspaces.</p>"},{"location":"developer-guide/project-structure/#directory-layout","title":"Directory Layout","text":"<pre><code>PitLane-AI/\n\u251c\u2500\u2500 pyproject.toml          # Workspace root configuration\n\u251c\u2500\u2500 uv.lock                 # Unified dependency lockfile\n\u251c\u2500\u2500 README.md\n\u251c\u2500\u2500 LICENSE\n\u2502\n\u251c\u2500\u2500 packages/\n\u2502   \u251c\u2500\u2500 pitlane-agent/      # Core agent library\n\u2502   \u2502   \u251c\u2500\u2500 pyproject.toml  # Package metadata\n\u2502   \u2502   \u251c\u2500\u2500 src/\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 pitlane_agent/\n\u2502   \u2502   \u2502       \u251c\u2500\u2500 __init__.py\n\u2502   \u2502   \u2502       \u251c\u2500\u2500 agent.py            # F1Agent class\n\u2502   \u2502   \u2502       \u251c\u2500\u2500 cli.py              # CLI entry point\n\u2502   \u2502   \u2502       \u251c\u2500\u2500 cli_fetch.py        # Fetch commands\n\u2502   \u2502   \u2502       \u251c\u2500\u2500 cli_analyze.py      # Analyze commands\n\u2502   \u2502   \u2502       \u251c\u2500\u2500 tool_permissions.py # Permission system\n\u2502   \u2502   \u2502       \u251c\u2500\u2500 tracing.py          # OpenTelemetry hooks\n\u2502   \u2502   \u2502       \u251c\u2500\u2500 temporal/           # Temporal context system\n\u2502   \u2502   \u2502       \u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u2502   \u2502       \u2502   \u251c\u2500\u2500 context.py      # Context data structures\n\u2502   \u2502   \u2502       \u2502   \u251c\u2500\u2500 analyzer.py     # Calendar analysis\n\u2502   \u2502   \u2502       \u2502   \u251c\u2500\u2500 cache.py        # Cache management\n\u2502   \u2502   \u2502       \u2502   \u2514\u2500\u2500 formatter.py    # Prompt formatting\n\u2502   \u2502   \u2502       \u251c\u2500\u2500 scripts/            # CLI script implementations\n\u2502   \u2502   \u2502       \u2502   \u251c\u2500\u2500 workspace.py    # Workspace management\n\u2502   \u2502   \u2502       \u2502   \u251c\u2500\u2500 fetch.py        # Data fetching\n\u2502   \u2502   \u2502       \u2502   \u2514\u2500\u2500 analyze.py      # Analysis functions\n\u2502   \u2502   \u2502       \u2514\u2500\u2500 .claude/\n\u2502   \u2502   \u2502           \u2514\u2500\u2500 skills/         # Agent skills\n\u2502   \u2502   \u2502               \u251c\u2500\u2500 f1-analyst/\n\u2502   \u2502   \u2502               \u251c\u2500\u2500 f1-drivers/\n\u2502   \u2502   \u2502               \u2514\u2500\u2500 f1-schedule/\n\u2502   \u2502   \u2514\u2500\u2500 tests/\n\u2502   \u2502       \u251c\u2500\u2500 conftest.py             # Shared fixtures\n\u2502   \u2502       \u251c\u2500\u2500 test_agent.py\n\u2502   \u2502       \u251c\u2500\u2500 test_tracing.py\n\u2502   \u2502       \u251c\u2500\u2500 temporal/               # Temporal context tests\n\u2502   \u2502       \u2514\u2500\u2500 integration/            # Integration tests\n\u2502   \u2502\n\u2502   \u2514\u2500\u2500 pitlane-web/        # Web interface\n\u2502       \u251c\u2500\u2500 pyproject.toml\n\u2502       \u251c\u2500\u2500 src/\n\u2502       \u2502   \u2514\u2500\u2500 pitlane_web/\n\u2502       \u2502       \u251c\u2500\u2500 __init__.py\n\u2502       \u2502       \u251c\u2500\u2500 app.py              # FastAPI application\n\u2502       \u2502       \u251c\u2500\u2500 cli.py              # Web CLI entry point\n\u2502       \u2502       \u251c\u2500\u2500 agent_manager.py    # Agent lifecycle\n\u2502       \u2502       \u251c\u2500\u2500 config.py           # Configuration\n\u2502       \u2502       \u251c\u2500\u2500 security.py         # Security utilities\n\u2502       \u2502       \u251c\u2500\u2500 session.py          # Session management\n\u2502       \u2502       \u251c\u2500\u2500 filters.py          # Jinja2 filters\n\u2502       \u2502       \u251c\u2500\u2500 templates/          # HTML templates\n\u2502       \u2502       \u2502   \u2514\u2500\u2500 index.html\n\u2502       \u2502       \u2514\u2500\u2500 static/             # CSS, JS, images\n\u2502       \u2514\u2500\u2500 tests/\n\u2502           \u251c\u2500\u2500 test_agent_manager.py\n\u2502           \u2514\u2500\u2500 test_agent_manager_concurrency.py\n\u2502\n\u2514\u2500\u2500 docs/                   # MkDocs documentation\n    \u251c\u2500\u2500 index.md\n    \u251c\u2500\u2500 architecture/\n    \u251c\u2500\u2500 user-guide/\n    \u251c\u2500\u2500 developer-guide/\n    \u2514\u2500\u2500 api-reference/\n</code></pre>"},{"location":"developer-guide/project-structure/#package-descriptions","title":"Package Descriptions","text":""},{"location":"developer-guide/project-structure/#pitlane-agent","title":"pitlane-agent","text":"<p>Purpose: Core agent library with skills and CLI</p> <p>Key Components: - <code>agent.py</code> - Main F1Agent class - <code>temporal/</code> - F1 calendar awareness system - <code>tool_permissions.py</code> - Tool restriction logic - <code>scripts/</code> - CLI command implementations - <code>.claude/skills/</code> - Analysis skills</p> <p>Entry Points: - <code>pitlane</code> - CLI interface - <code>pitlane-agent</code> - Interactive agent (planned)</p>"},{"location":"developer-guide/project-structure/#pitlane-web","title":"pitlane-web","text":"<p>Purpose: Web interface for chat-based F1 analysis</p> <p>Key Components: - <code>app.py</code> - FastAPI routes and SSE - <code>agent_manager.py</code> - Agent caching and lifecycle - <code>session.py</code> - Session management - <code>templates/</code> - HTML UI - <code>static/</code> - Frontend assets</p> <p>Entry Point: - <code>pitlane-web</code> - Web server CLI</p>"},{"location":"developer-guide/project-structure/#key-files","title":"Key Files","text":""},{"location":"developer-guide/project-structure/#root-configuration","title":"Root Configuration","text":""},{"location":"developer-guide/project-structure/#pyprojecttoml-root","title":"<code>pyproject.toml</code> (root)","text":"<pre><code>[project]\nname = \"pitlane-ai\"\nversion = \"0.1.2.dev4\"\ndescription = \"AI-powered F1 data analysis\"\n\n[tool.uv.workspace]\nmembers = [\n    \"packages/pitlane-agent\",\n    \"packages/pitlane-web\"\n]\n\n[tool.ruff]\nline-length = 120\ntarget-version = \"py312\"\n</code></pre> <p>Defines workspace members and shared tool configuration.</p>"},{"location":"developer-guide/project-structure/#package-configuration","title":"Package Configuration","text":""},{"location":"developer-guide/project-structure/#packagespitlane-agentpyprojecttoml","title":"<code>packages/pitlane-agent/pyproject.toml</code>","text":"<pre><code>[project]\nname = \"pitlane-agent\"\ndependencies = [\n    \"claude-agent-sdk\",\n    \"fastf1\",\n    \"matplotlib\",\n    \"click\",\n    # ...\n]\n\n[project.scripts]\npitlane = \"pitlane_agent.cli:pitlane\"\n</code></pre> <p>Defines <code>pitlane-agent</code> package with dependencies and CLI entry point.</p>"},{"location":"developer-guide/project-structure/#packagespitlane-webpyprojecttoml","title":"<code>packages/pitlane-web/pyproject.toml</code>","text":"<pre><code>[project]\nname = \"pitlane-web\"\ndependencies = [\n    \"pitlane-agent\",  # Workspace dependency\n    \"fastapi\",\n    \"uvicorn\",\n    \"slowapi\",\n    # ...\n]\n\n[project.scripts]\npitlane-web = \"pitlane_web.cli:cli\"\n</code></pre> <p>Defines <code>pitlane-web</code> package depending on <code>pitlane-agent</code>.</p>"},{"location":"developer-guide/project-structure/#dependency-management","title":"Dependency Management","text":""},{"location":"developer-guide/project-structure/#workspace-dependencies","title":"Workspace Dependencies","text":"<p>Packages can depend on other workspace packages:</p> <pre><code># packages/pitlane-web/pyproject.toml\ndependencies = [\n    \"pitlane-agent\",  # Resolved from workspace\n]\n</code></pre>"},{"location":"developer-guide/project-structure/#lockfile","title":"Lockfile","text":"<p><code>uv.lock</code> contains unified lockfile for all packages: - Ensures consistent versions across workspace - Fast resolution and installation - Reproducible builds</p>"},{"location":"developer-guide/project-structure/#adding-dependencies","title":"Adding Dependencies","text":"<pre><code># Add to pitlane-agent\nuv add --package pitlane-agent &lt;package&gt;\n\n# Add to pitlane-web\nuv add --package pitlane-web &lt;package&gt;\n\n# Add dev dependency\nuv add --package pitlane-agent --dev &lt;package&gt;\n</code></pre>"},{"location":"developer-guide/project-structure/#testing-structure","title":"Testing Structure","text":""},{"location":"developer-guide/project-structure/#unit-tests","title":"Unit Tests","text":"<p>Located in <code>packages/*/tests/</code>:</p> <pre><code># packages/pitlane-agent/tests/test_agent.py\ndef test_agent_initialization():\n    agent = F1Agent(session_id=\"test-123\")\n    assert agent.session_id == \"test-123\"\n</code></pre>"},{"location":"developer-guide/project-structure/#integration-tests","title":"Integration Tests","text":"<p>Marked with <code>@pytest.mark.integration</code>:</p> <pre><code># packages/pitlane-agent/tests/integration/test_fastf1_temporal.py\n@pytest.mark.integration\nasync def test_temporal_context_live():\n    ctx = get_temporal_context(force_refresh=True)\n    assert ctx.current_season == 2024\n</code></pre>"},{"location":"developer-guide/project-structure/#fixtures","title":"Fixtures","text":"<p>Shared fixtures in <code>conftest.py</code>:</p> <pre><code># packages/pitlane-agent/tests/conftest.py\n@pytest.fixture\ndef temp_workspace(tmp_path):\n    \"\"\"Create temporary workspace for testing.\"\"\"\n    workspace = tmp_path / \"workspace\"\n    workspace.mkdir()\n    yield workspace\n</code></pre>"},{"location":"developer-guide/project-structure/#documentation-structure","title":"Documentation Structure","text":"<p>MkDocs-based documentation in <code>docs/</code>:</p> <pre><code>docs/\n\u251c\u2500\u2500 index.md                # Homepage\n\u251c\u2500\u2500 architecture/           # System design\n\u2502   \u251c\u2500\u2500 overview.md\n\u2502   \u251c\u2500\u2500 agent-system.md\n\u2502   \u2514\u2500\u2500 ...\n\u251c\u2500\u2500 user-guide/             # Usage documentation\n\u2502   \u251c\u2500\u2500 cli-reference.md\n\u2502   \u251c\u2500\u2500 web-interface.md\n\u2502   \u2514\u2500\u2500 ...\n\u251c\u2500\u2500 developer-guide/        # This section\n\u2502   \u251c\u2500\u2500 setup.md\n\u2502   \u251c\u2500\u2500 project-structure.md\n\u2502   \u2514\u2500\u2500 ...\n\u2514\u2500\u2500 api-reference/          # Auto-generated API docs\n    \u251c\u2500\u2500 pitlane-agent/\n    \u2514\u2500\u2500 pitlane-web/\n</code></pre> <p>Built with <code>mkdocs build</code> and served via GitHub Pages.</p>"},{"location":"developer-guide/project-structure/#skills-structure","title":"Skills Structure","text":"<p>Skills are organized under <code>.claude/skills/</code>:</p> <pre><code>.claude/skills/\n\u251c\u2500\u2500 f1-analyst/\n\u2502   \u251c\u2500\u2500 SKILL.md            # Skill definition\n\u2502   \u2514\u2500\u2500 references/         # Sub-skills\n\u2502       \u251c\u2500\u2500 lap_times.md\n\u2502       \u251c\u2500\u2500 strategy.md\n\u2502       \u2514\u2500\u2500 telemetry.md\n\u251c\u2500\u2500 f1-drivers/\n\u2502   \u2514\u2500\u2500 SKILL.md\n\u2514\u2500\u2500 f1-schedule/\n    \u2514\u2500\u2500 SKILL.md\n</code></pre> <p>Each skill has: - <code>SKILL.md</code> - Frontmatter + prompt - <code>references/</code> - Optional sub-skill documentation</p>"},{"location":"developer-guide/project-structure/#related-documentation","title":"Related Documentation","text":"<ul> <li>Setup - Development environment setup</li> <li>Contributing - Contribution workflow</li> <li>Adding Skills - Creating new skills</li> </ul>"},{"location":"developer-guide/release-process/","title":"Release Process","text":"<p>Detailed release process documentation can be found at docs/RELEASE_PROCESS.md.</p>"},{"location":"developer-guide/release-process/#quick-reference","title":"Quick Reference","text":""},{"location":"developer-guide/release-process/#creating-a-release","title":"Creating a Release","text":"<ol> <li>Go to Releases page</li> <li>Click \"Draft a new release\"</li> <li>Create tag: <code>vX.Y.Z</code> (e.g., <code>v0.2.0</code>)</li> <li>Publish release</li> </ol>"},{"location":"developer-guide/release-process/#automated-steps","title":"Automated Steps","text":"<p>The workflow automatically: - Bumps version numbers in all packages - Generates CHANGELOG from conventional commits - Builds wheel and source distributions - Publishes to PyPI (if configured) - Attaches artifacts to GitHub Release</p>"},{"location":"developer-guide/release-process/#version-numbering","title":"Version Numbering","text":"<p>Follow Semantic Versioning: - MAJOR: Breaking changes - MINOR: New features (backward compatible) - PATCH: Bug fixes</p> <p>See full documentation for details.</p>"},{"location":"developer-guide/setup/","title":"Development Setup","text":"<p>Set up your local development environment for contributing to PitLane-AI.</p>"},{"location":"developer-guide/setup/#prerequisites","title":"Prerequisites","text":"<ul> <li>Python 3.12 or later</li> <li>uv package manager</li> <li>Git</li> </ul>"},{"location":"developer-guide/setup/#installation","title":"Installation","text":""},{"location":"developer-guide/setup/#1-install-uv","title":"1. Install uv","text":"<pre><code># macOS/Linux\ncurl -LsSf https://astral.sh/uv/install.sh | sh\n\n# Windows\npowershell -c \"irm https://astral.sh/uv/install.ps1 | iex\"\n\n# Verify installation\nuv --version\n</code></pre>"},{"location":"developer-guide/setup/#2-clone-repository","title":"2. Clone Repository","text":"<pre><code>git clone https://github.com/jshudzina/PitLane-AI.git\ncd PitLane-AI\n</code></pre>"},{"location":"developer-guide/setup/#3-install-dependencies","title":"3. Install Dependencies","text":"<pre><code># Install all workspace dependencies\nuv sync\n\n# Install with dev dependencies\nuv sync --all-extras\n</code></pre> <p>This installs both <code>pitlane-agent</code> and <code>pitlane-web</code> packages with development dependencies.</p>"},{"location":"developer-guide/setup/#project-structure","title":"Project Structure","text":"<pre><code>PitLane-AI/\n\u251c\u2500\u2500 pyproject.toml          # Workspace configuration\n\u251c\u2500\u2500 uv.lock                 # Dependency lockfile\n\u251c\u2500\u2500 packages/\n\u2502   \u251c\u2500\u2500 pitlane-agent/      # Core agent library\n\u2502   \u2502   \u251c\u2500\u2500 pyproject.toml\n\u2502   \u2502   \u251c\u2500\u2500 src/pitlane_agent/\n\u2502   \u2502   \u2514\u2500\u2500 tests/\n\u2502   \u2514\u2500\u2500 pitlane-web/        # Web interface\n\u2502       \u251c\u2500\u2500 pyproject.toml\n\u2502       \u251c\u2500\u2500 src/pitlane_web/\n\u2502       \u2514\u2500\u2500 tests/\n\u2514\u2500\u2500 docs/                   # Documentation (this site)\n</code></pre>"},{"location":"developer-guide/setup/#running-tests","title":"Running Tests","text":"<pre><code># Run all tests\nuv run pytest\n\n# Run specific package tests\nuv run --directory packages/pitlane-agent pytest\nuv run --directory packages/pitlane-web pytest\n\n# Run with coverage\nuv run pytest --cov=pitlane_agent --cov=pitlane_web\n\n# Run integration tests only\nuv run pytest -m integration\n\n# Run unit tests only (exclude integration)\nuv run pytest -m \"not integration\"\n</code></pre>"},{"location":"developer-guide/setup/#code-quality","title":"Code Quality","text":""},{"location":"developer-guide/setup/#linting-and-formatting","title":"Linting and Formatting","text":"<pre><code># Check code style\nuv run ruff check .\n\n# Auto-fix issues\nuv run ruff check --fix .\n\n# Format code\nuv run ruff format .\n</code></pre>"},{"location":"developer-guide/setup/#type-checking","title":"Type Checking","text":"<pre><code># Run mypy\nuv run mypy packages/pitlane-agent/src\nuv run mypy packages/pitlane-web/src\n</code></pre>"},{"location":"developer-guide/setup/#running-locally","title":"Running Locally","text":""},{"location":"developer-guide/setup/#cli","title":"CLI","text":"<pre><code># Run pitlane CLI\nuv run pitlane --help\n\n# Run agent in interactive mode\nuv run pitlane-agent\n</code></pre>"},{"location":"developer-guide/setup/#web-interface","title":"Web Interface","text":"<pre><code># Development mode with auto-reload\nuv run --directory packages/pitlane-web uvicorn pitlane_web.app:app --reload\n\n# Or using the CLI\nuvx pitlane-web --env development\n</code></pre> <p>Visit http://localhost:8000</p>"},{"location":"developer-guide/setup/#environment-configuration","title":"Environment Configuration","text":"<p>Create <code>.env</code> file (optional):</p> <pre><code># Tracing\nPITLANE_TRACING_ENABLED=1\nPITLANE_SPAN_PROCESSOR=simple\n\n# API Keys (if needed for extensions)\nANTHROPIC_API_KEY=sk-ant-...\n\n# Cache directory (optional)\nPITLANE_CACHE_DIR=~/.pitlane/cache\n</code></pre>"},{"location":"developer-guide/setup/#development-workflow","title":"Development Workflow","text":"<ol> <li> <p>Create a branch <pre><code>git checkout -b feature/my-feature\n</code></pre></p> </li> <li> <p>Make changes <pre><code># Edit code\nvim packages/pitlane-agent/src/pitlane_agent/agent.py\n</code></pre></p> </li> <li> <p>Run tests <pre><code>uv run pytest\n</code></pre></p> </li> <li> <p>Format code <pre><code>uv run ruff format .\n</code></pre></p> </li> <li> <p>Commit changes <pre><code>git add .\ngit commit -m \"feat: add new feature\"\n</code></pre></p> </li> <li> <p>Push and create PR <pre><code>git push origin feature/my-feature\n</code></pre></p> </li> </ol>"},{"location":"developer-guide/setup/#troubleshooting","title":"Troubleshooting","text":""},{"location":"developer-guide/setup/#module-not-found","title":"Module Not Found","text":"<p>Problem: <code>ModuleNotFoundError: No module named 'pitlane_agent'</code></p> <p>Solution: <pre><code>uv sync --all-packages --reinstall\n</code></pre></p>"},{"location":"developer-guide/setup/#test-failures","title":"Test Failures","text":"<p>Problem: Tests fail with import errors</p> <p>Solution: Ensure you're using <code>uv run</code> to execute tests: <pre><code>uv run pytest  # Not: pytest\n</code></pre></p>"},{"location":"developer-guide/setup/#cache-issues","title":"Cache Issues","text":"<p>Problem: Stale test cache</p> <p>Solution: <pre><code># Clear pytest cache\nrm -rf .pytest_cache\nrm -rf packages/*/.pytest_cache\n\n# Clear Python cache\nfind . -type d -name __pycache__ -exec rm -r {} +\n</code></pre></p>"},{"location":"developer-guide/setup/#next-steps","title":"Next Steps","text":"<ul> <li>Project Structure - Detailed codebase layout</li> <li>Contributing - Contribution guidelines</li> <li>Testing - Writing and running tests</li> <li>Code Quality - Code standards</li> </ul>"},{"location":"developer-guide/testing/","title":"Testing","text":"<p>PitLane-AI uses pytest for unit and integration testing with async support.</p>"},{"location":"developer-guide/testing/#running-tests","title":"Running Tests","text":"<pre><code># Run all tests\nuv run pytest\n\n# Run specific package\nuv run --directory packages/pitlane-agent pytest\nuv run --directory packages/pitlane-web pytest\n\n# Run with coverage\nuv run pytest --cov=pitlane_agent --cov=pitlane_web --cov-report=html\n\n# Run integration tests only\nuv run pytest -m integration\n\n# Exclude integration tests\nuv run pytest -m \"not integration\"\n\n# Verbose output\nuv run pytest -v\n\n# Stop on first failure\nuv run pytest -x\n</code></pre>"},{"location":"developer-guide/testing/#test-organization","title":"Test Organization","text":""},{"location":"developer-guide/testing/#unit-tests","title":"Unit Tests","text":"<p>Located in <code>packages/*/tests/</code>:</p> <pre><code># packages/pitlane-agent/tests/test_agent.py\ndef test_agent_creates_workspace(tmp_path):\n    agent = F1Agent(workspace_dir=tmp_path)\n    assert agent.workspace_dir.exists()\n\nasync def test_agent_chat_streaming():\n    agent = F1Agent(session_id=\"test\")\n    chunks = []\n    async for chunk in agent.chat(\"Hello\"):\n        chunks.append(chunk)\n    assert len(chunks) &gt; 0\n</code></pre>"},{"location":"developer-guide/testing/#integration-tests","title":"Integration Tests","text":"<p>Marked with <code>@pytest.mark.integration</code>:</p> <pre><code># packages/pitlane-agent/tests/integration/test_fastf1_temporal.py\nimport pytest\n\n@pytest.mark.integration\nasync def test_temporal_context_fetches_live_data():\n    \"\"\"Test temporal context with live FastF1 API.\"\"\"\n    ctx = get_temporal_context(force_refresh=True)\n    assert ctx.current_season &gt;= 2024\n</code></pre>"},{"location":"developer-guide/testing/#fixtures","title":"Fixtures","text":""},{"location":"developer-guide/testing/#common-fixtures","title":"Common Fixtures","text":"<pre><code># conftest.py\nimport pytest\nfrom pathlib import Path\n\n@pytest.fixture\ndef temp_workspace(tmp_path):\n    \"\"\"Temporary workspace directory.\"\"\"\n    workspace = tmp_path / \"workspace\"\n    workspace.mkdir()\n    (workspace / \"data\").mkdir()\n    (workspace / \"charts\").mkdir()\n    return workspace\n\n@pytest.fixture\ndef mock_session_id():\n    \"\"\"Fixed session ID for testing.\"\"\"\n    return \"test-session-123\"\n</code></pre>"},{"location":"developer-guide/testing/#agent-fixtures","title":"Agent Fixtures","text":"<pre><code>@pytest.fixture\nasync def agent(temp_workspace):\n    \"\"\"F1Agent instance with temp workspace.\"\"\"\n    agent = F1Agent(\n        session_id=\"test\",\n        workspace_dir=temp_workspace,\n        inject_temporal_context=False,  # Skip for speed\n    )\n    yield agent\n</code></pre>"},{"location":"developer-guide/testing/#writing-tests","title":"Writing Tests","text":""},{"location":"developer-guide/testing/#test-structure","title":"Test Structure","text":"<pre><code>def test_function_name():\n    \"\"\"Test description.\n\n    Tests should:\n    - Have clear, descriptive names\n    - Include docstrings explaining what is tested\n    - Test one behavior per test\n    - Use arrange-act-assert pattern\n    \"\"\"\n    # Arrange\n    workspace = Path(\"/tmp/test\")\n\n    # Act\n    result = create_workspace(\"test-id\")\n\n    # Assert\n    assert result[\"session_id\"] == \"test-id\"\n</code></pre>"},{"location":"developer-guide/testing/#async-tests","title":"Async Tests","text":"<pre><code>import pytest\n\n@pytest.mark.asyncio\nasync def test_async_agent_chat():\n    agent = F1Agent(session_id=\"test\")\n    response = await agent.chat_full(\"Hello\")\n    assert isinstance(response, str)\n</code></pre>"},{"location":"developer-guide/testing/#mocking","title":"Mocking","text":"<pre><code>from unittest.mock import AsyncMock, patch\n\n@pytest.mark.asyncio\nasync def test_agent_with_mock_claude():\n    with patch(\"pitlane_agent.agent.ClaudeSDKClient\") as mock_client:\n        mock_client.return_value.__aenter__.return_value.query = AsyncMock()\n        agent = F1Agent(session_id=\"test\")\n        await agent.chat(\"Test\")\n        mock_client.return_value.__aenter__.return_value.query.assert_called_once()\n</code></pre>"},{"location":"developer-guide/testing/#test-markers","title":"Test Markers","text":"<pre><code># Mark integration tests\n@pytest.mark.integration\ndef test_live_api():\n    pass\n\n# Mark slow tests\n@pytest.mark.slow\ndef test_expensive_operation():\n    pass\n\n# Skip tests conditionally\n@pytest.mark.skipif(os.getenv(\"CI\"), reason=\"Skip in CI\")\ndef test_local_only():\n    pass\n</code></pre>"},{"location":"developer-guide/testing/#coverage","title":"Coverage","text":"<pre><code># Generate coverage report\nuv run pytest --cov=pitlane_agent --cov=pitlane_web --cov-report=html\n\n# Open coverage report\nopen htmlcov/index.html\n\n# Check coverage threshold\nuv run pytest --cov --cov-fail-under=80\n</code></pre>"},{"location":"developer-guide/testing/#best-practices","title":"Best Practices","text":"<ol> <li>Test isolation: Each test should be independent</li> <li>Clear names: <code>test_agent_raises_error_when_session_invalid()</code></li> <li>Fast tests: Mock external APIs, use temp directories</li> <li>Assertions: Be specific (not just <code>assert result</code>)</li> <li>Edge cases: Test both success and failure paths</li> </ol>"},{"location":"developer-guide/testing/#related-documentation","title":"Related Documentation","text":"<ul> <li>Setup - Development environment</li> <li>Contributing - Contribution workflow</li> <li>Code Quality - Code standards</li> </ul>"},{"location":"getting-started/configuration/","title":"Configuration","text":"<p>PitLane-AI can be configured using environment variables, command-line flags, and programmatic parameters. This guide covers all configuration options.</p>"},{"location":"getting-started/configuration/#environment-variables","title":"Environment Variables","text":""},{"location":"getting-started/configuration/#general-settings","title":"General Settings","text":""},{"location":"getting-started/configuration/#pitlane_tracing_enabled","title":"PITLANE_TRACING_ENABLED","text":"<p>Enable OpenTelemetry tracing to observe agent behavior.</p> <ul> <li>Type: Boolean (<code>1</code>, <code>true</code>, <code>yes</code> for enabled)</li> <li>Default: Disabled</li> <li>Example:   <pre><code>export PITLANE_TRACING_ENABLED=1\n</code></pre></li> </ul>"},{"location":"getting-started/configuration/#pitlane_span_processor","title":"PITLANE_SPAN_PROCESSOR","text":"<p>Configure the OpenTelemetry span processor mode.</p> <ul> <li>Type: String (<code>simple</code> or <code>batch</code>)</li> <li>Default: <code>simple</code></li> <li>Values:</li> <li><code>simple</code> - Immediate export (good for testing)</li> <li><code>batch</code> - Batched export (good for production)</li> <li>Example:   <pre><code>export PITLANE_SPAN_PROCESSOR=batch\n</code></pre></li> </ul>"},{"location":"getting-started/configuration/#temporal-context-settings","title":"Temporal Context Settings","text":"<p>These variables are automatically set by the temporal context system but can be referenced in your scripts:</p>"},{"location":"getting-started/configuration/#pitlane_current_season","title":"PITLANE_CURRENT_SEASON","text":"<p>The current F1 season year.</p> <ul> <li>Type: Integer</li> <li>Example: <code>2026</code></li> </ul>"},{"location":"getting-started/configuration/#pitlane_season_phase","title":"PITLANE_SEASON_PHASE","text":"<p>The current phase of the F1 season.</p> <ul> <li>Type: String</li> <li>Values: <code>pre_season</code>, <code>in_season</code>, <code>post_season</code>, <code>off_season</code></li> </ul>"},{"location":"getting-started/configuration/#pitlane_current_race","title":"PITLANE_CURRENT_RACE","text":"<p>The current race event name (if any).</p> <ul> <li>Type: String</li> <li>Example: <code>Monaco Grand Prix</code></li> </ul>"},{"location":"getting-started/configuration/#pitlane_current_round","title":"PITLANE_CURRENT_ROUND","text":"<p>The current round number (if any).</p> <ul> <li>Type: Integer</li> </ul>"},{"location":"getting-started/configuration/#web-interface-settings","title":"Web Interface Settings","text":"<p>These are used when running <code>pitlane-web</code>:</p>"},{"location":"getting-started/configuration/#pitlane_web_host","title":"PITLANE_WEB_HOST","text":"<p>The host address for the web server.</p> <ul> <li>Type: String</li> <li>Default: <code>0.0.0.0</code></li> <li>Example:   <pre><code>export PITLANE_WEB_HOST=127.0.0.1\n</code></pre></li> </ul>"},{"location":"getting-started/configuration/#pitlane_web_port","title":"PITLANE_WEB_PORT","text":"<p>The port for the web server.</p> <ul> <li>Type: Integer</li> <li>Default: <code>8000</code></li> <li>Example:   <pre><code>export PITLANE_WEB_PORT=3000\n</code></pre></li> </ul>"},{"location":"getting-started/configuration/#pitlane_web_env","title":"PITLANE_WEB_ENV","text":"<p>The environment mode.</p> <ul> <li>Type: String</li> <li>Values: <code>development</code>, <code>production</code></li> <li>Default: <code>production</code></li> <li>Example:   <pre><code>export PITLANE_WEB_ENV=development\n</code></pre></li> </ul>"},{"location":"getting-started/configuration/#cli-configuration","title":"CLI Configuration","text":""},{"location":"getting-started/configuration/#global-flags","title":"Global Flags","text":"<p>Most CLI commands accept these common flags:</p>"},{"location":"getting-started/configuration/#-session-id","title":"--session-id","text":"<p>Specify the workspace/session ID for analysis.</p> <pre><code>pitlane analyze lap-times --session-id my-analysis ...\n</code></pre>"},{"location":"getting-started/configuration/#-help","title":"--help","text":"<p>Show help information for any command.</p> <pre><code>pitlane --help\npitlane workspace --help\npitlane analyze lap-times --help\n</code></pre>"},{"location":"getting-started/configuration/#command-specific-options","title":"Command-Specific Options","text":""},{"location":"getting-started/configuration/#temporal-context","title":"Temporal Context","text":"<pre><code># Format: text, json, prompt\npitlane temporal-context --format json\n\n# Verbosity: minimal, normal, detailed\npitlane temporal-context --verbosity detailed\n\n# Force refresh from FastF1\npitlane temporal-context --refresh\n</code></pre>"},{"location":"getting-started/configuration/#workspace-management","title":"Workspace Management","text":"<pre><code># Create with description\npitlane workspace create --session-id my-session --description \"Monaco 2024 analysis\"\n\n# List all workspaces\npitlane workspace list --show-all\n\n# Clean old workspaces\npitlane workspace clean --older-than 7 --yes\n</code></pre>"},{"location":"getting-started/configuration/#analysis-commands","title":"Analysis Commands","text":"<pre><code># Specify drivers (can be used multiple times)\npitlane analyze lap-times --drivers VER --drivers HAM --drivers LEC\n\n# Specify year, grand prix, and session\npitlane analyze tyre-strategy --year 2024 --gp Monaco --session R\n</code></pre>"},{"location":"getting-started/configuration/#python-api-configuration","title":"Python API Configuration","text":"<p>When using the Python API, you can configure the agent programmatically:</p> <pre><code>from pitlane_agent import F1Agent\n\n# Create agent with temporal context injection\nagent = F1Agent(\n    session_id=\"my-analysis\",\n    inject_temporal_context=True  # Default: True\n)\n\n# Disable temporal context\nagent = F1Agent(\n    session_id=\"my-analysis\",\n    inject_temporal_context=False\n)\n</code></pre>"},{"location":"getting-started/configuration/#fastf1-cache-configuration","title":"FastF1 Cache Configuration","text":"<p>PitLane-AI uses FastF1 for data access, which caches data locally.</p>"},{"location":"getting-started/configuration/#cache-location","title":"Cache Location","text":"<p>By default, FastF1 cache is stored in:</p> <pre><code>~/.pitlane/cache/fastf1/\n</code></pre>"},{"location":"getting-started/configuration/#clearing-cache","title":"Clearing Cache","text":"<p>To clear the FastF1 cache:</p> <pre><code>rm -rf ~/.pitlane/cache/fastf1/\n</code></pre> <p>Warning</p> <p>Clearing the cache will require re-downloading data from FastF1 servers, which can take time for race sessions.</p>"},{"location":"getting-started/configuration/#workspace-configuration","title":"Workspace Configuration","text":""},{"location":"getting-started/configuration/#workspace-directory","title":"Workspace Directory","text":"<p>Workspaces are stored in:</p> <pre><code>~/.pitlane/workspaces/&lt;session-id&gt;/\n</code></pre> <p>Each workspace contains:</p> <ul> <li><code>metadata.json</code> - Session metadata</li> <li><code>data/</code> - Fetched session and driver data</li> <li><code>charts/</code> - Generated visualizations</li> </ul>"},{"location":"getting-started/configuration/#workspace-lifecycle","title":"Workspace Lifecycle","text":"<p>Workspaces are created automatically when you run analysis commands with a <code>--session-id</code> parameter, or manually using:</p> <pre><code>pitlane workspace create --session-id my-session\n</code></pre>"},{"location":"getting-started/configuration/#tracing-configuration","title":"Tracing Configuration","text":""},{"location":"getting-started/configuration/#console-tracing-development","title":"Console Tracing (Development)","text":"<p>For local development, traces are written to stderr:</p> <pre><code>PITLANE_TRACING_ENABLED=1 pitlane analyze lap-times ...\n</code></pre>"},{"location":"getting-started/configuration/#batch-tracing-production","title":"Batch Tracing (Production)","text":"<p>For production workloads, use batch processing:</p> <pre><code>PITLANE_TRACING_ENABLED=1 PITLANE_SPAN_PROCESSOR=batch pitlane-web\n</code></pre>"},{"location":"getting-started/configuration/#trace-output","title":"Trace Output","text":"<p>Traces show:</p> <ul> <li>Tool calls made by the agent</li> <li>Permission checks and validation</li> <li>Decision flows and reasoning</li> <li>Timing information</li> </ul> <p>Example trace output:</p> <pre><code>[TRACE] Tool called: Bash(command=\"pitlane fetch driver-info --season 2024\")\n[TRACE] Permission check: ALLOWED - pitlane command\n[TRACE] Tool result: Success (127 bytes)\n</code></pre>"},{"location":"getting-started/configuration/#configuration-precedence","title":"Configuration Precedence","text":"<p>Settings are applied in this order (last wins):</p> <ol> <li>Default values (in code)</li> <li>Environment variables</li> <li>Command-line flags</li> <li>Programmatic parameters (Python API)</li> </ol> <p>Example:</p> <pre><code># Environment variable sets default\nexport PITLANE_WEB_PORT=3000\n\n# CLI flag overrides environment variable\npitlane-web --port 8080  # Uses port 8080, not 3000\n</code></pre>"},{"location":"getting-started/configuration/#advanced-configuration","title":"Advanced Configuration","text":""},{"location":"getting-started/configuration/#custom-agent-configuration","title":"Custom Agent Configuration","text":"<p>For advanced use cases, you can customize the agent's behavior:</p> <pre><code>from pitlane_agent.agent import F1Agent\nfrom pitlane_agent.tool_permissions import get_tool_permission_callback\n\nagent = F1Agent(\n    session_id=\"custom-session\",\n    inject_temporal_context=True,\n    # Add custom configuration here\n)\n</code></pre>"},{"location":"getting-started/configuration/#custom-tool-permissions","title":"Custom Tool Permissions","text":"<p>See Tool Permissions for details on customizing allowed domains and tool restrictions.</p>"},{"location":"getting-started/configuration/#troubleshooting","title":"Troubleshooting","text":""},{"location":"getting-started/configuration/#workspace-not-found","title":"Workspace Not Found","text":"<p>If you get \"workspace not found\" errors:</p> <pre><code># List all workspaces\npitlane workspace list\n\n# Create the workspace manually\npitlane workspace create --session-id your-session-id\n</code></pre>"},{"location":"getting-started/configuration/#cache-issues","title":"Cache Issues","text":"<p>If you experience data issues:</p> <pre><code># Clear and refresh temporal context cache\npitlane temporal-context --refresh\n\n# Clear FastF1 cache\nrm -rf ~/.pitlane/cache/fastf1/\n</code></pre>"},{"location":"getting-started/configuration/#port-already-in-use","title":"Port Already in Use","text":"<p>If the web server port is already in use:</p> <pre><code># Use a different port\npitlane-web --port 8080\n\n# Or set via environment variable\nexport PITLANE_WEB_PORT=8080\npitlane-web\n</code></pre>"},{"location":"getting-started/configuration/#next-steps","title":"Next Steps","text":"<ul> <li>Web Interface - Using the web app</li> <li>Agent CLI - CLI reference (for agents/developers)</li> <li>Architecture Overview - Learn how PitLane-AI works</li> <li>Temporal Context - Deep dive into temporal awareness</li> </ul>"},{"location":"getting-started/installation/","title":"Installation","text":"<p>PitLane-AI is available as three Python packages on PyPI. You can install just the components you need, or install everything at once.</p>"},{"location":"getting-started/installation/#requirements","title":"Requirements","text":"<ul> <li>Python 3.11, 3.12, or 3.13</li> <li>pip or uv package manager</li> </ul>"},{"location":"getting-started/installation/#install-options","title":"Install Options","text":""},{"location":"getting-started/installation/#option-1-full-install-recommended","title":"Option 1: Full Install (Recommended)","text":"<p>Install both the CLI agent and web interface:</p> <pre><code>pip install pitlane-ai\n</code></pre> <p>This meta-package includes both <code>pitlane-agent</code> and <code>pitlane-web</code>.</p>"},{"location":"getting-started/installation/#option-2-cli-only","title":"Option 2: CLI Only","text":"<p>If you only need the command-line interface:</p> <pre><code>pip install pitlane-agent\n</code></pre>"},{"location":"getting-started/installation/#option-3-web-interface-only","title":"Option 3: Web Interface Only","text":"<p>If you only need the web interface:</p> <pre><code>pip install pitlane-web\n</code></pre> <p>Note</p> <p>The web interface depends on <code>pitlane-agent</code>, so installing <code>pitlane-web</code> will also install the agent.</p>"},{"location":"getting-started/installation/#using-uvx-no-installation-required","title":"Using uvx (No Installation Required)","text":"<p>For one-off usage without installing, use <code>uvx</code>:</p> <pre><code># Run CLI commands\nuvx pitlane-agent workspace create --session-id my-analysis\n\n# Run web server\nuvx pitlane-web --env development\n</code></pre>"},{"location":"getting-started/installation/#development-installation","title":"Development Installation","text":"<p>For contributing to PitLane-AI, clone the repository and install in development mode:</p> <pre><code># Clone the repository\ngit clone https://github.com/jshudzina/PitLane-AI.git\ncd PitLane-AI\n\n# Install uv if you haven't already\ncurl -LsSf https://astral.sh/uv/install.sh | sh\n\n# Install dependencies\nuv sync\n\n# Install with documentation dependencies\nuv sync --group docs\n\n# Install with development dependencies\nuv sync --group dev\n</code></pre> <p>See the Developer Guide for more details.</p>"},{"location":"getting-started/installation/#verify-installation","title":"Verify Installation","text":"<p>After installation, verify that the packages are installed correctly:</p> <pre><code># Check pitlane-agent version\npython -c \"import pitlane_agent; print(pitlane_agent.__version__)\"\n\n# Check pitlane-web version\npython -c \"import pitlane_web; print(pitlane_web.__version__)\"\n\n# Try the CLI\npitlane --help\n\n# Try the web server\npitlane-web --help\n</code></pre>"},{"location":"getting-started/installation/#dependencies","title":"Dependencies","text":"<p>PitLane-AI is built on top of industry-standard F1 data APIs that handle all the analytical heavy lifting:</p>"},{"location":"getting-started/installation/#core-data-apis","title":"Core Data APIs","text":"<ul> <li>FastF1 - F1 telemetry, timing, lap times, and session data access</li> <li>jolpica-f1 (Ergast API) - Historical F1 driver rosters, race results, and championship data (accessed via FastF1's ergast module)</li> </ul>"},{"location":"getting-started/installation/#agent-visualization","title":"Agent &amp; Visualization","text":"<ul> <li>Claude Agent SDK - AI agent orchestration and skill system</li> <li>Matplotlib - Chart generation and data visualization</li> <li>FastAPI - Web interface backend (pitlane-web only)</li> <li>OpenTelemetry - Optional tracing and observability</li> </ul> <p>All dependencies are automatically installed when you install PitLane-AI.</p>"},{"location":"getting-started/installation/#upgrading","title":"Upgrading","text":"<p>To upgrade to the latest version:</p> <pre><code>pip install --upgrade pitlane-ai\n</code></pre> <p>Or for individual packages:</p> <pre><code>pip install --upgrade pitlane-agent\npip install --upgrade pitlane-web\n</code></pre>"},{"location":"getting-started/installation/#uninstalling","title":"Uninstalling","text":"<p>To remove PitLane-AI:</p> <pre><code>pip uninstall pitlane-ai pitlane-agent pitlane-web\n</code></pre>"},{"location":"getting-started/installation/#next-steps","title":"Next Steps","text":"<ul> <li>Quick Start Guide - Run your first analysis</li> <li>Configuration - Configure PitLane-AI settings</li> <li>Web Interface - Learn how to use the web app</li> <li>Agent CLI - CLI reference (for agents/developers)</li> </ul>"},{"location":"getting-started/quick-start/","title":"Quick Start","text":"<p>Get up and running with PitLane-AI in minutes. This guide will walk you through your first F1 analysis using both the CLI and web interface.</p>"},{"location":"getting-started/quick-start/#cli-quick-start","title":"CLI Quick Start","text":""},{"location":"getting-started/quick-start/#1-install","title":"1. Install","text":"<pre><code>pip install pitlane-agent\n</code></pre>"},{"location":"getting-started/quick-start/#2-create-a-workspace","title":"2. Create a Workspace","text":"<p>Workspaces isolate your analysis sessions and store generated charts:</p> <pre><code>pitlane workspace create --session-id monaco-analysis\n</code></pre>"},{"location":"getting-started/quick-start/#3-fetch-driver-information","title":"3. Fetch Driver Information","text":"<p>Get information about F1 drivers:</p> <pre><code>pitlane fetch driver-info --season 2024 --limit 10\n</code></pre>"},{"location":"getting-started/quick-start/#4-view-event-schedule","title":"4. View Event Schedule","text":"<p>Check the race calendar:</p> <pre><code>pitlane fetch event-schedule --year 2024 --no-testing\n</code></pre>"},{"location":"getting-started/quick-start/#5-analyze-lap-times","title":"5. Analyze Lap Times","text":"<p>Compare lap times between drivers at a specific race:</p> <pre><code>pitlane analyze lap-times \\\n  --session-id monaco-analysis \\\n  --year 2024 \\\n  --gp Monaco \\\n  --session Q \\\n  --drivers VER \\\n  --drivers HAM\n</code></pre> <p>This generates a lap time comparison chart saved in <code>~/.pitlane/workspaces/monaco-analysis/charts/</code>.</p>"},{"location":"getting-started/quick-start/#6-analyze-tyre-strategy","title":"6. Analyze Tyre Strategy","text":"<p>Visualize pit stop and tyre compound usage:</p> <pre><code>pitlane analyze tyre-strategy \\\n  --session-id monaco-analysis \\\n  --year 2024 \\\n  --gp Monaco \\\n  --session R\n</code></pre>"},{"location":"getting-started/quick-start/#7-check-temporal-context","title":"7. Check Temporal Context","text":"<p>See what the agent knows about the current F1 season:</p> <pre><code>pitlane temporal-context\n</code></pre>"},{"location":"getting-started/quick-start/#web-interface-quick-start","title":"Web Interface Quick Start","text":""},{"location":"getting-started/quick-start/#1-install_1","title":"1. Install","text":"<pre><code>pip install pitlane-web\n</code></pre>"},{"location":"getting-started/quick-start/#2-start-the-server","title":"2. Start the Server","text":"<pre><code>uvx pitlane-web --env development\n</code></pre> <p>Or with tracing enabled:</p> <pre><code>PITLANE_TRACING_ENABLED=1 uvx pitlane-web --env development\n</code></pre>"},{"location":"getting-started/quick-start/#3-open-in-browser","title":"3. Open in Browser","text":"<p>Navigate to http://localhost:8000 in your web browser.</p>"},{"location":"getting-started/quick-start/#4-create-a-session","title":"4. Create a Session","text":"<p>On the home page, create a new analysis session with a descriptive name.</p>"},{"location":"getting-started/quick-start/#5-ask-questions","title":"5. Ask Questions","text":"<p>Try these example queries in the chat interface:</p> <ul> <li>\"Show me lap time distributions for the Monaco 2024 qualifying session\"</li> <li>\"Compare Verstappen and Hamilton's tyre strategies at Monaco\"</li> <li>\"What are the upcoming races this season?\"</li> <li>\"Give me information about driver VER\"</li> </ul>"},{"location":"getting-started/quick-start/#6-view-generated-charts","title":"6. View Generated Charts","text":"<p>Charts are automatically displayed in the chat interface and saved to your workspace.</p>"},{"location":"getting-started/quick-start/#python-api-quick-start","title":"Python API Quick Start","text":"<p>For programmatic access:</p> <pre><code>import asyncio\nfrom pitlane_agent import F1Agent\n\nasync def main():\n    # Create an agent\n    agent = F1Agent(session_id=\"my-analysis\")\n\n    # Stream a response\n    async for chunk in agent.chat(\"Compare lap times for VER and HAM at Monaco 2024 qualifying\"):\n        print(chunk, end=\"\", flush=True)\n\n    print()  # New line after response\n\n# Run the async function\nasyncio.run(main())\n</code></pre>"},{"location":"getting-started/quick-start/#workspace-management","title":"Workspace Management","text":""},{"location":"getting-started/quick-start/#list-workspaces","title":"List Workspaces","text":"<pre><code>pitlane workspace list\n</code></pre>"},{"location":"getting-started/quick-start/#view-workspace-info","title":"View Workspace Info","text":"<pre><code>pitlane workspace info --session-id monaco-analysis\n</code></pre>"},{"location":"getting-started/quick-start/#clean-old-workspaces","title":"Clean Old Workspaces","text":"<p>Remove workspaces older than 7 days:</p> <pre><code>pitlane workspace clean --older-than 7 --yes\n</code></pre>"},{"location":"getting-started/quick-start/#remove-a-specific-workspace","title":"Remove a Specific Workspace","text":"<pre><code>pitlane workspace remove --session-id monaco-analysis --yes\n</code></pre>"},{"location":"getting-started/quick-start/#common-session-types","title":"Common Session Types","text":"<p>When using the <code>--session</code> parameter, these are the valid session types:</p> <ul> <li><code>FP1</code> - Free Practice 1</li> <li><code>FP2</code> - Free Practice 2</li> <li><code>FP3</code> - Free Practice 3</li> <li><code>Q</code> - Qualifying</li> <li><code>SQ</code> - Sprint Qualifying</li> <li><code>S</code> - Sprint Race</li> <li><code>R</code> - Race</li> </ul>"},{"location":"getting-started/quick-start/#example-workflows","title":"Example Workflows","text":""},{"location":"getting-started/quick-start/#analyzing-a-complete-race-weekend","title":"Analyzing a Complete Race Weekend","text":"<pre><code># Create workspace\npitlane workspace create --session-id silverstone-2024\n\n# Analyze qualifying\npitlane analyze lap-times \\\n  --session-id silverstone-2024 \\\n  --year 2024 --gp \"Great Britain\" --session Q \\\n  --drivers VER --drivers NOR\n\n# Analyze race tyre strategy\npitlane analyze tyre-strategy \\\n  --session-id silverstone-2024 \\\n  --year 2024 --gp \"Great Britain\" --session R\n\n# View all generated charts\nls -lh ~/.pitlane/workspaces/silverstone-2024/charts/\n</code></pre>"},{"location":"getting-started/quick-start/#comparing-multiple-drivers","title":"Comparing Multiple Drivers","text":"<pre><code>pitlane analyze lap-times \\\n  --session-id multi-driver \\\n  --year 2024 --gp Monaco --session R \\\n  --drivers VER \\\n  --drivers HAM \\\n  --drivers LEC \\\n  --drivers NOR\n</code></pre>"},{"location":"getting-started/quick-start/#tips","title":"Tips","text":"<p>Grand Prix Names</p> <p>Use the official race names or country names for the <code>--gp</code> parameter. Examples:</p> <ul> <li><code>Monaco</code>, <code>\"Great Britain\"</code>, <code>Italy</code>, <code>Singapore</code></li> <li>Multi-word names should be quoted: <code>\"Saudi Arabia\"</code>, <code>\"United States\"</code></li> </ul> <p>Session IDs</p> <p>Use descriptive session IDs that indicate the race or analysis type:</p> <ul> <li><code>monaco-quali-analysis</code></li> <li><code>bahrain-2024-strategy</code></li> <li><code>verstappen-performance</code></li> </ul> <p>View Charts</p> <p>Charts are saved in <code>~/.pitlane/workspaces/&lt;session-id&gt;/charts/</code> with timestamps in the filenames for easy organization.</p>"},{"location":"getting-started/quick-start/#next-steps","title":"Next Steps","text":"<ul> <li>Configuration - Configure environment variables and settings</li> <li>Web Interface - Learn more about the web interface</li> <li>Analysis Types - Detailed guide to analysis capabilities</li> <li>Agent CLI - CLI reference (for agents/developers)</li> </ul>"},{"location":"user-guide/analysis-types/","title":"Analysis Types","text":"<p>PitLane-AI provides several types of F1 data analysis through the web interface. Simply ask questions in natural language, and the AI agent will automatically fetch data, generate visualizations, and provide insights. Each analysis type uses FastF1 for data access and matplotlib for visualizations.</p>"},{"location":"user-guide/analysis-types/#lap-time-analysis","title":"Lap Time Analysis","text":"<p>Compare driver lap times with statistical visualizations.</p>"},{"location":"user-guide/analysis-types/#what-it-provides","title":"What It Provides","text":"<ul> <li>Lap time distributions (violin plots, box plots)</li> <li>Statistical summaries (mean, median, std dev)</li> <li>Pace comparison across drivers</li> <li>Qualifying vs. race pace analysis</li> </ul>"},{"location":"user-guide/analysis-types/#use-cases","title":"Use Cases","text":"<ul> <li>\"Compare Verstappen and Hamilton lap times in Monaco 2024\"</li> <li>\"Who was fastest in Q3?\"</li> <li>\"Show me lap time consistency for the top 5 drivers\"</li> <li>\"Analyze pace during the race\"</li> </ul>"},{"location":"user-guide/analysis-types/#example-interaction","title":"Example Interaction","text":"<pre><code>User: Compare Verstappen and Norris lap times in Silverstone 2024 qualifying\n\nAgent: I'll fetch the lap times for VER and NOR from Silverstone Q...\n       [Generates lap_times.png]\n       Here's the comparison: Verstappen was 0.234s faster on average.\n</code></pre>"},{"location":"user-guide/analysis-types/#tyre-strategy-analysis","title":"Tyre Strategy Analysis","text":"<p>Visualize pit stop strategy and compound usage throughout a race.</p>"},{"location":"user-guide/analysis-types/#what-it-provides_1","title":"What It Provides","text":"<ul> <li>Stint timeline visualization</li> <li>Compound usage (Soft, Medium, Hard)</li> <li>Pit stop timing and frequency</li> <li>Strategy comparison across drivers</li> </ul>"},{"location":"user-guide/analysis-types/#use-cases_1","title":"Use Cases","text":"<ul> <li>\"Show me Ferrari's tyre strategy in Monaco\"</li> <li>\"What compounds did the top 10 use?\"</li> <li>\"Compare one-stop vs. two-stop strategies\"</li> <li>\"When did drivers pit?\"</li> </ul>"},{"location":"user-guide/analysis-types/#what-youll-get","title":"What You'll Get","text":"<p>The agent will generate a horizontal timeline visualization showing: - Stint durations for each driver - Color-coded tyre compounds (Soft, Medium, Hard) - Pit stop timing markers - Strategy comparison across the field</p>"},{"location":"user-guide/analysis-types/#driver-information","title":"Driver Information","text":"<p>Query driver details, codes, and career information.</p>"},{"location":"user-guide/analysis-types/#what-it-provides_2","title":"What It Provides","text":"<ul> <li>Driver names and codes</li> <li>Team affiliations by season</li> <li>Nationality and date of birth</li> <li>Wikipedia links for details</li> </ul>"},{"location":"user-guide/analysis-types/#use-cases_2","title":"Use Cases","text":"<ul> <li>\"Who drove for Ferrari in 2019?\"</li> <li>\"What's Leclerc's driver code?\"</li> <li>\"List all drivers in the 2024 season\"</li> <li>\"Show me Alpine's driver lineup\"</li> </ul>"},{"location":"user-guide/analysis-types/#what-youll-get_1","title":"What You'll Get","text":"<p>The agent will provide driver information including: - Driver names and three-letter codes (e.g., LEC for Leclerc) - Team affiliations for the requested season - Nationality and biographical details - Links to Wikipedia for more information</p>"},{"location":"user-guide/analysis-types/#event-schedule","title":"Event Schedule","text":"<p>Query race calendar, dates, and session timings.</p>"},{"location":"user-guide/analysis-types/#what-it-provides_3","title":"What It Provides","text":"<ul> <li>Season calendar with race dates</li> <li>Location and round numbers</li> <li>Session schedules (FP1, FP2, FP3, Q, R)</li> <li>Sprint weekend identification</li> </ul>"},{"location":"user-guide/analysis-types/#use-cases_3","title":"Use Cases","text":"<ul> <li>\"When is the next race?\"</li> <li>\"Show me the 2024 calendar\"</li> <li>\"What time is qualifying in Monaco?\"</li> <li>\"List all sprint weekends\"</li> </ul>"},{"location":"user-guide/analysis-types/#what-youll-get_2","title":"What You'll Get","text":"<p>The agent will provide schedule information including: - Race dates and locations for the season - Session timings (Practice, Qualifying, Race) - Sprint weekend identification - Round numbers and Grand Prix names</p>"},{"location":"user-guide/analysis-types/#telemetry-analysis","title":"Telemetry Analysis","text":"<p>Compare detailed car telemetry between laps (speed, throttle, brake, gear).</p>"},{"location":"user-guide/analysis-types/#what-it-provides_4","title":"What It Provides","text":"<ul> <li>Speed traces across lap distance</li> <li>Throttle and brake application</li> <li>Gear shifts visualization</li> <li>Corner-by-corner comparison</li> </ul>"},{"location":"user-guide/analysis-types/#use-cases_4","title":"Use Cases","text":"<ul> <li>\"Compare speed traces for Verstappen and Hamilton\"</li> <li>\"Show me braking points in Monaco Turn 1\"</li> <li>\"Where do drivers go flat out?\"</li> <li>\"Analyze gear shifts around the lap\"</li> </ul>"},{"location":"user-guide/analysis-types/#what-youll-get_3","title":"What You'll Get","text":"<p>The agent will generate a multi-panel telemetry plot showing: - Speed traces across lap distance - Throttle and brake application patterns - Gear shift visualization - Corner-by-corner driver comparison overlay</p>"},{"location":"user-guide/analysis-types/#how-to-use","title":"How to Use","text":"<p>Using PitLane-AI is simple:</p> <ol> <li>Open the Web Interface</li> <li>Start the web app (see Web Interface)</li> <li> <p>Navigate to http://localhost:8000</p> </li> <li> <p>Ask Your Question</p> </li> <li>Type your question in natural language</li> <li>Be specific about the race, session, and drivers you're interested in</li> <li> <p>Example: \"Compare Verstappen and Hamilton qualifying pace in Monaco 2024\"</p> </li> <li> <p>Review the Results</p> </li> <li>The agent will stream its analysis in real-time</li> <li>Visualizations (charts, plots) are generated automatically</li> <li>Interactive charts are displayed directly in the chat</li> </ol>"},{"location":"user-guide/analysis-types/#example-interaction_1","title":"Example Interaction","text":"<pre><code>User: Compare Verstappen and Hamilton qualifying pace in Monaco 2024\n\nAgent: I'll analyze the qualifying lap times for VER and HAM in Monaco 2024...\n\n      [Fetches session data]\n      [Generates lap time visualization]\n\n      Here's the analysis:\n\n      Verstappen:\n      - Mean: 1:12.345 (+/- 0.234s)\n      - Best: 1:12.123\n\n      Hamilton:\n      - Mean: 1:12.567 (+/- 0.321s)\n      - Best: 1:12.234\n\n      [lap_times.png displayed in chat]\n\n      Verstappen was consistently faster by ~0.2s on average.\n</code></pre> <p>The agent automatically: - Determines what analysis to perform - Extracts parameters (year, GP, session, drivers) - Fetches and processes F1 data - Generates visualizations - Provides natural language insights</p>"},{"location":"user-guide/analysis-types/#data-sources","title":"Data Sources","text":"Analysis Type Data Source Lap Times FastF1 API Tyre Strategy FastF1 API Telemetry FastF1 API Driver Info Ergast API Schedule FastF1 Schedule"},{"location":"user-guide/analysis-types/#limitations","title":"Limitations","text":"<ul> <li>Historical Data: FastF1 data available from 2018 onwards (incomplete before)</li> <li>Live Timing: Not real-time (data available ~1 hour after session)</li> <li>Telemetry: Limited to GPS-based data (no internal car sensors)</li> <li>Sprint Weekends: Different session structure (SQ instead of Q)</li> </ul>"},{"location":"user-guide/analysis-types/#related-documentation","title":"Related Documentation","text":"<ul> <li>Web Interface - Getting started with the web app</li> <li>Architecture: Skills - How the agent system works</li> <li>Agent CLI - CLI reference (for agents/developers)</li> </ul>"},{"location":"user-guide/web-interface/","title":"Web Interface","text":"<p>The PitLane-AI web interface provides an interactive chat experience for F1 data analysis, powered by FastAPI and Server-Sent Events (SSE) for real-time streaming responses.</p>"},{"location":"user-guide/web-interface/#quick-start","title":"Quick Start","text":""},{"location":"user-guide/web-interface/#development-mode","title":"Development Mode","text":"<pre><code># Using uvx (recommended)\nuvx pitlane-web --env development\n\n# With tracing enabled\nPITLANE_TRACING_ENABLED=1 uvx pitlane-web --env development\n\n# Custom port\nuvx pitlane-web --port 3000 --env development\n</code></pre> <p>Visit http://localhost:8000</p> <p>Production Deployment</p> <p>Production deployment instructions are currently being finalized and will be available in a future release.</p>"},{"location":"user-guide/web-interface/#features","title":"Features","text":""},{"location":"user-guide/web-interface/#1-real-time-streaming","title":"1. Real-Time Streaming","text":"<p>Responses stream in real-time using Server-Sent Events (SSE):</p> <pre><code>User: \"Compare Verstappen and Hamilton lap times in Monaco 2024\"\n\u2193\nAgent: [Streams response chunks as they're generated]\n       \"I'll analyze the lap times for Verstappen...\"\n       \"Let me fetch the session data...\"\n       \"Here's the comparison: ...\"\n</code></pre> <p>Benefits: - Immediate feedback (no waiting for full response) - Transparent agent reasoning - Better user experience for long-running analyses</p>"},{"location":"user-guide/web-interface/#2-session-management","title":"2. Session Management","text":"<p>Each browser session gets a unique session ID stored in a secure cookie:</p> <pre><code>Session Cookie:\n- Name: pitlane_session\n- HttpOnly: true (XSS protection)\n- SameSite: Lax (CSRF protection)\n- Max-Age: 7 days\n</code></pre> <p>Session Flow: 1. User visits homepage 2. Server generates UUID session ID 3. Cookie set in response 4. All subsequent requests include session cookie 5. Agent uses session ID for workspace isolation</p> <p>Benefits: - Data isolation between users - Persistent chat history per session - Concurrent multi-user support</p>"},{"location":"user-guide/web-interface/#3-chart-visualization","title":"3. Chart Visualization","text":"<p>Generated charts are automatically displayed in the chat:</p> <pre><code>Agent: \"I've generated a lap time distribution chart\"\n\u2193\n[Chart image displayed inline]\n</code></pre> <p>Chart Flow: 1. Skill generates matplotlib chart \u2192 workspace/charts/lap_times.png 2. Agent references chart in response 3. Frontend detects chart path 4. Fetches chart via <code>/charts/&lt;session_id&gt;/&lt;filename&gt;</code> 5. Displays inline in chat</p> <p>Security: - Session ID validated before serving charts - Filename sanitized (no directory traversal) - Only PNG files served - MIME type validation</p>"},{"location":"user-guide/web-interface/#4-rate-limiting","title":"4. Rate Limiting","text":"<p>The web interface includes rate limiting for API endpoints:</p> Endpoint Limit <code>/</code> (homepage) 30/minute <code>/chat</code> (messages) 60/minute <code>/charts/*</code> (images) 120/minute <p>Configuration: <pre><code># In pitlane_web/config.py\nRATE_LIMIT_SESSION_CREATE = \"30/minute\"\nRATE_LIMIT_CHAT = \"60/minute\"\nRATE_LIMIT_CHART = \"120/minute\"\nRATE_LIMIT_ENABLED = True  # Disable for development\n</code></pre></p>"},{"location":"user-guide/web-interface/#user-interface","title":"User Interface","text":""},{"location":"user-guide/web-interface/#chat-interface","title":"Chat Interface","text":"<p>Layout: <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 PitLane AI - F1 Data Analysis           \u2502 &lt;- Header\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                         \u2502\n\u2502 User: Compare VER and HAM lap times    \u2502\n\u2502                                         \u2502\n\u2502 Assistant: I'll analyze the lap times   \u2502\n\u2502 for Verstappen and Hamilton...          \u2502\n\u2502                                         \u2502\n\u2502 [Chart: lap_times.png]                  \u2502\n\u2502                                         \u2502\n\u2502 The analysis shows...                   \u2502\n\u2502                                         \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 [Type your message here...]     [Send] \u2502 &lt;- Input\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre></p> <p>Features: - Auto-scroll to latest message - Markdown rendering (code blocks, lists, emphasis) - Inline chart display - Loading indicators during agent execution</p>"},{"location":"user-guide/web-interface/#message-types","title":"Message Types","text":"<p>User Messages: <pre><code>&lt;div class=\"message user-message\"&gt;\n  &lt;strong&gt;You:&lt;/strong&gt; Compare Verstappen lap times\n&lt;/div&gt;\n</code></pre></p> <p>Assistant Messages: <pre><code>&lt;div class=\"message assistant-message\"&gt;\n  &lt;strong&gt;Assistant:&lt;/strong&gt; I'll analyze the lap times...\n  &lt;img src=\"/charts/abc123/lap_times.png\" alt=\"Chart\"&gt;\n&lt;/div&gt;\n</code></pre></p> <p>System Messages: <pre><code>&lt;div class=\"message system-message\"&gt;\n  Error: Failed to fetch session data\n&lt;/div&gt;\n</code></pre></p>"},{"location":"user-guide/web-interface/#api-endpoints","title":"API Endpoints","text":""},{"location":"user-guide/web-interface/#get","title":"<code>GET /</code>","text":"<p>Render the chat homepage.</p> <p>Response: - HTML page with session ID - Sets session cookie (if new session)</p> <p>Session Logic: 1. Check for existing session cookie 2. Validate session ID (timing-safe comparison) 3. Create new session if invalid/missing 4. Update <code>last_accessed</code> timestamp 5. Render template with session ID</p>"},{"location":"user-guide/web-interface/#post-chat","title":"<code>POST /chat</code>","text":"<p>Send a chat message (Server-Sent Events).</p> <p>Request: <pre><code>POST /chat\nContent-Type: application/x-www-form-urlencoded\nCookie: pitlane_session=abc123\n\nmessage=Compare+VER+and+HAM+lap+times\n</code></pre></p> <p>Response: <pre><code>Content-Type: text/event-stream\nCache-Control: no-cache\nConnection: keep-alive\n\ndata: {\"type\": \"start\"}\n\ndata: {\"type\": \"chunk\", \"content\": \"I'll analyze\"}\n\ndata: {\"type\": \"chunk\", \"content\": \" the lap times\"}\n\ndata: {\"type\": \"done\"}\n</code></pre></p> <p>SSE Event Types: - <code>start</code> - Agent execution started - <code>chunk</code> - Text chunk from agent response - <code>done</code> - Agent execution completed - <code>error</code> - Error occurred</p>"},{"location":"user-guide/web-interface/#get-chartssession_idfilename","title":"<code>GET /charts/&lt;session_id&gt;/&lt;filename&gt;</code>","text":"<p>Serve generated chart images.</p> <p>Request: <pre><code>GET /charts/abc123/lap_times.png\nCookie: pitlane_session=abc123\n</code></pre></p> <p>Security Checks: 1. Extract session ID from cookie 2. Validate session ID format (UUID) 3. Compare cookie session with URL session (timing-safe) 4. Validate filename (alphanumeric + underscores/dashes only) 5. Check file exists in workspace charts directory 6. Validate PNG extension</p> <p>Response: <pre><code>Content-Type: image/png\nCache-Control: max-age=3600\n\n[PNG binary data]\n</code></pre></p> <p>Error Responses: - <code>401 Unauthorized</code> - Session mismatch - <code>404 Not Found</code> - Chart doesn't exist - <code>400 Bad Request</code> - Invalid filename</p>"},{"location":"user-guide/web-interface/#configuration","title":"Configuration","text":""},{"location":"user-guide/web-interface/#environment-variables","title":"Environment Variables","text":"<pre><code># Enable tracing (OpenTelemetry)\nPITLANE_TRACING_ENABLED=1\n\n# Tracing processor type\nPITLANE_SPAN_PROCESSOR=simple  # or 'batch' for production\n\n# Session cookie settings (production)\nSESSION_COOKIE_SECURE=true     # HTTPS only\nSESSION_COOKIE_HTTPONLY=true   # XSS protection\nSESSION_COOKIE_SAMESITE=Lax    # CSRF protection\n\n# Rate limiting\nRATE_LIMIT_ENABLED=true        # Disable for local development\n</code></pre>"},{"location":"user-guide/web-interface/#cli-options","title":"CLI Options","text":"<pre><code>uvx pitlane-web --help\n\nOptions:\n  --port INTEGER           Port to run on (default: 8000)\n  --env [development|production]   Environment mode (default: production)\n  --help                   Show this message and exit\n</code></pre> <p>Development vs. Production:</p> Feature Development Production Auto-reload \u2713 Enabled \u2717 Disabled Rate limiting \u2717 Disabled \u2713 Enabled Debug logs \u2713 Verbose \u2717 Info only Cookie secure \u2717 False \u2713 True (HTTPS)"},{"location":"user-guide/web-interface/#agent-manager","title":"Agent Manager","text":"<p>The web interface uses an agent manager for lifecycle management:</p> <pre><code>from pitlane_web.agent_manager import get_or_create_agent\n\n# Get cached agent or create new one\nagent = await get_or_create_agent(session_id, enable_tracing=True)\n\n# Stream response\nasync for chunk in agent.chat(message):\n    yield chunk\n</code></pre> <p>Agent Caching: - Agents cached in memory (TTL: 30 minutes) - Shared across requests for same session - Automatic eviction on idle - Thread-safe (asyncio locks)</p> <p>Benefits: - Faster response times (no re-initialization) - Maintains conversation context - Efficient resource usage</p>"},{"location":"user-guide/web-interface/#security-features","title":"Security Features","text":""},{"location":"user-guide/web-interface/#1-session-validation","title":"1. Session Validation","text":"<p>Timing-Safe Comparison: <pre><code># Prevents timing attacks\nsecrets.compare_digest(cookie_session, url_session)\n</code></pre></p> <p>UUID Validation: <pre><code># Prevents path traversal\nuuid.UUID(session_id)  # Raises ValueError if invalid\n</code></pre></p>"},{"location":"user-guide/web-interface/#2-filename-sanitization","title":"2. Filename Sanitization","text":"<p>Allowed Pattern: <pre><code># Only alphanumeric, underscores, dashes\nr'^[a-zA-Z0-9_-]+\\.png$'\n</code></pre></p> <p>Prevents: - Directory traversal (<code>../../../etc/passwd</code>) - Command injection (<code>chart.png; rm -rf /</code>) - Extension spoofing (<code>chart.png.exe</code>)</p>"},{"location":"user-guide/web-interface/#3-cors-and-headers","title":"3. CORS and Headers","text":"<p>Security Headers: <pre><code>Cache-Control: no-cache  # Disable caching for SSE\nX-Content-Type-Options: nosniff  # Prevent MIME sniffing\n</code></pre></p> <p>No CORS: - No <code>Access-Control-Allow-Origin</code> (same-origin only) - Prevents cross-site chat hijacking</p>"},{"location":"user-guide/web-interface/#4-rate-limiting_1","title":"4. Rate Limiting","text":"<p>Per-IP limits prevent abuse: - 30 session creations per minute - 60 chat messages per minute - 120 chart requests per minute</p>"},{"location":"user-guide/web-interface/#deployment","title":"Deployment","text":"<p>Coming Soon</p> <p>Production deployment instructions (Docker, Kubernetes, cloud platforms) are currently being finalized and will be available in a future release.</p> <p>For now, use development mode for local testing: <pre><code>uvx pitlane-web --env development\n</code></pre></p>"},{"location":"user-guide/web-interface/#troubleshooting","title":"Troubleshooting","text":""},{"location":"user-guide/web-interface/#chart-not-displaying","title":"Chart Not Displaying","text":"<p>Check: 1. Session ID matches between cookie and URL 2. Chart file exists in workspace 3. Browser console for 401/404 errors</p> <p>Debug: <pre><code># Check workspace charts\nls ~/.pitlane/workspaces/&lt;session-id&gt;/charts/\n\n# Check session cookie\n# Browser DevTools \u2192 Application \u2192 Cookies\n</code></pre></p>"},{"location":"user-guide/web-interface/#streaming-not-working","title":"Streaming Not Working","text":"<p>Check: 1. Browser supports SSE (EventSource API) 2. No proxy buffering (see Nginx config above) 3. Network tab shows <code>text/event-stream</code> content type</p> <p>Debug: <pre><code>// Browser console\nconst eventSource = new EventSource('/chat');\neventSource.onmessage = (e) =&gt; console.log(e.data);\n</code></pre></p>"},{"location":"user-guide/web-interface/#agent-timeouts","title":"Agent Timeouts","text":"<p>Check: 1. FastF1 cache populated (first request slow) 2. Network connectivity to Ergast API 3. Rate limit not exceeded</p> <p>Debug: <pre><code># Enable tracing\nPITLANE_TRACING_ENABLED=1 uvx pitlane-web --env development\n# Check stderr for tool calls and permission checks\n</code></pre></p>"},{"location":"user-guide/web-interface/#related-documentation","title":"Related Documentation","text":"<ul> <li>Analysis Types - Available analysis workflows</li> <li>Architecture: Agent System - Agent internals</li> <li>Architecture: Workspace Management - Session isolation</li> <li>Agent CLI Reference - CLI reference (for agents/developers)</li> </ul>"}]}